import{ad as or,a as Ya,k as ke,q as Tv,l as Mv,B as Za,O as Ov,r as je,o as Xe,c as Ut,b as lt,i as ge,w as me,y as yt,u as Be,H as qa,I as Va,_ as Qa,G as Ga,ab as Iv,ae as Pv,af as Hv,p as _n,v as ja,x as Wi,h as ri,e as si,ag as vn,A as Fv,t as ar,J as Wv,F as Uv,g as Nv,ah as $v,ai as Ei,n as Xa}from"./index-090ab718.js";import{u as zv,r as Kv,a as qv,b as Vv,c as pn,d as Gv,e as Ja,f as jv,g as Xv,h as Jv,i as Yv,j as Zv,k as Qv,l as ep,m as tp}from"./dev-b89ef277.js";import{E as ip}from"./codeEditor-7a43f9d4.js";import{W as rp}from"./index-77c549af.js";import"./index-932f493c.js";var eh={exports:{}};(function(Nt,Et){(function(k,Ne){Nt.exports=Ne()})(globalThis,()=>(()=>{var k={4567:function(j,a,u){var _=this&&this.__decorate||function(r,n,c,g){var S,C=arguments.length,f=C<3?n:g===null?g=Object.getOwnPropertyDescriptor(n,c):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(r,n,c,g);else for(var y=r.length-1;y>=0;y--)(S=r[y])&&(f=(C<3?S(f):C>3?S(n,c,f):S(n,c))||f);return C>3&&f&&Object.defineProperty(n,c,f),f},p=this&&this.__param||function(r,n){return function(c,g){n(c,g,r)}};Object.defineProperty(a,"__esModule",{value:!0}),a.AccessibilityManager=void 0;const l=u(9042),v=u(9924),m=u(844),b=u(4725),d=u(2585),s=u(3656);let o=a.AccessibilityManager=class extends m.Disposable{constructor(r,n,c,g){super(),this._terminal=r,this._coreBrowserService=c,this._renderService=g,this._rowColumns=new WeakMap,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityContainer=this._coreBrowserService.mainDocument.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=this._coreBrowserService.mainDocument.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let S=0;S<this._terminal.rows;S++)this._rowElements[S]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[S]);if(this._topBoundaryFocusListener=S=>this._handleBoundaryFocus(S,0),this._bottomBoundaryFocusListener=S=>this._handleBoundaryFocus(S,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=this._coreBrowserService.mainDocument.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this.register(new v.TimeBasedDebouncer(this._renderRows.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this.register(this._terminal.onResize(S=>this._handleResize(S.rows))),this.register(this._terminal.onRender(S=>this._refreshRows(S.start,S.end))),this.register(this._terminal.onScroll(()=>this._refreshRows())),this.register(this._terminal.onA11yChar(S=>this._handleChar(S))),this.register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this.register(this._terminal.onA11yTab(S=>this._handleTab(S))),this.register(this._terminal.onKey(S=>this._handleKey(S.key))),this.register(this._terminal.onBlur(()=>this._clearLiveRegion())),this.register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this.register((0,s.addDisposableDomListener)(document,"selectionchange",()=>this._handleSelectionChange())),this.register(this._coreBrowserService.onDprChange(()=>this._refreshRowsDimensions())),this._refreshRows(),this.register((0,m.toDisposable)(()=>{this._accessibilityContainer.remove(),this._rowElements.length=0}))}_handleTab(r){for(let n=0;n<r;n++)this._handleChar(" ")}_handleChar(r){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==r&&(this._charsToAnnounce+=r):this._charsToAnnounce+=r,r===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=l.tooMuchOutput)))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0}_handleKey(r){this._clearLiveRegion(),/\p{Control}/u.test(r)||this._charsToConsume.push(r)}_refreshRows(r,n){this._liveRegionDebouncer.refresh(r,n,this._terminal.rows)}_renderRows(r,n){const c=this._terminal.buffer,g=c.lines.length.toString();for(let S=r;S<=n;S++){const C=c.lines.get(c.ydisp+S),f=[],y=(C==null?void 0:C.translateToString(!0,void 0,void 0,f))||"",T=(c.ydisp+S+1).toString(),O=this._rowElements[S];O&&(y.length===0?(O.innerText="Â ",this._rowColumns.set(O,[0,1])):(O.textContent=y,this._rowColumns.set(O,f)),O.setAttribute("aria-posinset",T),O.setAttribute("aria-setsize",g))}this._announceCharacters()}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(r,n){const c=r.target,g=this._rowElements[n===0?1:this._rowElements.length-2];if(c.getAttribute("aria-posinset")===(n===0?"1":`${this._terminal.buffer.lines.length}`)||r.relatedTarget!==g)return;let S,C;if(n===0?(S=c,C=this._rowElements.pop(),this._rowContainer.removeChild(C)):(S=this._rowElements.shift(),C=c,this._rowContainer.removeChild(S)),S.removeEventListener("focus",this._topBoundaryFocusListener),C.removeEventListener("focus",this._bottomBoundaryFocusListener),n===0){const f=this._createAccessibilityTreeNode();this._rowElements.unshift(f),this._rowContainer.insertAdjacentElement("afterbegin",f)}else{const f=this._createAccessibilityTreeNode();this._rowElements.push(f),this._rowContainer.appendChild(f)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(n===0?-1:1),this._rowElements[n===0?1:this._rowElements.length-2].focus(),r.preventDefault(),r.stopImmediatePropagation()}_handleSelectionChange(){var y;if(this._rowElements.length===0)return;const r=document.getSelection();if(!r)return;if(r.isCollapsed)return void(this._rowContainer.contains(r.anchorNode)&&this._terminal.clearSelection());if(!r.anchorNode||!r.focusNode)return void console.error("anchorNode and/or focusNode are null");let n={node:r.anchorNode,offset:r.anchorOffset},c={node:r.focusNode,offset:r.focusOffset};if((n.node.compareDocumentPosition(c.node)&Node.DOCUMENT_POSITION_PRECEDING||n.node===c.node&&n.offset>c.offset)&&([n,c]=[c,n]),n.node.compareDocumentPosition(this._rowElements[0])&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_FOLLOWING)&&(n={node:this._rowElements[0].childNodes[0],offset:0}),!this._rowContainer.contains(n.node))return;const g=this._rowElements.slice(-1)[0];if(c.node.compareDocumentPosition(g)&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_PRECEDING)&&(c={node:g,offset:((y=g.textContent)==null?void 0:y.length)??0}),!this._rowContainer.contains(c.node))return;const S=({node:T,offset:O})=>{const P=T instanceof Text?T.parentNode:T;let D=parseInt(P==null?void 0:P.getAttribute("aria-posinset"),10)-1;if(isNaN(D))return console.warn("row is invalid. Race condition?"),null;const N=this._rowColumns.get(P);if(!N)return console.warn("columns is null. Race condition?"),null;let X=O<N.length?N[O]:N.slice(-1)[0]+1;return X>=this._terminal.cols&&(++D,X=0),{row:D,column:X}},C=S(n),f=S(c);if(C&&f){if(C.row>f.row||C.row===f.row&&C.column>=f.column)throw new Error("invalid range");this._terminal.select(C.column,C.row,(f.row-C.row)*this._terminal.cols-C.column+f.column)}}_handleResize(r){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let n=this._rowContainer.children.length;n<this._terminal.rows;n++)this._rowElements[n]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[n]);for(;this._rowElements.length>r;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){const r=this._coreBrowserService.mainDocument.createElement("div");return r.setAttribute("role","listitem"),r.tabIndex=-1,this._refreshRowDimensions(r),r}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let r=0;r<this._terminal.rows;r++)this._refreshRowDimensions(this._rowElements[r])}}_refreshRowDimensions(r){r.style.height=`${this._renderService.dimensions.css.cell.height}px`}};a.AccessibilityManager=o=_([p(1,d.IInstantiationService),p(2,b.ICoreBrowserService),p(3,b.IRenderService)],o)},3614:(j,a)=>{function u(v){return v.replace(/\r?\n/g,"\r")}function _(v,m){return m?"\x1B[200~"+v+"\x1B[201~":v}function p(v,m,b,d){v=_(v=u(v),b.decPrivateModes.bracketedPasteMode&&d.rawOptions.ignoreBracketedPasteMode!==!0),b.triggerDataEvent(v,!0),m.value=""}function l(v,m,b){const d=b.getBoundingClientRect(),s=v.clientX-d.left-10,o=v.clientY-d.top-10;m.style.width="20px",m.style.height="20px",m.style.left=`${s}px`,m.style.top=`${o}px`,m.style.zIndex="1000",m.focus()}Object.defineProperty(a,"__esModule",{value:!0}),a.rightClickHandler=a.moveTextAreaUnderMouseCursor=a.paste=a.handlePasteEvent=a.copyHandler=a.bracketTextForPaste=a.prepareTextForTerminal=void 0,a.prepareTextForTerminal=u,a.bracketTextForPaste=_,a.copyHandler=function(v,m){v.clipboardData&&v.clipboardData.setData("text/plain",m.selectionText),v.preventDefault()},a.handlePasteEvent=function(v,m,b,d){v.stopPropagation(),v.clipboardData&&p(v.clipboardData.getData("text/plain"),m,b,d)},a.paste=p,a.moveTextAreaUnderMouseCursor=l,a.rightClickHandler=function(v,m,b,d,s){l(v,m,b),s&&d.rightClickSelect(v),m.value=d.selectionText,m.select()}},7239:(j,a,u)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.ColorContrastCache=void 0;const _=u(1505);a.ColorContrastCache=class{constructor(){this._color=new _.TwoKeyMap,this._css=new _.TwoKeyMap}setCss(p,l,v){this._css.set(p,l,v)}getCss(p,l){return this._css.get(p,l)}setColor(p,l,v){this._color.set(p,l,v)}getColor(p,l){return this._color.get(p,l)}clear(){this._color.clear(),this._css.clear()}}},3656:(j,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.addDisposableDomListener=void 0,a.addDisposableDomListener=function(u,_,p,l){u.addEventListener(_,p,l);let v=!1;return{dispose:()=>{v||(v=!0,u.removeEventListener(_,p,l))}}}},3551:function(j,a,u){var _=this&&this.__decorate||function(o,r,n,c){var g,S=arguments.length,C=S<3?r:c===null?c=Object.getOwnPropertyDescriptor(r,n):c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(o,r,n,c);else for(var f=o.length-1;f>=0;f--)(g=o[f])&&(C=(S<3?g(C):S>3?g(r,n,C):g(r,n))||C);return S>3&&C&&Object.defineProperty(r,n,C),C},p=this&&this.__param||function(o,r){return function(n,c){r(n,c,o)}};Object.defineProperty(a,"__esModule",{value:!0}),a.Linkifier=void 0;const l=u(3656),v=u(8460),m=u(844),b=u(2585),d=u(4725);let s=a.Linkifier=class extends m.Disposable{get currentLink(){return this._currentLink}constructor(o,r,n,c,g){super(),this._element=o,this._mouseService=r,this._renderService=n,this._bufferService=c,this._linkProviderService=g,this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this.register(new v.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new v.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,m.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,m.toDisposable)(()=>{var S;this._lastMouseEvent=void 0,(S=this._activeProviderReplies)==null||S.clear()})),this.register(this._bufferService.onResize(()=>{this._clearCurrentLink(),this._wasResized=!0})),this.register((0,l.addDisposableDomListener)(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this.register((0,l.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,l.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,l.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(o){this._lastMouseEvent=o;const r=this._positionFromMouseEvent(o,this._element,this._mouseService);if(!r)return;this._isMouseOut=!1;const n=o.composedPath();for(let c=0;c<n.length;c++){const g=n[c];if(g.classList.contains("xterm"))break;if(g.classList.contains("xterm-hover"))return}this._lastBufferCell&&r.x===this._lastBufferCell.x&&r.y===this._lastBufferCell.y||(this._handleHover(r),this._lastBufferCell=r)}_handleHover(o){if(this._activeLine!==o.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(o,!1),void(this._wasResized=!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,o)||(this._clearCurrentLink(),this._askForLink(o,!0))}_askForLink(o,r){var c,g;this._activeProviderReplies&&r||((c=this._activeProviderReplies)==null||c.forEach(S=>{S==null||S.forEach(C=>{C.link.dispose&&C.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=o.y);let n=!1;for(const[S,C]of this._linkProviderService.linkProviders.entries())r?(g=this._activeProviderReplies)!=null&&g.get(S)&&(n=this._checkLinkProviderResult(S,o,n)):C.provideLinks(o.y,f=>{var T,O;if(this._isMouseOut)return;const y=f==null?void 0:f.map(P=>({link:P}));(T=this._activeProviderReplies)==null||T.set(S,y),n=this._checkLinkProviderResult(S,o,n),((O=this._activeProviderReplies)==null?void 0:O.size)===this._linkProviderService.linkProviders.length&&this._removeIntersectingLinks(o.y,this._activeProviderReplies)})}_removeIntersectingLinks(o,r){const n=new Set;for(let c=0;c<r.size;c++){const g=r.get(c);if(g)for(let S=0;S<g.length;S++){const C=g[S],f=C.link.range.start.y<o?0:C.link.range.start.x,y=C.link.range.end.y>o?this._bufferService.cols:C.link.range.end.x;for(let T=f;T<=y;T++){if(n.has(T)){g.splice(S--,1);break}n.add(T)}}}}_checkLinkProviderResult(o,r,n){var S;if(!this._activeProviderReplies)return n;const c=this._activeProviderReplies.get(o);let g=!1;for(let C=0;C<o;C++)this._activeProviderReplies.has(C)&&!this._activeProviderReplies.get(C)||(g=!0);if(!g&&c){const C=c.find(f=>this._linkAtPosition(f.link,r));C&&(n=!0,this._handleNewLink(C))}if(this._activeProviderReplies.size===this._linkProviderService.linkProviders.length&&!n)for(let C=0;C<this._activeProviderReplies.size;C++){const f=(S=this._activeProviderReplies.get(C))==null?void 0:S.find(y=>this._linkAtPosition(y.link,r));if(f){n=!0,this._handleNewLink(f);break}}return n}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(o){if(!this._currentLink)return;const r=this._positionFromMouseEvent(o,this._element,this._mouseService);r&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,r)&&this._currentLink.link.activate(o,this._currentLink.link.text)}_clearCurrentLink(o,r){this._currentLink&&this._lastMouseEvent&&(!o||!r||this._currentLink.link.range.start.y>=o&&this._currentLink.link.range.end.y<=r)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,m.disposeArray)(this._linkCacheDisposables))}_handleNewLink(o){if(!this._lastMouseEvent)return;const r=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);r&&this._linkAtPosition(o.link,r)&&(this._currentLink=o,this._currentLink.state={decorations:{underline:o.link.decorations===void 0||o.link.decorations.underline,pointerCursor:o.link.decorations===void 0||o.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,o.link,this._lastMouseEvent),o.link.decorations={},Object.defineProperties(o.link.decorations,{pointerCursor:{get:()=>{var n,c;return(c=(n=this._currentLink)==null?void 0:n.state)==null?void 0:c.decorations.pointerCursor},set:n=>{var c;(c=this._currentLink)!=null&&c.state&&this._currentLink.state.decorations.pointerCursor!==n&&(this._currentLink.state.decorations.pointerCursor=n,this._currentLink.state.isHovered&&this._element.classList.toggle("xterm-cursor-pointer",n))}},underline:{get:()=>{var n,c;return(c=(n=this._currentLink)==null?void 0:n.state)==null?void 0:c.decorations.underline},set:n=>{var c,g,S;(c=this._currentLink)!=null&&c.state&&((S=(g=this._currentLink)==null?void 0:g.state)==null?void 0:S.decorations.underline)!==n&&(this._currentLink.state.decorations.underline=n,this._currentLink.state.isHovered&&this._fireUnderlineEvent(o.link,n))}}}),this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(n=>{if(!this._currentLink)return;const c=n.start===0?0:n.start+1+this._bufferService.buffer.ydisp,g=this._bufferService.buffer.ydisp+1+n.end;if(this._currentLink.link.range.start.y>=c&&this._currentLink.link.range.end.y<=g&&(this._clearCurrentLink(c,g),this._lastMouseEvent)){const S=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);S&&this._askForLink(S,!1)}})))}_linkHover(o,r,n){var c;(c=this._currentLink)!=null&&c.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(r,!0),this._currentLink.state.decorations.pointerCursor&&o.classList.add("xterm-cursor-pointer")),r.hover&&r.hover(n,r.text)}_fireUnderlineEvent(o,r){const n=o.range,c=this._bufferService.buffer.ydisp,g=this._createLinkUnderlineEvent(n.start.x-1,n.start.y-c-1,n.end.x,n.end.y-c-1,void 0);(r?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(g)}_linkLeave(o,r,n){var c;(c=this._currentLink)!=null&&c.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(r,!1),this._currentLink.state.decorations.pointerCursor&&o.classList.remove("xterm-cursor-pointer")),r.leave&&r.leave(n,r.text)}_linkAtPosition(o,r){const n=o.range.start.y*this._bufferService.cols+o.range.start.x,c=o.range.end.y*this._bufferService.cols+o.range.end.x,g=r.y*this._bufferService.cols+r.x;return n<=g&&g<=c}_positionFromMouseEvent(o,r,n){const c=n.getCoords(o,r,this._bufferService.cols,this._bufferService.rows);if(c)return{x:c[0],y:c[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(o,r,n,c,g){return{x1:o,y1:r,x2:n,y2:c,cols:this._bufferService.cols,fg:g}}};a.Linkifier=s=_([p(1,d.IMouseService),p(2,d.IRenderService),p(3,b.IBufferService),p(4,d.ILinkProviderService)],s)},9042:(j,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.tooMuchOutput=a.promptLabel=void 0,a.promptLabel="Terminal input",a.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(j,a,u){var _=this&&this.__decorate||function(d,s,o,r){var n,c=arguments.length,g=c<3?s:r===null?r=Object.getOwnPropertyDescriptor(s,o):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(d,s,o,r);else for(var S=d.length-1;S>=0;S--)(n=d[S])&&(g=(c<3?n(g):c>3?n(s,o,g):n(s,o))||g);return c>3&&g&&Object.defineProperty(s,o,g),g},p=this&&this.__param||function(d,s){return function(o,r){s(o,r,d)}};Object.defineProperty(a,"__esModule",{value:!0}),a.OscLinkProvider=void 0;const l=u(511),v=u(2585);let m=a.OscLinkProvider=class{constructor(d,s,o){this._bufferService=d,this._optionsService=s,this._oscLinkService=o}provideLinks(d,s){var y;const o=this._bufferService.buffer.lines.get(d-1);if(!o)return void s(void 0);const r=[],n=this._optionsService.rawOptions.linkHandler,c=new l.CellData,g=o.getTrimmedLength();let S=-1,C=-1,f=!1;for(let T=0;T<g;T++)if(C!==-1||o.hasContent(T)){if(o.loadCell(T,c),c.hasExtendedAttrs()&&c.extended.urlId){if(C===-1){C=T,S=c.extended.urlId;continue}f=c.extended.urlId!==S}else C!==-1&&(f=!0);if(f||C!==-1&&T===g-1){const O=(y=this._oscLinkService.getLinkData(S))==null?void 0:y.uri;if(O){const P={start:{x:C+1,y:d},end:{x:T+(f||T!==g-1?0:1),y:d}};let D=!1;if(!(n!=null&&n.allowNonHttpProtocols))try{const N=new URL(O);["http:","https:"].includes(N.protocol)||(D=!0)}catch{D=!0}D||r.push({text:O,range:P,activate:(N,X)=>n?n.activate(N,X,P):b(0,X),hover:(N,X)=>{var Z;return(Z=n==null?void 0:n.hover)==null?void 0:Z.call(n,N,X,P)},leave:(N,X)=>{var Z;return(Z=n==null?void 0:n.leave)==null?void 0:Z.call(n,N,X,P)}})}f=!1,c.hasExtendedAttrs()&&c.extended.urlId?(C=T,S=c.extended.urlId):(C=-1,S=-1)}}s(r)}};function b(d,s){if(confirm(`Do you want to navigate to ${s}?

WARNING: This link could potentially be dangerous`)){const o=window.open();if(o){try{o.opener=null}catch{}o.location.href=s}else console.warn("Opening link blocked as opener could not be cleared")}}a.OscLinkProvider=m=_([p(0,v.IBufferService),p(1,v.IOptionsService),p(2,v.IOscLinkService)],m)},6193:(j,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.RenderDebouncer=void 0,a.RenderDebouncer=class{constructor(u,_){this._renderCallback=u,this._coreBrowserService=_,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(u){return this._refreshCallbacks.push(u),this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(u,_,p){this._rowCount=p,u=u!==void 0?u:0,_=_!==void 0?_:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,u):u,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,_):_,this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();const u=Math.max(this._rowStart,0),_=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(u,_),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(const u of this._refreshCallbacks)u(0);this._refreshCallbacks=[]}}},3236:(j,a,u)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.Terminal=void 0;const _=u(3614),p=u(3656),l=u(3551),v=u(9042),m=u(3730),b=u(1680),d=u(3107),s=u(5744),o=u(2950),r=u(1296),n=u(428),c=u(4269),g=u(5114),S=u(8934),C=u(3230),f=u(9312),y=u(4725),T=u(6731),O=u(8055),P=u(8969),D=u(8460),N=u(844),X=u(6114),Z=u(8437),se=u(2584),ee=u(7399),E=u(5941),A=u(9074),M=u(2585),H=u(5435),Q=u(4567),re=u(779);class le extends P.CoreTerminal{get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}constructor(U={}){super(U),this.browser=X,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._accessibilityManager=this.register(new N.MutableDisposable),this._onCursorMove=this.register(new D.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new D.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new D.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new D.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new D.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new D.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new D.EventEmitter),this._onBlur=this.register(new D.EventEmitter),this._onA11yCharEmitter=this.register(new D.EventEmitter),this._onA11yTabEmitter=this.register(new D.EventEmitter),this._onWillOpen=this.register(new D.EventEmitter),this._setup(),this._decorationService=this._instantiationService.createInstance(A.DecorationService),this._instantiationService.setService(M.IDecorationService,this._decorationService),this._linkProviderService=this._instantiationService.createInstance(re.LinkProviderService),this._instantiationService.setService(y.ILinkProviderService,this._linkProviderService),this._linkProviderService.registerLinkProvider(this._instantiationService.createInstance(m.OscLinkProvider)),this.register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this.register(this._inputHandler.onRequestRefreshRows((R,J)=>this.refresh(R,J))),this.register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this.register(this._inputHandler.onRequestReset(()=>this.reset())),this.register(this._inputHandler.onRequestWindowsOptionsReport(R=>this._reportWindowsOptions(R))),this.register(this._inputHandler.onColor(R=>this._handleColorEvent(R))),this.register((0,D.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,D.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,D.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,D.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize(R=>this._afterResize(R.cols,R.rows))),this.register((0,N.toDisposable)(()=>{var R,J;this._customKeyEventHandler=void 0,(J=(R=this.element)==null?void 0:R.parentNode)==null||J.removeChild(this.element)}))}_handleColorEvent(U){if(this._themeService)for(const R of U){let J,z="";switch(R.index){case 256:J="foreground",z="10";break;case 257:J="background",z="11";break;case 258:J="cursor",z="12";break;default:J="ansi",z="4;"+R.index}switch(R.type){case 0:const ne=O.color.toColorRGB(J==="ansi"?this._themeService.colors.ansi[R.index]:this._themeService.colors[J]);this.coreService.triggerDataEvent(`${se.C0.ESC}]${z};${(0,E.toRgbString)(ne)}${se.C1_ESCAPED.ST}`);break;case 1:if(J==="ansi")this._themeService.modifyColors(ie=>ie.ansi[R.index]=O.channels.toColor(...R.color));else{const ie=J;this._themeService.modifyColors(Ee=>Ee[ie]=O.channels.toColor(...R.color))}break;case 2:this._themeService.restoreColor(R.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(U){U?!this._accessibilityManager.value&&this._renderService&&(this._accessibilityManager.value=this._instantiationService.createInstance(Q.AccessibilityManager,this)):this._accessibilityManager.clear()}_handleTextAreaFocus(U){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(se.C0.ESC+"[I"),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){var U;return(U=this.textarea)==null?void 0:U.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(se.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;const U=this.buffer.ybase+this.buffer.y,R=this.buffer.lines.get(U);if(!R)return;const J=Math.min(this.buffer.x,this.cols-1),z=this._renderService.dimensions.css.cell.height,ne=R.getWidth(J),ie=this._renderService.dimensions.css.cell.width*ne,Ee=this.buffer.y*this._renderService.dimensions.css.cell.height,Le=J*this._renderService.dimensions.css.cell.width;this.textarea.style.left=Le+"px",this.textarea.style.top=Ee+"px",this.textarea.style.width=ie+"px",this.textarea.style.height=z+"px",this.textarea.style.lineHeight=z+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,p.addDisposableDomListener)(this.element,"copy",R=>{this.hasSelection()&&(0,_.copyHandler)(R,this._selectionService)}));const U=R=>(0,_.handlePasteEvent)(R,this.textarea,this.coreService,this.optionsService);this.register((0,p.addDisposableDomListener)(this.textarea,"paste",U)),this.register((0,p.addDisposableDomListener)(this.element,"paste",U)),X.isFirefox?this.register((0,p.addDisposableDomListener)(this.element,"mousedown",R=>{R.button===2&&(0,_.rightClickHandler)(R,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this.register((0,p.addDisposableDomListener)(this.element,"contextmenu",R=>{(0,_.rightClickHandler)(R,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),X.isLinux&&this.register((0,p.addDisposableDomListener)(this.element,"auxclick",R=>{R.button===1&&(0,_.moveTextAreaUnderMouseCursor)(R,this.textarea,this.screenElement)}))}_bindKeys(){this.register((0,p.addDisposableDomListener)(this.textarea,"keyup",U=>this._keyUp(U),!0)),this.register((0,p.addDisposableDomListener)(this.textarea,"keydown",U=>this._keyDown(U),!0)),this.register((0,p.addDisposableDomListener)(this.textarea,"keypress",U=>this._keyPress(U),!0)),this.register((0,p.addDisposableDomListener)(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this.register((0,p.addDisposableDomListener)(this.textarea,"compositionupdate",U=>this._compositionHelper.compositionupdate(U))),this.register((0,p.addDisposableDomListener)(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this.register((0,p.addDisposableDomListener)(this.textarea,"input",U=>this._inputEvent(U),!0)),this.register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(U){var J;if(!U)throw new Error("Terminal requires a parent element.");if(U.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),((J=this.element)==null?void 0:J.ownerDocument.defaultView)&&this._coreBrowserService)return void(this.element.ownerDocument.defaultView!==this._coreBrowserService.window&&(this._coreBrowserService.window=this.element.ownerDocument.defaultView));this._document=U.ownerDocument,this.options.documentOverride&&this.options.documentOverride instanceof Document&&(this._document=this.optionsService.rawOptions.documentOverride),this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),U.appendChild(this.element);const R=this._document.createDocumentFragment();this._viewportElement=this._document.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),R.appendChild(this._viewportElement),this._viewportScrollArea=this._document.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=this._document.createElement("div"),this.screenElement.classList.add("xterm-screen"),this.register((0,p.addDisposableDomListener)(this.screenElement,"mousemove",z=>this.updateCursorStyle(z))),this._helperContainer=this._document.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),R.appendChild(this.screenElement),this.textarea=this._document.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",v.promptLabel),X.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this.register(this._instantiationService.createInstance(g.CoreBrowserService,this.textarea,U.ownerDocument.defaultView??window,this._document??typeof window<"u"?window.document:null)),this._instantiationService.setService(y.ICoreBrowserService,this._coreBrowserService),this.register((0,p.addDisposableDomListener)(this.textarea,"focus",z=>this._handleTextAreaFocus(z))),this.register((0,p.addDisposableDomListener)(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(n.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(y.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(T.ThemeService),this._instantiationService.setService(y.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(c.CharacterJoinerService),this._instantiationService.setService(y.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(C.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(y.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange(z=>this._onRender.fire(z))),this.onResize(z=>this._renderService.resize(z.cols,z.rows)),this._compositionView=this._document.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(o.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this._mouseService=this._instantiationService.createInstance(S.MouseService),this._instantiationService.setService(y.IMouseService,this._mouseService),this.linkifier=this.register(this._instantiationService.createInstance(l.Linkifier,this.screenElement)),this.element.appendChild(R);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this.viewport=this._instantiationService.createInstance(b.Viewport,this._viewportElement,this._viewportScrollArea),this.viewport.onRequestScrollLines(z=>this.scrollLines(z.amount,z.suppressScrollEvent,1)),this.register(this._inputHandler.onRequestSyncScrollBar(()=>this.viewport.syncScrollArea())),this.register(this.viewport),this.register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this.register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this.register(this.onBlur(()=>this._renderService.handleBlur())),this.register(this.onFocus(()=>this._renderService.handleFocus())),this.register(this._renderService.onDimensionsChange(()=>this.viewport.syncScrollArea())),this._selectionService=this.register(this._instantiationService.createInstance(f.SelectionService,this.element,this.screenElement,this.linkifier)),this._instantiationService.setService(y.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines(z=>this.scrollLines(z.amount,z.suppressScrollEvent))),this.register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this.register(this._selectionService.onRequestRedraw(z=>this._renderService.handleSelectionChanged(z.start,z.end,z.columnSelectMode))),this.register(this._selectionService.onLinuxMouseSelection(z=>{this.textarea.value=z,this.textarea.focus(),this.textarea.select()})),this.register(this._onScroll.event(z=>{this.viewport.syncScrollArea(),this._selectionService.refresh()})),this.register((0,p.addDisposableDomListener)(this._viewportElement,"scroll",()=>this._selectionService.refresh())),this.register(this._instantiationService.createInstance(d.BufferDecorationRenderer,this.screenElement)),this.register((0,p.addDisposableDomListener)(this.element,"mousedown",z=>this._selectionService.handleMouseDown(z))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager.value=this._instantiationService.createInstance(Q.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",z=>this._handleScreenReaderModeOptionChange(z))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(s.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",z=>{!this._overviewRulerRenderer&&z&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(s.OverviewRulerRenderer,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(r.DomRenderer,this,this._document,this.element,this.screenElement,this._viewportElement,this._helperContainer,this.linkifier)}bindMouse(){const U=this,R=this.element;function J(ie){const Ee=U._mouseService.getMouseReportCoords(ie,U.screenElement);if(!Ee)return!1;let Le,Me;switch(ie.overrideType||ie.type){case"mousemove":Me=32,ie.buttons===void 0?(Le=3,ie.button!==void 0&&(Le=ie.button<3?ie.button:3)):Le=1&ie.buttons?0:4&ie.buttons?1:2&ie.buttons?2:3;break;case"mouseup":Me=0,Le=ie.button<3?ie.button:3;break;case"mousedown":Me=1,Le=ie.button<3?ie.button:3;break;case"wheel":if(U._customWheelEventHandler&&U._customWheelEventHandler(ie)===!1||U.viewport.getLinesScrolled(ie)===0)return!1;Me=ie.deltaY<0?0:1,Le=4;break;default:return!1}return!(Me===void 0||Le===void 0||Le>4)&&U.coreMouseService.triggerMouseEvent({col:Ee.col,row:Ee.row,x:Ee.x,y:Ee.y,button:Le,action:Me,ctrl:ie.ctrlKey,alt:ie.altKey,shift:ie.shiftKey})}const z={mouseup:null,wheel:null,mousedrag:null,mousemove:null},ne={mouseup:ie=>(J(ie),ie.buttons||(this._document.removeEventListener("mouseup",z.mouseup),z.mousedrag&&this._document.removeEventListener("mousemove",z.mousedrag)),this.cancel(ie)),wheel:ie=>(J(ie),this.cancel(ie,!0)),mousedrag:ie=>{ie.buttons&&J(ie)},mousemove:ie=>{ie.buttons||J(ie)}};this.register(this.coreMouseService.onProtocolChange(ie=>{ie?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(ie)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&ie?z.mousemove||(R.addEventListener("mousemove",ne.mousemove),z.mousemove=ne.mousemove):(R.removeEventListener("mousemove",z.mousemove),z.mousemove=null),16&ie?z.wheel||(R.addEventListener("wheel",ne.wheel,{passive:!1}),z.wheel=ne.wheel):(R.removeEventListener("wheel",z.wheel),z.wheel=null),2&ie?z.mouseup||(z.mouseup=ne.mouseup):(this._document.removeEventListener("mouseup",z.mouseup),z.mouseup=null),4&ie?z.mousedrag||(z.mousedrag=ne.mousedrag):(this._document.removeEventListener("mousemove",z.mousedrag),z.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,p.addDisposableDomListener)(R,"mousedown",ie=>{if(ie.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(ie))return J(ie),z.mouseup&&this._document.addEventListener("mouseup",z.mouseup),z.mousedrag&&this._document.addEventListener("mousemove",z.mousedrag),this.cancel(ie)})),this.register((0,p.addDisposableDomListener)(R,"wheel",ie=>{if(!z.wheel){if(this._customWheelEventHandler&&this._customWheelEventHandler(ie)===!1)return!1;if(!this.buffer.hasScrollback){const Ee=this.viewport.getLinesScrolled(ie);if(Ee===0)return;const Le=se.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(ie.deltaY<0?"A":"B");let Me="";for(let Je=0;Je<Math.abs(Ee);Je++)Me+=Le;return this.coreService.triggerDataEvent(Me,!0),this.cancel(ie,!0)}return this.viewport.handleWheel(ie)?this.cancel(ie):void 0}},{passive:!1})),this.register((0,p.addDisposableDomListener)(R,"touchstart",ie=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(ie),this.cancel(ie)},{passive:!0})),this.register((0,p.addDisposableDomListener)(R,"touchmove",ie=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(ie)?void 0:this.cancel(ie)},{passive:!1}))}refresh(U,R){var J;(J=this._renderService)==null||J.refreshRows(U,R)}updateCursorStyle(U){var R;(R=this._selectionService)!=null&&R.shouldColumnSelect(U)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(U,R,J=0){var z;J===1?(super.scrollLines(U,R,J),this.refresh(0,this.rows-1)):(z=this.viewport)==null||z.scrollLines(U)}paste(U){(0,_.paste)(U,this.textarea,this.coreService,this.optionsService)}attachCustomKeyEventHandler(U){this._customKeyEventHandler=U}attachCustomWheelEventHandler(U){this._customWheelEventHandler=U}registerLinkProvider(U){return this._linkProviderService.registerLinkProvider(U)}registerCharacterJoiner(U){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");const R=this._characterJoinerService.register(U);return this.refresh(0,this.rows-1),R}deregisterCharacterJoiner(U){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(U)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}registerMarker(U){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+U)}registerDecoration(U){return this._decorationService.registerDecoration(U)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(U,R,J){this._selectionService.setSelection(U,R,J)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){var U;(U=this._selectionService)==null||U.clearSelection()}selectAll(){var U;(U=this._selectionService)==null||U.selectAll()}selectLines(U,R){var J;(J=this._selectionService)==null||J.selectLines(U,R)}_keyDown(U){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(U)===!1)return!1;const R=this.browser.isMac&&this.options.macOptionIsMeta&&U.altKey;if(!R&&!this._compositionHelper.keydown(U))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(),!1;R||U.key!=="Dead"&&U.key!=="AltGraph"||(this._unprocessedDeadKey=!0);const J=(0,ee.evaluateKeyboardEvent)(U,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(U),J.type===3||J.type===2){const z=this.rows-1;return this.scrollLines(J.type===2?-z:z),this.cancel(U,!0)}return J.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,U)||(J.cancel&&this.cancel(U,!0),!J.key||!!(U.key&&!U.ctrlKey&&!U.altKey&&!U.metaKey&&U.key.length===1&&U.key.charCodeAt(0)>=65&&U.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(J.key!==se.C0.ETX&&J.key!==se.C0.CR||(this.textarea.value=""),this._onKey.fire({key:J.key,domEvent:U}),this._showCursor(),this.coreService.triggerDataEvent(J.key,!0),!this.optionsService.rawOptions.screenReaderMode||U.altKey||U.ctrlKey?this.cancel(U,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(U,R){const J=U.isMac&&!this.options.macOptionIsMeta&&R.altKey&&!R.ctrlKey&&!R.metaKey||U.isWindows&&R.altKey&&R.ctrlKey&&!R.metaKey||U.isWindows&&R.getModifierState("AltGraph");return R.type==="keypress"?J:J&&(!R.keyCode||R.keyCode>47)}_keyUp(U){this._keyDownSeen=!1,this._customKeyEventHandler&&this._customKeyEventHandler(U)===!1||(function(R){return R.keyCode===16||R.keyCode===17||R.keyCode===18}(U)||this.focus(),this.updateCursorStyle(U),this._keyPressHandled=!1)}_keyPress(U){let R;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(U)===!1)return!1;if(this.cancel(U),U.charCode)R=U.charCode;else if(U.which===null||U.which===void 0)R=U.keyCode;else{if(U.which===0||U.charCode===0)return!1;R=U.which}return!(!R||(U.altKey||U.ctrlKey||U.metaKey)&&!this._isThirdLevelShift(this.browser,U)||(R=String.fromCharCode(R),this._onKey.fire({key:R,domEvent:U}),this._showCursor(),this.coreService.triggerDataEvent(R,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(U){if(U.data&&U.inputType==="insertText"&&(!U.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;const R=U.data;return this.coreService.triggerDataEvent(R,!0),this.cancel(U),!0}return!1}resize(U,R){U!==this.cols||R!==this.rows?super.resize(U,R):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(U,R){var J,z;(J=this._charSizeService)==null||J.measure(),(z=this.viewport)==null||z.syncScrollArea(!0)}clear(){var U;if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let R=1;R<this.rows;R++)this.buffer.lines.push(this.buffer.getBlankLine(Z.DEFAULT_ATTR_DATA));this._onScroll.fire({position:this.buffer.ydisp,source:0}),(U=this.viewport)==null||U.reset(),this.refresh(0,this.rows-1)}}reset(){var R,J;this.options.rows=this.rows,this.options.cols=this.cols;const U=this._customKeyEventHandler;this._setup(),super.reset(),(R=this._selectionService)==null||R.reset(),this._decorationService.reset(),(J=this.viewport)==null||J.reset(),this._customKeyEventHandler=U,this.refresh(0,this.rows-1)}clearTextureAtlas(){var U;(U=this._renderService)==null||U.clearTextureAtlas()}_reportFocus(){var U;(U=this.element)!=null&&U.classList.contains("focus")?this.coreService.triggerDataEvent(se.C0.ESC+"[I"):this.coreService.triggerDataEvent(se.C0.ESC+"[O")}_reportWindowsOptions(U){if(this._renderService)switch(U){case H.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:const R=this._renderService.dimensions.css.canvas.width.toFixed(0),J=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${se.C0.ESC}[4;${J};${R}t`);break;case H.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:const z=this._renderService.dimensions.css.cell.width.toFixed(0),ne=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${se.C0.ESC}[6;${ne};${z}t`)}}cancel(U,R){if(this.options.cancelEvents||R)return U.preventDefault(),U.stopPropagation(),!1}}a.Terminal=le},9924:(j,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.TimeBasedDebouncer=void 0,a.TimeBasedDebouncer=class{constructor(u,_=1e3){this._renderCallback=u,this._debounceThresholdMS=_,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(u,_,p){this._rowCount=p,u=u!==void 0?u:0,_=_!==void 0?_:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,u):u,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,_):_;const l=Date.now();if(l-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=l,this._innerRefresh();else if(!this._additionalRefreshRequested){const v=l-this._lastRefreshMs,m=this._debounceThresholdMS-v;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},m)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;const u=Math.max(this._rowStart,0),_=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(u,_)}}},1680:function(j,a,u){var _=this&&this.__decorate||function(o,r,n,c){var g,S=arguments.length,C=S<3?r:c===null?c=Object.getOwnPropertyDescriptor(r,n):c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(o,r,n,c);else for(var f=o.length-1;f>=0;f--)(g=o[f])&&(C=(S<3?g(C):S>3?g(r,n,C):g(r,n))||C);return S>3&&C&&Object.defineProperty(r,n,C),C},p=this&&this.__param||function(o,r){return function(n,c){r(n,c,o)}};Object.defineProperty(a,"__esModule",{value:!0}),a.Viewport=void 0;const l=u(3656),v=u(4725),m=u(8460),b=u(844),d=u(2585);let s=a.Viewport=class extends b.Disposable{constructor(o,r,n,c,g,S,C,f){super(),this._viewportElement=o,this._scrollArea=r,this._bufferService=n,this._optionsService=c,this._charSizeService=g,this._renderService=S,this._coreBrowserService=C,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this._onRequestScrollLines=this.register(new m.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,l.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(y=>this._activeBuffer=y.activeBuffer)),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange(y=>this._renderDimensions=y)),this._handleThemeChange(f.colors),this.register(f.onChangeColors(y=>this._handleThemeChange(y))),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.syncScrollArea())),setTimeout(()=>this.syncScrollArea())}_handleThemeChange(o){this._viewportElement.style.backgroundColor=o.background.css}reset(){this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._coreBrowserService.window.requestAnimationFrame(()=>this.syncScrollArea())}_refresh(o){if(o)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderDimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderDimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;const r=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderDimensions.css.canvas.height);this._lastRecordedBufferHeight!==r&&(this._lastRecordedBufferHeight=r,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}const o=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==o&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=o),this._refreshAnimationFrame=null}syncScrollArea(o=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(o);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(o)}_handleScroll(o){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._onRequestScrollLines.fire({amount:0,suppressScrollEvent:!0});const r=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._onRequestScrollLines.fire({amount:r,suppressScrollEvent:!0})}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;const o=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(o*(this._smoothScrollState.target-this._smoothScrollState.origin)),o<1?this._coreBrowserService.window.requestAnimationFrame(()=>this._smoothScroll()):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(o,r){const n=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(r<0&&this._viewportElement.scrollTop!==0||r>0&&n<this._lastRecordedBufferHeight)||(o.cancelable&&o.preventDefault(),!1)}handleWheel(o){const r=this._getPixelsScrolled(o);return r!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+r:this._smoothScrollState.target+=r,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=r,this._bubbleScroll(o,r))}scrollLines(o){if(o!==0)if(this._optionsService.rawOptions.smoothScrollDuration){const r=o*this._currentRowHeight;this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target=this._smoothScrollState.origin+r,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()}else this._onRequestScrollLines.fire({amount:o,suppressScrollEvent:!1})}_getPixelsScrolled(o){if(o.deltaY===0||o.shiftKey)return 0;let r=this._applyScrollModifier(o.deltaY,o);return o.deltaMode===WheelEvent.DOM_DELTA_LINE?r*=this._currentRowHeight:o.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(r*=this._currentRowHeight*this._bufferService.rows),r}getBufferElements(o,r){var f;let n,c="";const g=[],S=r??this._bufferService.buffer.lines.length,C=this._bufferService.buffer.lines;for(let y=o;y<S;y++){const T=C.get(y);if(!T)continue;const O=(f=C.get(y+1))==null?void 0:f.isWrapped;if(c+=T.translateToString(!O),!O||y===C.length-1){const P=document.createElement("div");P.textContent=c,g.push(P),c.length>0&&(n=P),c=""}}return{bufferElements:g,cursorElement:n}}getLinesScrolled(o){if(o.deltaY===0||o.shiftKey)return 0;let r=this._applyScrollModifier(o.deltaY,o);return o.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(r/=this._currentRowHeight+0,this._wheelPartialScroll+=r,r=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):o.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(r*=this._bufferService.rows),r}_applyScrollModifier(o,r){const n=this._optionsService.rawOptions.fastScrollModifier;return n==="alt"&&r.altKey||n==="ctrl"&&r.ctrlKey||n==="shift"&&r.shiftKey?o*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:o*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(o){this._lastTouchY=o.touches[0].pageY}handleTouchMove(o){const r=this._lastTouchY-o.touches[0].pageY;return this._lastTouchY=o.touches[0].pageY,r!==0&&(this._viewportElement.scrollTop+=r,this._bubbleScroll(o,r))}};a.Viewport=s=_([p(2,d.IBufferService),p(3,d.IOptionsService),p(4,v.ICharSizeService),p(5,v.IRenderService),p(6,v.ICoreBrowserService),p(7,v.IThemeService)],s)},3107:function(j,a,u){var _=this&&this.__decorate||function(d,s,o,r){var n,c=arguments.length,g=c<3?s:r===null?r=Object.getOwnPropertyDescriptor(s,o):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(d,s,o,r);else for(var S=d.length-1;S>=0;S--)(n=d[S])&&(g=(c<3?n(g):c>3?n(s,o,g):n(s,o))||g);return c>3&&g&&Object.defineProperty(s,o,g),g},p=this&&this.__param||function(d,s){return function(o,r){s(o,r,d)}};Object.defineProperty(a,"__esModule",{value:!0}),a.BufferDecorationRenderer=void 0;const l=u(4725),v=u(844),m=u(2585);let b=a.BufferDecorationRenderer=class extends v.Disposable{constructor(d,s,o,r,n){super(),this._screenElement=d,this._bufferService=s,this._coreBrowserService=o,this._decorationService=r,this._renderService=n,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this.register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this.register(this._coreBrowserService.onDprChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this.register(this._decorationService.onDecorationRemoved(c=>this._removeDecoration(c))),this.register((0,v.toDisposable)(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(const d of this._decorationService.decorations)this._renderDecoration(d);this._dimensionsChanged=!1}_renderDecoration(d){this._refreshStyle(d),this._dimensionsChanged&&this._refreshXPosition(d)}_createElement(d){var r;const s=this._coreBrowserService.mainDocument.createElement("div");s.classList.add("xterm-decoration"),s.classList.toggle("xterm-decoration-top-layer",((r=d==null?void 0:d.options)==null?void 0:r.layer)==="top"),s.style.width=`${Math.round((d.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,s.style.height=(d.options.height||1)*this._renderService.dimensions.css.cell.height+"px",s.style.top=(d.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",s.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;const o=d.options.x??0;return o&&o>this._bufferService.cols&&(s.style.display="none"),this._refreshXPosition(d,s),s}_refreshStyle(d){const s=d.marker.line-this._bufferService.buffers.active.ydisp;if(s<0||s>=this._bufferService.rows)d.element&&(d.element.style.display="none",d.onRenderEmitter.fire(d.element));else{let o=this._decorationElements.get(d);o||(o=this._createElement(d),d.element=o,this._decorationElements.set(d,o),this._container.appendChild(o),d.onDispose(()=>{this._decorationElements.delete(d),o.remove()})),o.style.top=s*this._renderService.dimensions.css.cell.height+"px",o.style.display=this._altBufferIsActive?"none":"block",d.onRenderEmitter.fire(o)}}_refreshXPosition(d,s=d.element){if(!s)return;const o=d.options.x??0;(d.options.anchor||"left")==="right"?s.style.right=o?o*this._renderService.dimensions.css.cell.width+"px":"":s.style.left=o?o*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(d){var s;(s=this._decorationElements.get(d))==null||s.remove(),this._decorationElements.delete(d),d.dispose()}};a.BufferDecorationRenderer=b=_([p(1,m.IBufferService),p(2,l.ICoreBrowserService),p(3,m.IDecorationService),p(4,l.IRenderService)],b)},5871:(j,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.ColorZoneStore=void 0,a.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(u){if(u.options.overviewRulerOptions){for(const _ of this._zones)if(_.color===u.options.overviewRulerOptions.color&&_.position===u.options.overviewRulerOptions.position){if(this._lineIntersectsZone(_,u.marker.line))return;if(this._lineAdjacentToZone(_,u.marker.line,u.options.overviewRulerOptions.position))return void this._addLineToZone(_,u.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=u.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=u.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=u.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=u.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:u.options.overviewRulerOptions.color,position:u.options.overviewRulerOptions.position,startBufferLine:u.marker.line,endBufferLine:u.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(u){this._linePadding=u}_lineIntersectsZone(u,_){return _>=u.startBufferLine&&_<=u.endBufferLine}_lineAdjacentToZone(u,_,p){return _>=u.startBufferLine-this._linePadding[p||"full"]&&_<=u.endBufferLine+this._linePadding[p||"full"]}_addLineToZone(u,_){u.startBufferLine=Math.min(u.startBufferLine,_),u.endBufferLine=Math.max(u.endBufferLine,_)}}},5744:function(j,a,u){var _=this&&this.__decorate||function(n,c,g,S){var C,f=arguments.length,y=f<3?c:S===null?S=Object.getOwnPropertyDescriptor(c,g):S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(n,c,g,S);else for(var T=n.length-1;T>=0;T--)(C=n[T])&&(y=(f<3?C(y):f>3?C(c,g,y):C(c,g))||y);return f>3&&y&&Object.defineProperty(c,g,y),y},p=this&&this.__param||function(n,c){return function(g,S){c(g,S,n)}};Object.defineProperty(a,"__esModule",{value:!0}),a.OverviewRulerRenderer=void 0;const l=u(5871),v=u(4725),m=u(844),b=u(2585),d={full:0,left:0,center:0,right:0},s={full:0,left:0,center:0,right:0},o={full:0,left:0,center:0,right:0};let r=a.OverviewRulerRenderer=class extends m.Disposable{get _width(){return this._optionsService.options.overviewRulerWidth||0}constructor(n,c,g,S,C,f,y){var O;super(),this._viewportElement=n,this._screenElement=c,this._bufferService=g,this._decorationService=S,this._renderService=C,this._optionsService=f,this._coreBrowserService=y,this._colorZoneStore=new l.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=this._coreBrowserService.mainDocument.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),(O=this._viewportElement.parentElement)==null||O.insertBefore(this._canvas,this._viewportElement);const T=this._canvas.getContext("2d");if(!T)throw new Error("Ctx cannot be null");this._ctx=T,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,m.toDisposable)(()=>{var P;(P=this._canvas)==null||P.remove()}))}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this.register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0)))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender(()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",()=>this._queueRefresh(!0))),this.register(this._coreBrowserService.onDprChange(()=>this._queueRefresh(!0))),this._queueRefresh(!0)}_refreshDrawConstants(){const n=Math.floor(this._canvas.width/3),c=Math.ceil(this._canvas.width/3);s.full=this._canvas.width,s.left=n,s.center=c,s.right=n,this._refreshDrawHeightConstants(),o.full=0,o.left=0,o.center=s.left,o.right=s.left+s.center}_refreshDrawHeightConstants(){d.full=Math.round(2*this._coreBrowserService.dpr);const n=this._canvas.height/this._bufferService.buffer.lines.length,c=Math.round(Math.max(Math.min(n,12),6)*this._coreBrowserService.dpr);d.left=c,d.center=c,d.right=c}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*d.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*d.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*d.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*d.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowserService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowserService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(const c of this._decorationService.decorations)this._colorZoneStore.addDecoration(c);this._ctx.lineWidth=1;const n=this._colorZoneStore.zones;for(const c of n)c.position!=="full"&&this._renderColorZone(c);for(const c of n)c.position==="full"&&this._renderColorZone(c);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(n){this._ctx.fillStyle=n.color,this._ctx.fillRect(o[n.position||"full"],Math.round((this._canvas.height-1)*(n.startBufferLine/this._bufferService.buffers.active.lines.length)-d[n.position||"full"]/2),s[n.position||"full"],Math.round((this._canvas.height-1)*((n.endBufferLine-n.startBufferLine)/this._bufferService.buffers.active.lines.length)+d[n.position||"full"]))}_queueRefresh(n,c){this._shouldUpdateDimensions=n||this._shouldUpdateDimensions,this._shouldUpdateAnchor=c||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};a.OverviewRulerRenderer=r=_([p(2,b.IBufferService),p(3,b.IDecorationService),p(4,v.IRenderService),p(5,b.IOptionsService),p(6,v.ICoreBrowserService)],r)},2950:function(j,a,u){var _=this&&this.__decorate||function(d,s,o,r){var n,c=arguments.length,g=c<3?s:r===null?r=Object.getOwnPropertyDescriptor(s,o):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(d,s,o,r);else for(var S=d.length-1;S>=0;S--)(n=d[S])&&(g=(c<3?n(g):c>3?n(s,o,g):n(s,o))||g);return c>3&&g&&Object.defineProperty(s,o,g),g},p=this&&this.__param||function(d,s){return function(o,r){s(o,r,d)}};Object.defineProperty(a,"__esModule",{value:!0}),a.CompositionHelper=void 0;const l=u(4725),v=u(2585),m=u(2584);let b=a.CompositionHelper=class{get isComposing(){return this._isComposing}constructor(d,s,o,r,n,c){this._textarea=d,this._compositionView=s,this._bufferService=o,this._optionsService=r,this._coreService=n,this._renderService=c,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(d){this._compositionView.textContent=d.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(d){if(this._isComposing||this._isSendingComposition){if(d.keyCode===229||d.keyCode===16||d.keyCode===17||d.keyCode===18)return!1;this._finalizeComposition(!1)}return d.keyCode!==229||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(d){if(this._compositionView.classList.remove("active"),this._isComposing=!1,d){const s={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){let o;this._isSendingComposition=!1,s.start+=this._dataAlreadySent.length,o=this._isComposing?this._textarea.value.substring(s.start,s.end):this._textarea.value.substring(s.start),o.length>0&&this._coreService.triggerDataEvent(o,!0)}},0)}else{this._isSendingComposition=!1;const s=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(s,!0)}}_handleAnyTextareaChanges(){const d=this._textarea.value;setTimeout(()=>{if(!this._isComposing){const s=this._textarea.value,o=s.replace(d,"");this._dataAlreadySent=o,s.length>d.length?this._coreService.triggerDataEvent(o,!0):s.length<d.length?this._coreService.triggerDataEvent(`${m.C0.DEL}`,!0):s.length===d.length&&s!==d&&this._coreService.triggerDataEvent(s,!0)}},0)}updateCompositionElements(d){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){const s=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),o=this._renderService.dimensions.css.cell.height,r=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,n=s*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=n+"px",this._compositionView.style.top=r+"px",this._compositionView.style.height=o+"px",this._compositionView.style.lineHeight=o+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";const c=this._compositionView.getBoundingClientRect();this._textarea.style.left=n+"px",this._textarea.style.top=r+"px",this._textarea.style.width=Math.max(c.width,1)+"px",this._textarea.style.height=Math.max(c.height,1)+"px",this._textarea.style.lineHeight=c.height+"px"}d||setTimeout(()=>this.updateCompositionElements(!0),0)}}};a.CompositionHelper=b=_([p(2,v.IBufferService),p(3,v.IOptionsService),p(4,v.ICoreService),p(5,l.IRenderService)],b)},9806:(j,a)=>{function u(_,p,l){const v=l.getBoundingClientRect(),m=_.getComputedStyle(l),b=parseInt(m.getPropertyValue("padding-left")),d=parseInt(m.getPropertyValue("padding-top"));return[p.clientX-v.left-b,p.clientY-v.top-d]}Object.defineProperty(a,"__esModule",{value:!0}),a.getCoords=a.getCoordsRelativeToElement=void 0,a.getCoordsRelativeToElement=u,a.getCoords=function(_,p,l,v,m,b,d,s,o){if(!b)return;const r=u(_,p,l);return r?(r[0]=Math.ceil((r[0]+(o?d/2:0))/d),r[1]=Math.ceil(r[1]/s),r[0]=Math.min(Math.max(r[0],1),v+(o?1:0)),r[1]=Math.min(Math.max(r[1],1),m),r):void 0}},9504:(j,a,u)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.moveToCellSequence=void 0;const _=u(2584);function p(s,o,r,n){const c=s-l(s,r),g=o-l(o,r),S=Math.abs(c-g)-function(C,f,y){let T=0;const O=C-l(C,y),P=f-l(f,y);for(let D=0;D<Math.abs(O-P);D++){const N=v(C,f)==="A"?-1:1,X=y.buffer.lines.get(O+N*D);X!=null&&X.isWrapped&&T++}return T}(s,o,r);return d(S,b(v(s,o),n))}function l(s,o){let r=0,n=o.buffer.lines.get(s),c=n==null?void 0:n.isWrapped;for(;c&&s>=0&&s<o.rows;)r++,n=o.buffer.lines.get(--s),c=n==null?void 0:n.isWrapped;return r}function v(s,o){return s>o?"A":"B"}function m(s,o,r,n,c,g){let S=s,C=o,f="";for(;S!==r||C!==n;)S+=c?1:-1,c&&S>g.cols-1?(f+=g.buffer.translateBufferLineToString(C,!1,s,S),S=0,s=0,C++):!c&&S<0&&(f+=g.buffer.translateBufferLineToString(C,!1,0,s+1),S=g.cols-1,s=S,C--);return f+g.buffer.translateBufferLineToString(C,!1,s,S)}function b(s,o){const r=o?"O":"[";return _.C0.ESC+r+s}function d(s,o){s=Math.floor(s);let r="";for(let n=0;n<s;n++)r+=o;return r}a.moveToCellSequence=function(s,o,r,n){const c=r.buffer.x,g=r.buffer.y;if(!r.buffer.hasScrollback)return function(f,y,T,O,P,D){return p(y,O,P,D).length===0?"":d(m(f,y,f,y-l(y,P),!1,P).length,b("D",D))}(c,g,0,o,r,n)+p(g,o,r,n)+function(f,y,T,O,P,D){let N;N=p(y,O,P,D).length>0?O-l(O,P):y;const X=O,Z=function(se,ee,E,A,M,H){let Q;return Q=p(E,A,M,H).length>0?A-l(A,M):ee,se<E&&Q<=A||se>=E&&Q<A?"C":"D"}(f,y,T,O,P,D);return d(m(f,N,T,X,Z==="C",P).length,b(Z,D))}(c,g,s,o,r,n);let S;if(g===o)return S=c>s?"D":"C",d(Math.abs(c-s),b(S,n));S=g>o?"D":"C";const C=Math.abs(g-o);return d(function(f,y){return y.cols-f}(g>o?s:c,r)+(C-1)*r.cols+1+((g>o?c:s)-1),b(S,n))}},1296:function(j,a,u){var _=this&&this.__decorate||function(D,N,X,Z){var se,ee=arguments.length,E=ee<3?N:Z===null?Z=Object.getOwnPropertyDescriptor(N,X):Z;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(D,N,X,Z);else for(var A=D.length-1;A>=0;A--)(se=D[A])&&(E=(ee<3?se(E):ee>3?se(N,X,E):se(N,X))||E);return ee>3&&E&&Object.defineProperty(N,X,E),E},p=this&&this.__param||function(D,N){return function(X,Z){N(X,Z,D)}};Object.defineProperty(a,"__esModule",{value:!0}),a.DomRenderer=void 0;const l=u(3787),v=u(2550),m=u(2223),b=u(6171),d=u(6052),s=u(4725),o=u(8055),r=u(8460),n=u(844),c=u(2585),g="xterm-dom-renderer-owner-",S="xterm-rows",C="xterm-fg-",f="xterm-bg-",y="xterm-focus",T="xterm-selection";let O=1,P=a.DomRenderer=class extends n.Disposable{constructor(D,N,X,Z,se,ee,E,A,M,H,Q,re,le){super(),this._terminal=D,this._document=N,this._element=X,this._screenElement=Z,this._viewportElement=se,this._helperContainer=ee,this._linkifier2=E,this._charSizeService=M,this._optionsService=H,this._bufferService=Q,this._coreBrowserService=re,this._themeService=le,this._terminalClass=O++,this._rowElements=[],this._selectionRenderModel=(0,d.createSelectionRenderModel)(),this.onRequestRedraw=this.register(new r.EventEmitter).event,this._rowContainer=this._document.createElement("div"),this._rowContainer.classList.add(S),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=this._document.createElement("div"),this._selectionContainer.classList.add(T),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,b.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._themeService.onChangeColors(fe=>this._injectCss(fe))),this._injectCss(this._themeService.colors),this._rowFactory=A.createInstance(l.DomRendererRowFactory,document),this._element.classList.add(g+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline(fe=>this._handleLinkHover(fe))),this.register(this._linkifier2.onHideLinkUnderline(fe=>this._handleLinkLeave(fe))),this.register((0,n.toDisposable)(()=>{this._element.classList.remove(g+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._widthCache.dispose(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()})),this._widthCache=new v.WidthCache(this._document,this._helperContainer),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}_updateDimensions(){const D=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*D,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*D),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/D),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/D),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(const X of this._rowElements)X.style.width=`${this.dimensions.css.canvas.width}px`,X.style.height=`${this.dimensions.css.cell.height}px`,X.style.lineHeight=`${this.dimensions.css.cell.height}px`,X.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));const N=`${this._terminalSelector} .${S} span { display: inline-block; height: 100%; vertical-align: top;}`;this._dimensionsStyleElement.textContent=N,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(D){this._themeStyleElement||(this._themeStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let N=`${this._terminalSelector} .${S} { color: ${D.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px; font-kerning: none; white-space: pre}`;N+=`${this._terminalSelector} .${S} .xterm-dim { color: ${o.color.multiplyOpacity(D.foreground,.5).css};}`,N+=`${this._terminalSelector} span:not(.xterm-bold) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.xterm-bold { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.xterm-italic { font-style: italic;}`;const X=`blink_underline_${this._terminalClass}`,Z=`blink_bar_${this._terminalClass}`,se=`blink_block_${this._terminalClass}`;N+=`@keyframes ${X} { 50% {  border-bottom-style: hidden; }}`,N+=`@keyframes ${Z} { 50% {  box-shadow: none; }}`,N+=`@keyframes ${se} { 0% {  background-color: ${D.cursor.css};  color: ${D.cursorAccent.css}; } 50% {  background-color: inherit;  color: ${D.cursor.css}; }}`,N+=`${this._terminalSelector} .${S}.${y} .xterm-cursor.xterm-cursor-blink.xterm-cursor-underline { animation: ${X} 1s step-end infinite;}${this._terminalSelector} .${S}.${y} .xterm-cursor.xterm-cursor-blink.xterm-cursor-bar { animation: ${Z} 1s step-end infinite;}${this._terminalSelector} .${S}.${y} .xterm-cursor.xterm-cursor-blink.xterm-cursor-block { animation: ${se} 1s step-end infinite;}${this._terminalSelector} .${S} .xterm-cursor.xterm-cursor-block { background-color: ${D.cursor.css}; color: ${D.cursorAccent.css};}${this._terminalSelector} .${S} .xterm-cursor.xterm-cursor-block:not(.xterm-cursor-blink) { background-color: ${D.cursor.css} !important; color: ${D.cursorAccent.css} !important;}${this._terminalSelector} .${S} .xterm-cursor.xterm-cursor-outline { outline: 1px solid ${D.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .${S} .xterm-cursor.xterm-cursor-bar { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${D.cursor.css} inset;}${this._terminalSelector} .${S} .xterm-cursor.xterm-cursor-underline { border-bottom: 1px ${D.cursor.css}; border-bottom-style: solid; height: calc(100% - 1px);}`,N+=`${this._terminalSelector} .${T} { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .${T} div { position: absolute; background-color: ${D.selectionBackgroundOpaque.css};}${this._terminalSelector} .${T} div { position: absolute; background-color: ${D.selectionInactiveBackgroundOpaque.css};}`;for(const[ee,E]of D.ansi.entries())N+=`${this._terminalSelector} .${C}${ee} { color: ${E.css}; }${this._terminalSelector} .${C}${ee}.xterm-dim { color: ${o.color.multiplyOpacity(E,.5).css}; }${this._terminalSelector} .${f}${ee} { background-color: ${E.css}; }`;N+=`${this._terminalSelector} .${C}${m.INVERTED_DEFAULT_COLOR} { color: ${o.color.opaque(D.background).css}; }${this._terminalSelector} .${C}${m.INVERTED_DEFAULT_COLOR}.xterm-dim { color: ${o.color.multiplyOpacity(o.color.opaque(D.background),.5).css}; }${this._terminalSelector} .${f}${m.INVERTED_DEFAULT_COLOR} { background-color: ${D.foreground.css}; }`,this._themeStyleElement.textContent=N}_setDefaultSpacing(){const D=this.dimensions.css.cell.width-this._widthCache.get("W",!1,!1);this._rowContainer.style.letterSpacing=`${D}px`,this._rowFactory.defaultSpacing=D}handleDevicePixelRatioChange(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}_refreshRowElements(D,N){for(let X=this._rowElements.length;X<=N;X++){const Z=this._document.createElement("div");this._rowContainer.appendChild(Z),this._rowElements.push(Z)}for(;this._rowElements.length>N;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(D,N){this._refreshRowElements(D,N),this._updateDimensions(),this.handleSelectionChanged(this._selectionRenderModel.selectionStart,this._selectionRenderModel.selectionEnd,this._selectionRenderModel.columnSelectMode)}handleCharSizeChanged(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}handleBlur(){this._rowContainer.classList.remove(y),this.renderRows(0,this._bufferService.rows-1)}handleFocus(){this._rowContainer.classList.add(y),this.renderRows(this._bufferService.buffer.y,this._bufferService.buffer.y)}handleSelectionChanged(D,N,X){if(this._selectionContainer.replaceChildren(),this._rowFactory.handleSelectionChanged(D,N,X),this.renderRows(0,this._bufferService.rows-1),!D||!N)return;this._selectionRenderModel.update(this._terminal,D,N,X);const Z=this._selectionRenderModel.viewportStartRow,se=this._selectionRenderModel.viewportEndRow,ee=this._selectionRenderModel.viewportCappedStartRow,E=this._selectionRenderModel.viewportCappedEndRow;if(ee>=this._bufferService.rows||E<0)return;const A=this._document.createDocumentFragment();if(X){const M=D[0]>N[0];A.appendChild(this._createSelectionElement(ee,M?N[0]:D[0],M?D[0]:N[0],E-ee+1))}else{const M=Z===ee?D[0]:0,H=ee===se?N[0]:this._bufferService.cols;A.appendChild(this._createSelectionElement(ee,M,H));const Q=E-ee-1;if(A.appendChild(this._createSelectionElement(ee+1,0,this._bufferService.cols,Q)),ee!==E){const re=se===E?N[0]:this._bufferService.cols;A.appendChild(this._createSelectionElement(E,0,re))}}this._selectionContainer.appendChild(A)}_createSelectionElement(D,N,X,Z=1){const se=this._document.createElement("div"),ee=N*this.dimensions.css.cell.width;let E=this.dimensions.css.cell.width*(X-N);return ee+E>this.dimensions.css.canvas.width&&(E=this.dimensions.css.canvas.width-ee),se.style.height=Z*this.dimensions.css.cell.height+"px",se.style.top=D*this.dimensions.css.cell.height+"px",se.style.left=`${ee}px`,se.style.width=`${E}px`,se}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}clear(){for(const D of this._rowElements)D.replaceChildren()}renderRows(D,N){const X=this._bufferService.buffer,Z=X.ybase+X.y,se=Math.min(X.x,this._bufferService.cols-1),ee=this._optionsService.rawOptions.cursorBlink,E=this._optionsService.rawOptions.cursorStyle,A=this._optionsService.rawOptions.cursorInactiveStyle;for(let M=D;M<=N;M++){const H=M+X.ydisp,Q=this._rowElements[M],re=X.lines.get(H);if(!Q||!re)break;Q.replaceChildren(...this._rowFactory.createRow(re,H,H===Z,E,A,se,ee,this.dimensions.css.cell.width,this._widthCache,-1,-1))}}get _terminalSelector(){return`.${g}${this._terminalClass}`}_handleLinkHover(D){this._setCellUnderline(D.x1,D.x2,D.y1,D.y2,D.cols,!0)}_handleLinkLeave(D){this._setCellUnderline(D.x1,D.x2,D.y1,D.y2,D.cols,!1)}_setCellUnderline(D,N,X,Z,se,ee){X<0&&(D=0),Z<0&&(N=0);const E=this._bufferService.rows-1;X=Math.max(Math.min(X,E),0),Z=Math.max(Math.min(Z,E),0),se=Math.min(se,this._bufferService.cols);const A=this._bufferService.buffer,M=A.ybase+A.y,H=Math.min(A.x,se-1),Q=this._optionsService.rawOptions.cursorBlink,re=this._optionsService.rawOptions.cursorStyle,le=this._optionsService.rawOptions.cursorInactiveStyle;for(let fe=X;fe<=Z;++fe){const U=fe+A.ydisp,R=this._rowElements[fe],J=A.lines.get(U);if(!R||!J)break;R.replaceChildren(...this._rowFactory.createRow(J,U,U===M,re,le,H,Q,this.dimensions.css.cell.width,this._widthCache,ee?fe===X?D:0:-1,ee?(fe===Z?N:se)-1:-1))}}};a.DomRenderer=P=_([p(7,c.IInstantiationService),p(8,s.ICharSizeService),p(9,c.IOptionsService),p(10,c.IBufferService),p(11,s.ICoreBrowserService),p(12,s.IThemeService)],P)},3787:function(j,a,u){var _=this&&this.__decorate||function(S,C,f,y){var T,O=arguments.length,P=O<3?C:y===null?y=Object.getOwnPropertyDescriptor(C,f):y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")P=Reflect.decorate(S,C,f,y);else for(var D=S.length-1;D>=0;D--)(T=S[D])&&(P=(O<3?T(P):O>3?T(C,f,P):T(C,f))||P);return O>3&&P&&Object.defineProperty(C,f,P),P},p=this&&this.__param||function(S,C){return function(f,y){C(f,y,S)}};Object.defineProperty(a,"__esModule",{value:!0}),a.DomRendererRowFactory=void 0;const l=u(2223),v=u(643),m=u(511),b=u(2585),d=u(8055),s=u(4725),o=u(4269),r=u(6171),n=u(3734);let c=a.DomRendererRowFactory=class{constructor(S,C,f,y,T,O,P){this._document=S,this._characterJoinerService=C,this._optionsService=f,this._coreBrowserService=y,this._coreService=T,this._decorationService=O,this._themeService=P,this._workCell=new m.CellData,this._columnSelectMode=!1,this.defaultSpacing=0}handleSelectionChanged(S,C,f){this._selectionStart=S,this._selectionEnd=C,this._columnSelectMode=f}createRow(S,C,f,y,T,O,P,D,N,X,Z){const se=[],ee=this._characterJoinerService.getJoinedCharacters(C),E=this._themeService.colors;let A,M=S.getNoBgTrimmedLength();f&&M<O+1&&(M=O+1);let H=0,Q="",re=0,le=0,fe=0,U=!1,R=0,J=!1,z=0;const ne=[],ie=X!==-1&&Z!==-1;for(let Ee=0;Ee<M;Ee++){S.loadCell(Ee,this._workCell);let Le=this._workCell.getWidth();if(Le===0)continue;let Me=!1,Je=Ee,ue=this._workCell;if(ee.length>0&&Ee===ee[0][0]){Me=!0;const Ie=ee.shift();ue=new o.JoinedCellData(this._workCell,S.translateToString(!0,Ie[0],Ie[1]),Ie[1]-Ie[0]),Je=Ie[1]-1,Le=ue.getWidth()}const $t=this._isCellInSelection(Ee,C),_i=f&&Ee===O,Ot=ie&&Ee>=X&&Ee<=Z;let it=!1;this._decorationService.forEachDecorationAtCell(Ee,C,void 0,Ie=>{it=!0});let xt=ue.getChars()||v.WHITESPACE_CELL_CHAR;if(xt===" "&&(ue.isUnderline()||ue.isOverline())&&(xt="Â "),z=Le*D-N.get(xt,ue.isBold(),ue.isItalic()),A){if(H&&($t&&J||!$t&&!J&&ue.bg===re)&&($t&&J&&E.selectionForeground||ue.fg===le)&&ue.extended.ext===fe&&Ot===U&&z===R&&!_i&&!Me&&!it){ue.isInvisible()?Q+=v.WHITESPACE_CELL_CHAR:Q+=xt,H++;continue}H&&(A.textContent=Q),A=this._document.createElement("span"),H=0,Q=""}else A=this._document.createElement("span");if(re=ue.bg,le=ue.fg,fe=ue.extended.ext,U=Ot,R=z,J=$t,Me&&O>=Ee&&O<=Je&&(O=Ee),!this._coreService.isCursorHidden&&_i&&this._coreService.isCursorInitialized){if(ne.push("xterm-cursor"),this._coreBrowserService.isFocused)P&&ne.push("xterm-cursor-blink"),ne.push(y==="bar"?"xterm-cursor-bar":y==="underline"?"xterm-cursor-underline":"xterm-cursor-block");else if(T)switch(T){case"outline":ne.push("xterm-cursor-outline");break;case"block":ne.push("xterm-cursor-block");break;case"bar":ne.push("xterm-cursor-bar");break;case"underline":ne.push("xterm-cursor-underline")}}if(ue.isBold()&&ne.push("xterm-bold"),ue.isItalic()&&ne.push("xterm-italic"),ue.isDim()&&ne.push("xterm-dim"),Q=ue.isInvisible()?v.WHITESPACE_CELL_CHAR:ue.getChars()||v.WHITESPACE_CELL_CHAR,ue.isUnderline()&&(ne.push(`xterm-underline-${ue.extended.underlineStyle}`),Q===" "&&(Q="Â "),!ue.isUnderlineColorDefault()))if(ue.isUnderlineColorRGB())A.style.textDecorationColor=`rgb(${n.AttributeData.toColorRGB(ue.getUnderlineColor()).join(",")})`;else{let Ie=ue.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&ue.isBold()&&Ie<8&&(Ie+=8),A.style.textDecorationColor=E.ansi[Ie].css}ue.isOverline()&&(ne.push("xterm-overline"),Q===" "&&(Q="Â ")),ue.isStrikethrough()&&ne.push("xterm-strikethrough"),Ot&&(A.style.textDecoration="underline");let q=ue.getFgColor(),te=ue.getFgColorMode(),he=ue.getBgColor(),ze=ue.getBgColorMode();const Ke=!!ue.isInverse();if(Ke){const Ie=q;q=he,he=Ie;const Gt=te;te=ze,ze=Gt}let et,zt,rt,It=!1;switch(this._decorationService.forEachDecorationAtCell(Ee,C,void 0,Ie=>{Ie.options.layer!=="top"&&It||(Ie.backgroundColorRGB&&(ze=50331648,he=Ie.backgroundColorRGB.rgba>>8&16777215,et=Ie.backgroundColorRGB),Ie.foregroundColorRGB&&(te=50331648,q=Ie.foregroundColorRGB.rgba>>8&16777215,zt=Ie.foregroundColorRGB),It=Ie.options.layer==="top")}),!It&&$t&&(et=this._coreBrowserService.isFocused?E.selectionBackgroundOpaque:E.selectionInactiveBackgroundOpaque,he=et.rgba>>8&16777215,ze=50331648,It=!0,E.selectionForeground&&(te=50331648,q=E.selectionForeground.rgba>>8&16777215,zt=E.selectionForeground)),It&&ne.push("xterm-decoration-top"),ze){case 16777216:case 33554432:rt=E.ansi[he],ne.push(`xterm-bg-${he}`);break;case 50331648:rt=d.channels.toColor(he>>16,he>>8&255,255&he),this._addStyle(A,`background-color:#${g((he>>>0).toString(16),"0",6)}`);break;default:Ke?(rt=E.foreground,ne.push(`xterm-bg-${l.INVERTED_DEFAULT_COLOR}`)):rt=E.background}switch(et||ue.isDim()&&(et=d.color.multiplyOpacity(rt,.5)),te){case 16777216:case 33554432:ue.isBold()&&q<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(q+=8),this._applyMinimumContrast(A,rt,E.ansi[q],ue,et,void 0)||ne.push(`xterm-fg-${q}`);break;case 50331648:const Ie=d.channels.toColor(q>>16&255,q>>8&255,255&q);this._applyMinimumContrast(A,rt,Ie,ue,et,zt)||this._addStyle(A,`color:#${g(q.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(A,rt,E.foreground,ue,et,zt)||Ke&&ne.push(`xterm-fg-${l.INVERTED_DEFAULT_COLOR}`)}ne.length&&(A.className=ne.join(" "),ne.length=0),_i||Me||it?A.textContent=Q:H++,z!==this.defaultSpacing&&(A.style.letterSpacing=`${z}px`),se.push(A),Ee=Je}return A&&H&&(A.textContent=Q),se}_applyMinimumContrast(S,C,f,y,T,O){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,r.treatGlyphAsBackgroundColor)(y.getCode()))return!1;const P=this._getContrastCache(y);let D;if(T||O||(D=P.getColor(C.rgba,f.rgba)),D===void 0){const N=this._optionsService.rawOptions.minimumContrastRatio/(y.isDim()?2:1);D=d.color.ensureContrastRatio(T||C,O||f,N),P.setColor((T||C).rgba,(O||f).rgba,D??null)}return!!D&&(this._addStyle(S,`color:${D.css}`),!0)}_getContrastCache(S){return S.isDim()?this._themeService.colors.halfContrastCache:this._themeService.colors.contrastCache}_addStyle(S,C){S.setAttribute("style",`${S.getAttribute("style")||""}${C};`)}_isCellInSelection(S,C){const f=this._selectionStart,y=this._selectionEnd;return!(!f||!y)&&(this._columnSelectMode?f[0]<=y[0]?S>=f[0]&&C>=f[1]&&S<y[0]&&C<=y[1]:S<f[0]&&C>=f[1]&&S>=y[0]&&C<=y[1]:C>f[1]&&C<y[1]||f[1]===y[1]&&C===f[1]&&S>=f[0]&&S<y[0]||f[1]<y[1]&&C===y[1]&&S<y[0]||f[1]<y[1]&&C===f[1]&&S>=f[0])}};function g(S,C,f){for(;S.length<f;)S=C+S;return S}a.DomRendererRowFactory=c=_([p(1,s.ICharacterJoinerService),p(2,b.IOptionsService),p(3,s.ICoreBrowserService),p(4,b.ICoreService),p(5,b.IDecorationService),p(6,s.IThemeService)],c)},2550:(j,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.WidthCache=void 0,a.WidthCache=class{constructor(u,_){this._flat=new Float32Array(256),this._font="",this._fontSize=0,this._weight="normal",this._weightBold="bold",this._measureElements=[],this._container=u.createElement("div"),this._container.classList.add("xterm-width-cache-measure-container"),this._container.setAttribute("aria-hidden","true"),this._container.style.whiteSpace="pre",this._container.style.fontKerning="none";const p=u.createElement("span");p.classList.add("xterm-char-measure-element");const l=u.createElement("span");l.classList.add("xterm-char-measure-element"),l.style.fontWeight="bold";const v=u.createElement("span");v.classList.add("xterm-char-measure-element"),v.style.fontStyle="italic";const m=u.createElement("span");m.classList.add("xterm-char-measure-element"),m.style.fontWeight="bold",m.style.fontStyle="italic",this._measureElements=[p,l,v,m],this._container.appendChild(p),this._container.appendChild(l),this._container.appendChild(v),this._container.appendChild(m),_.appendChild(this._container),this.clear()}dispose(){this._container.remove(),this._measureElements.length=0,this._holey=void 0}clear(){this._flat.fill(-9999),this._holey=new Map}setFont(u,_,p,l){u===this._font&&_===this._fontSize&&p===this._weight&&l===this._weightBold||(this._font=u,this._fontSize=_,this._weight=p,this._weightBold=l,this._container.style.fontFamily=this._font,this._container.style.fontSize=`${this._fontSize}px`,this._measureElements[0].style.fontWeight=`${p}`,this._measureElements[1].style.fontWeight=`${l}`,this._measureElements[2].style.fontWeight=`${p}`,this._measureElements[3].style.fontWeight=`${l}`,this.clear())}get(u,_,p){let l=0;if(!_&&!p&&u.length===1&&(l=u.charCodeAt(0))<256){if(this._flat[l]!==-9999)return this._flat[l];const b=this._measure(u,0);return b>0&&(this._flat[l]=b),b}let v=u;_&&(v+="B"),p&&(v+="I");let m=this._holey.get(v);if(m===void 0){let b=0;_&&(b|=1),p&&(b|=2),m=this._measure(u,b),m>0&&this._holey.set(v,m)}return m}_measure(u,_){const p=this._measureElements[_];return p.textContent=u.repeat(32),p.offsetWidth/32}}},2223:(j,a,u)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.TEXT_BASELINE=a.DIM_OPACITY=a.INVERTED_DEFAULT_COLOR=void 0;const _=u(6114);a.INVERTED_DEFAULT_COLOR=257,a.DIM_OPACITY=.5,a.TEXT_BASELINE=_.isFirefox||_.isLegacyEdge?"bottom":"ideographic"},6171:(j,a)=>{function u(p){return 57508<=p&&p<=57558}function _(p){return p>=128512&&p<=128591||p>=127744&&p<=128511||p>=128640&&p<=128767||p>=9728&&p<=9983||p>=9984&&p<=10175||p>=65024&&p<=65039||p>=129280&&p<=129535||p>=127462&&p<=127487}Object.defineProperty(a,"__esModule",{value:!0}),a.computeNextVariantOffset=a.createRenderDimensions=a.treatGlyphAsBackgroundColor=a.allowRescaling=a.isEmoji=a.isRestrictedPowerlineGlyph=a.isPowerlineGlyph=a.throwIfFalsy=void 0,a.throwIfFalsy=function(p){if(!p)throw new Error("value must not be falsy");return p},a.isPowerlineGlyph=u,a.isRestrictedPowerlineGlyph=function(p){return 57520<=p&&p<=57527},a.isEmoji=_,a.allowRescaling=function(p,l,v,m){return l===1&&v>Math.ceil(1.5*m)&&p!==void 0&&p>255&&!_(p)&&!u(p)&&!function(b){return 57344<=b&&b<=63743}(p)},a.treatGlyphAsBackgroundColor=function(p){return u(p)||function(l){return 9472<=l&&l<=9631}(p)},a.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}},a.computeNextVariantOffset=function(p,l,v=0){return(p-(2*Math.round(l)-v))%(2*Math.round(l))}},6052:(j,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.createSelectionRenderModel=void 0;class u{constructor(){this.clear()}clear(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}update(p,l,v,m=!1){if(this.selectionStart=l,this.selectionEnd=v,!l||!v||l[0]===v[0]&&l[1]===v[1])return void this.clear();const b=p.buffers.active.ydisp,d=l[1]-b,s=v[1]-b,o=Math.max(d,0),r=Math.min(s,p.rows-1);o>=p.rows||r<0?this.clear():(this.hasSelection=!0,this.columnSelectMode=m,this.viewportStartRow=d,this.viewportEndRow=s,this.viewportCappedStartRow=o,this.viewportCappedEndRow=r,this.startCol=l[0],this.endCol=v[0])}isCellSelected(p,l,v){return!!this.hasSelection&&(v-=p.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?l>=this.startCol&&v>=this.viewportCappedStartRow&&l<this.endCol&&v<=this.viewportCappedEndRow:l<this.startCol&&v>=this.viewportCappedStartRow&&l>=this.endCol&&v<=this.viewportCappedEndRow:v>this.viewportStartRow&&v<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&v===this.viewportStartRow&&l>=this.startCol&&l<this.endCol||this.viewportStartRow<this.viewportEndRow&&v===this.viewportEndRow&&l<this.endCol||this.viewportStartRow<this.viewportEndRow&&v===this.viewportStartRow&&l>=this.startCol)}}a.createSelectionRenderModel=function(){return new u}},456:(j,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.SelectionModel=void 0,a.SelectionModel=class{constructor(u){this._bufferService=u,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){const u=this.selectionStart[0]+this.selectionStartLength;return u>this._bufferService.cols?u%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(u/this._bufferService.cols)-1]:[u%this._bufferService.cols,this.selectionStart[1]+Math.floor(u/this._bufferService.cols)]:[u,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){const u=this.selectionStart[0]+this.selectionStartLength;return u>this._bufferService.cols?[u%this._bufferService.cols,this.selectionStart[1]+Math.floor(u/this._bufferService.cols)]:[Math.max(u,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){const u=this.selectionStart,_=this.selectionEnd;return!(!u||!_)&&(u[1]>_[1]||u[1]===_[1]&&u[0]>_[0])}handleTrim(u){return this.selectionStart&&(this.selectionStart[1]-=u),this.selectionEnd&&(this.selectionEnd[1]-=u),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(j,a,u){var _=this&&this.__decorate||function(r,n,c,g){var S,C=arguments.length,f=C<3?n:g===null?g=Object.getOwnPropertyDescriptor(n,c):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(r,n,c,g);else for(var y=r.length-1;y>=0;y--)(S=r[y])&&(f=(C<3?S(f):C>3?S(n,c,f):S(n,c))||f);return C>3&&f&&Object.defineProperty(n,c,f),f},p=this&&this.__param||function(r,n){return function(c,g){n(c,g,r)}};Object.defineProperty(a,"__esModule",{value:!0}),a.CharSizeService=void 0;const l=u(2585),v=u(8460),m=u(844);let b=a.CharSizeService=class extends m.Disposable{get hasValidSize(){return this.width>0&&this.height>0}constructor(r,n,c){super(),this._optionsService=c,this.width=0,this.height=0,this._onCharSizeChange=this.register(new v.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event;try{this._measureStrategy=this.register(new o(this._optionsService))}catch{this._measureStrategy=this.register(new s(r,n,this._optionsService))}this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}measure(){const r=this._measureStrategy.measure();r.width===this.width&&r.height===this.height||(this.width=r.width,this.height=r.height,this._onCharSizeChange.fire())}};a.CharSizeService=b=_([p(2,l.IOptionsService)],b);class d extends m.Disposable{constructor(){super(...arguments),this._result={width:0,height:0}}_validateAndSet(n,c){n!==void 0&&n>0&&c!==void 0&&c>0&&(this._result.width=n,this._result.height=c)}}class s extends d{constructor(n,c,g){super(),this._document=n,this._parentElement=c,this._optionsService=g,this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W".repeat(32),this._measureElement.setAttribute("aria-hidden","true"),this._measureElement.style.whiteSpace="pre",this._measureElement.style.fontKerning="none",this._parentElement.appendChild(this._measureElement)}measure(){return this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`,this._validateAndSet(Number(this._measureElement.offsetWidth)/32,Number(this._measureElement.offsetHeight)),this._result}}class o extends d{constructor(n){super(),this._optionsService=n,this._canvas=new OffscreenCanvas(100,100),this._ctx=this._canvas.getContext("2d");const c=this._ctx.measureText("W");if(!("width"in c&&"fontBoundingBoxAscent"in c&&"fontBoundingBoxDescent"in c))throw new Error("Required font metrics not supported")}measure(){this._ctx.font=`${this._optionsService.rawOptions.fontSize}px ${this._optionsService.rawOptions.fontFamily}`;const n=this._ctx.measureText("W");return this._validateAndSet(n.width,n.fontBoundingBoxAscent+n.fontBoundingBoxDescent),this._result}}},4269:function(j,a,u){var _=this&&this.__decorate||function(o,r,n,c){var g,S=arguments.length,C=S<3?r:c===null?c=Object.getOwnPropertyDescriptor(r,n):c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(o,r,n,c);else for(var f=o.length-1;f>=0;f--)(g=o[f])&&(C=(S<3?g(C):S>3?g(r,n,C):g(r,n))||C);return S>3&&C&&Object.defineProperty(r,n,C),C},p=this&&this.__param||function(o,r){return function(n,c){r(n,c,o)}};Object.defineProperty(a,"__esModule",{value:!0}),a.CharacterJoinerService=a.JoinedCellData=void 0;const l=u(3734),v=u(643),m=u(511),b=u(2585);class d extends l.AttributeData{constructor(r,n,c){super(),this.content=0,this.combinedData="",this.fg=r.fg,this.bg=r.bg,this.combinedData=n,this._width=c}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(r){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}a.JoinedCellData=d;let s=a.CharacterJoinerService=class th{constructor(r){this._bufferService=r,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new m.CellData}register(r){const n={id:this._nextCharacterJoinerId++,handler:r};return this._characterJoiners.push(n),n.id}deregister(r){for(let n=0;n<this._characterJoiners.length;n++)if(this._characterJoiners[n].id===r)return this._characterJoiners.splice(n,1),!0;return!1}getJoinedCharacters(r){if(this._characterJoiners.length===0)return[];const n=this._bufferService.buffer.lines.get(r);if(!n||n.length===0)return[];const c=[],g=n.translateToString(!0);let S=0,C=0,f=0,y=n.getFg(0),T=n.getBg(0);for(let O=0;O<n.getTrimmedLength();O++)if(n.loadCell(O,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==y||this._workCell.bg!==T){if(O-S>1){const P=this._getJoinedRanges(g,f,C,n,S);for(let D=0;D<P.length;D++)c.push(P[D])}S=O,f=C,y=this._workCell.fg,T=this._workCell.bg}C+=this._workCell.getChars().length||v.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-S>1){const O=this._getJoinedRanges(g,f,C,n,S);for(let P=0;P<O.length;P++)c.push(O[P])}return c}_getJoinedRanges(r,n,c,g,S){const C=r.substring(n,c);let f=[];try{f=this._characterJoiners[0].handler(C)}catch(y){console.error(y)}for(let y=1;y<this._characterJoiners.length;y++)try{const T=this._characterJoiners[y].handler(C);for(let O=0;O<T.length;O++)th._mergeRanges(f,T[O])}catch(T){console.error(T)}return this._stringRangesToCellRanges(f,g,S),f}_stringRangesToCellRanges(r,n,c){let g=0,S=!1,C=0,f=r[g];if(f){for(let y=c;y<this._bufferService.cols;y++){const T=n.getWidth(y),O=n.getString(y).length||v.WHITESPACE_CELL_CHAR.length;if(T!==0){if(!S&&f[0]<=C&&(f[0]=y,S=!0),f[1]<=C){if(f[1]=y,f=r[++g],!f)break;f[0]<=C?(f[0]=y,S=!0):S=!1}C+=O}}f&&(f[1]=this._bufferService.cols)}}static _mergeRanges(r,n){let c=!1;for(let g=0;g<r.length;g++){const S=r[g];if(c){if(n[1]<=S[0])return r[g-1][1]=n[1],r;if(n[1]<=S[1])return r[g-1][1]=Math.max(n[1],S[1]),r.splice(g,1),r;r.splice(g,1),g--}else{if(n[1]<=S[0])return r.splice(g,0,n),r;if(n[1]<=S[1])return S[0]=Math.min(n[0],S[0]),r;n[0]<S[1]&&(S[0]=Math.min(n[0],S[0]),c=!0)}}return c?r[r.length-1][1]=n[1]:r.push(n),r}};a.CharacterJoinerService=s=_([p(0,b.IBufferService)],s)},5114:(j,a,u)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.CoreBrowserService=void 0;const _=u(844),p=u(8460),l=u(3656);class v extends _.Disposable{constructor(d,s,o){super(),this._textarea=d,this._window=s,this.mainDocument=o,this._isFocused=!1,this._cachedIsFocused=void 0,this._screenDprMonitor=new m(this._window),this._onDprChange=this.register(new p.EventEmitter),this.onDprChange=this._onDprChange.event,this._onWindowChange=this.register(new p.EventEmitter),this.onWindowChange=this._onWindowChange.event,this.register(this.onWindowChange(r=>this._screenDprMonitor.setWindow(r))),this.register((0,p.forwardEvent)(this._screenDprMonitor.onDprChange,this._onDprChange)),this._textarea.addEventListener("focus",()=>this._isFocused=!0),this._textarea.addEventListener("blur",()=>this._isFocused=!1)}get window(){return this._window}set window(d){this._window!==d&&(this._window=d,this._onWindowChange.fire(this._window))}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}}a.CoreBrowserService=v;class m extends _.Disposable{constructor(d){super(),this._parentWindow=d,this._windowResizeListener=this.register(new _.MutableDisposable),this._onDprChange=this.register(new p.EventEmitter),this.onDprChange=this._onDprChange.event,this._outerListener=()=>this._setDprAndFireIfDiffers(),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._updateDpr(),this._setWindowResizeListener(),this.register((0,_.toDisposable)(()=>this.clearListener()))}setWindow(d){this._parentWindow=d,this._setWindowResizeListener(),this._setDprAndFireIfDiffers()}_setWindowResizeListener(){this._windowResizeListener.value=(0,l.addDisposableDomListener)(this._parentWindow,"resize",()=>this._setDprAndFireIfDiffers())}_setDprAndFireIfDiffers(){this._parentWindow.devicePixelRatio!==this._currentDevicePixelRatio&&this._onDprChange.fire(this._parentWindow.devicePixelRatio),this._updateDpr()}_updateDpr(){var d;this._outerListener&&((d=this._resolutionMediaMatchList)==null||d.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._outerListener=void 0)}}},779:(j,a,u)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.LinkProviderService=void 0;const _=u(844);class p extends _.Disposable{constructor(){super(),this.linkProviders=[],this.register((0,_.toDisposable)(()=>this.linkProviders.length=0))}registerLinkProvider(v){return this.linkProviders.push(v),{dispose:()=>{const m=this.linkProviders.indexOf(v);m!==-1&&this.linkProviders.splice(m,1)}}}}a.LinkProviderService=p},8934:function(j,a,u){var _=this&&this.__decorate||function(b,d,s,o){var r,n=arguments.length,c=n<3?d:o===null?o=Object.getOwnPropertyDescriptor(d,s):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(b,d,s,o);else for(var g=b.length-1;g>=0;g--)(r=b[g])&&(c=(n<3?r(c):n>3?r(d,s,c):r(d,s))||c);return n>3&&c&&Object.defineProperty(d,s,c),c},p=this&&this.__param||function(b,d){return function(s,o){d(s,o,b)}};Object.defineProperty(a,"__esModule",{value:!0}),a.MouseService=void 0;const l=u(4725),v=u(9806);let m=a.MouseService=class{constructor(b,d){this._renderService=b,this._charSizeService=d}getCoords(b,d,s,o,r){return(0,v.getCoords)(window,b,d,s,o,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,r)}getMouseReportCoords(b,d){const s=(0,v.getCoordsRelativeToElement)(window,b,d);if(this._charSizeService.hasValidSize)return s[0]=Math.min(Math.max(s[0],0),this._renderService.dimensions.css.canvas.width-1),s[1]=Math.min(Math.max(s[1],0),this._renderService.dimensions.css.canvas.height-1),{col:Math.floor(s[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(s[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(s[0]),y:Math.floor(s[1])}}};a.MouseService=m=_([p(0,l.IRenderService),p(1,l.ICharSizeService)],m)},3230:function(j,a,u){var _=this&&this.__decorate||function(r,n,c,g){var S,C=arguments.length,f=C<3?n:g===null?g=Object.getOwnPropertyDescriptor(n,c):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(r,n,c,g);else for(var y=r.length-1;y>=0;y--)(S=r[y])&&(f=(C<3?S(f):C>3?S(n,c,f):S(n,c))||f);return C>3&&f&&Object.defineProperty(n,c,f),f},p=this&&this.__param||function(r,n){return function(c,g){n(c,g,r)}};Object.defineProperty(a,"__esModule",{value:!0}),a.RenderService=void 0;const l=u(6193),v=u(4725),m=u(8460),b=u(844),d=u(7226),s=u(2585);let o=a.RenderService=class extends b.Disposable{get dimensions(){return this._renderer.value.dimensions}constructor(r,n,c,g,S,C,f,y){super(),this._rowCount=r,this._charSizeService=g,this._renderer=this.register(new b.MutableDisposable),this._pausedResizeTask=new d.DebouncedIdleTask,this._observerDisposable=this.register(new b.MutableDisposable),this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new m.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new m.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new m.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new m.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this._renderDebouncer=new l.RenderDebouncer((T,O)=>this._renderRows(T,O),f),this.register(this._renderDebouncer),this.register(f.onDprChange(()=>this.handleDevicePixelRatioChange())),this.register(C.onResize(()=>this._fullRefresh())),this.register(C.buffers.onBufferActivate(()=>{var T;return(T=this._renderer.value)==null?void 0:T.clear()})),this.register(c.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this.register(S.onDecorationRegistered(()=>this._fullRefresh())),this.register(S.onDecorationRemoved(()=>this._fullRefresh())),this.register(c.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio","rescaleOverlappingGlyphs"],()=>{this.clear(),this.handleResize(C.cols,C.rows),this._fullRefresh()})),this.register(c.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(C.buffer.y,C.buffer.y,!0))),this.register(y.onChangeColors(()=>this._fullRefresh())),this._registerIntersectionObserver(f.window,n),this.register(f.onWindowChange(T=>this._registerIntersectionObserver(T,n)))}_registerIntersectionObserver(r,n){if("IntersectionObserver"in r){const c=new r.IntersectionObserver(g=>this._handleIntersectionChange(g[g.length-1]),{threshold:0});c.observe(n),this._observerDisposable.value=(0,b.toDisposable)(()=>c.disconnect())}}_handleIntersectionChange(r){this._isPaused=r.isIntersecting===void 0?r.intersectionRatio===0:!r.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(r,n,c=!1){this._isPaused?this._needsFullRefresh=!0:(c||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(r,n,this._rowCount))}_renderRows(r,n){this._renderer.value&&(r=Math.min(r,this._rowCount-1),n=Math.min(n,this._rowCount-1),this._renderer.value.renderRows(r,n),this._needsSelectionRefresh&&(this._renderer.value.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:r,end:n}),this._onRender.fire({start:r,end:n}),this._isNextRenderRedrawOnly=!0)}resize(r,n){this._rowCount=n,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer.value&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer.value&&(this._renderer.value.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.value.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.value.dimensions))}hasRenderer(){return!!this._renderer.value}setRenderer(r){this._renderer.value=r,this._renderer.value&&(this._renderer.value.onRequestRedraw(n=>this.refreshRows(n.start,n.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh())}addRefreshCallback(r){return this._renderDebouncer.addRefreshCallback(r)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){var r,n;this._renderer.value&&((n=(r=this._renderer.value).clearTextureAtlas)==null||n.call(r),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer.value&&(this._renderer.value.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(r,n){this._renderer.value&&(this._isPaused?this._pausedResizeTask.set(()=>{var c;return(c=this._renderer.value)==null?void 0:c.handleResize(r,n)}):this._renderer.value.handleResize(r,n),this._fullRefresh())}handleCharSizeChanged(){var r;(r=this._renderer.value)==null||r.handleCharSizeChanged()}handleBlur(){var r;(r=this._renderer.value)==null||r.handleBlur()}handleFocus(){var r;(r=this._renderer.value)==null||r.handleFocus()}handleSelectionChanged(r,n,c){var g;this._selectionState.start=r,this._selectionState.end=n,this._selectionState.columnSelectMode=c,(g=this._renderer.value)==null||g.handleSelectionChanged(r,n,c)}handleCursorMove(){var r;(r=this._renderer.value)==null||r.handleCursorMove()}clear(){var r;(r=this._renderer.value)==null||r.clear()}};a.RenderService=o=_([p(2,s.IOptionsService),p(3,v.ICharSizeService),p(4,s.IDecorationService),p(5,s.IBufferService),p(6,v.ICoreBrowserService),p(7,v.IThemeService)],o)},9312:function(j,a,u){var _=this&&this.__decorate||function(f,y,T,O){var P,D=arguments.length,N=D<3?y:O===null?O=Object.getOwnPropertyDescriptor(y,T):O;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")N=Reflect.decorate(f,y,T,O);else for(var X=f.length-1;X>=0;X--)(P=f[X])&&(N=(D<3?P(N):D>3?P(y,T,N):P(y,T))||N);return D>3&&N&&Object.defineProperty(y,T,N),N},p=this&&this.__param||function(f,y){return function(T,O){y(T,O,f)}};Object.defineProperty(a,"__esModule",{value:!0}),a.SelectionService=void 0;const l=u(9806),v=u(9504),m=u(456),b=u(4725),d=u(8460),s=u(844),o=u(6114),r=u(4841),n=u(511),c=u(2585),g=String.fromCharCode(160),S=new RegExp(g,"g");let C=a.SelectionService=class extends s.Disposable{constructor(f,y,T,O,P,D,N,X,Z){super(),this._element=f,this._screenElement=y,this._linkifier=T,this._bufferService=O,this._coreService=P,this._mouseService=D,this._optionsService=N,this._renderService=X,this._coreBrowserService=Z,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new n.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new d.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new d.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new d.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new d.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=se=>this._handleMouseMove(se),this._mouseUpListener=se=>this._handleMouseUp(se),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(se=>this._handleTrim(se)),this.register(this._bufferService.buffers.onBufferActivate(se=>this._handleBufferActivate(se))),this.enable(),this._model=new m.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,s.toDisposable)(()=>{this._removeMouseDownListeners()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){const f=this._model.finalSelectionStart,y=this._model.finalSelectionEnd;return!(!f||!y||f[0]===y[0]&&f[1]===y[1])}get selectionText(){const f=this._model.finalSelectionStart,y=this._model.finalSelectionEnd;if(!f||!y)return"";const T=this._bufferService.buffer,O=[];if(this._activeSelectionMode===3){if(f[0]===y[0])return"";const P=f[0]<y[0]?f[0]:y[0],D=f[0]<y[0]?y[0]:f[0];for(let N=f[1];N<=y[1];N++){const X=T.translateBufferLineToString(N,!0,P,D);O.push(X)}}else{const P=f[1]===y[1]?y[0]:void 0;O.push(T.translateBufferLineToString(f[1],!0,f[0],P));for(let D=f[1]+1;D<=y[1]-1;D++){const N=T.lines.get(D),X=T.translateBufferLineToString(D,!0);N!=null&&N.isWrapped?O[O.length-1]+=X:O.push(X)}if(f[1]!==y[1]){const D=T.lines.get(y[1]),N=T.translateBufferLineToString(y[1],!0,0,y[0]);D&&D.isWrapped?O[O.length-1]+=N:O.push(N)}}return O.map(P=>P.replace(S," ")).join(o.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(f){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),o.isLinux&&f&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(f){const y=this._getMouseBufferCoords(f),T=this._model.finalSelectionStart,O=this._model.finalSelectionEnd;return!!(T&&O&&y)&&this._areCoordsInSelection(y,T,O)}isCellInSelection(f,y){const T=this._model.finalSelectionStart,O=this._model.finalSelectionEnd;return!(!T||!O)&&this._areCoordsInSelection([f,y],T,O)}_areCoordsInSelection(f,y,T){return f[1]>y[1]&&f[1]<T[1]||y[1]===T[1]&&f[1]===y[1]&&f[0]>=y[0]&&f[0]<T[0]||y[1]<T[1]&&f[1]===T[1]&&f[0]<T[0]||y[1]<T[1]&&f[1]===y[1]&&f[0]>=y[0]}_selectWordAtCursor(f,y){var P,D;const T=(D=(P=this._linkifier.currentLink)==null?void 0:P.link)==null?void 0:D.range;if(T)return this._model.selectionStart=[T.start.x-1,T.start.y-1],this._model.selectionStartLength=(0,r.getRangeLength)(T,this._bufferService.cols),this._model.selectionEnd=void 0,!0;const O=this._getMouseBufferCoords(f);return!!O&&(this._selectWordAt(O,y),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(f,y){this._model.clearSelection(),f=Math.max(f,0),y=Math.min(y,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,f],this._model.selectionEnd=[this._bufferService.cols,y],this.refresh(),this._onSelectionChange.fire()}_handleTrim(f){this._model.handleTrim(f)&&this.refresh()}_getMouseBufferCoords(f){const y=this._mouseService.getCoords(f,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(y)return y[0]--,y[1]--,y[1]+=this._bufferService.buffer.ydisp,y}_getMouseEventScrollAmount(f){let y=(0,l.getCoordsRelativeToElement)(this._coreBrowserService.window,f,this._screenElement)[1];const T=this._renderService.dimensions.css.canvas.height;return y>=0&&y<=T?0:(y>T&&(y-=T),y=Math.min(Math.max(y,-50),50),y/=50,y/Math.abs(y)+Math.round(14*y))}shouldForceSelection(f){return o.isMac?f.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:f.shiftKey}handleMouseDown(f){if(this._mouseDownTimeStamp=f.timeStamp,(f.button!==2||!this.hasSelection)&&f.button===0){if(!this._enabled){if(!this.shouldForceSelection(f))return;f.stopPropagation()}f.preventDefault(),this._dragScrollAmount=0,this._enabled&&f.shiftKey?this._handleIncrementalClick(f):f.detail===1?this._handleSingleClick(f):f.detail===2?this._handleDoubleClick(f):f.detail===3&&this._handleTripleClick(f),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(f){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(f))}_handleSingleClick(f){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(f)?3:0,this._model.selectionStart=this._getMouseBufferCoords(f),!this._model.selectionStart)return;this._model.selectionEnd=void 0;const y=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);y&&y.length!==this._model.selectionStart[0]&&y.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(f){this._selectWordAtCursor(f,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(f){const y=this._getMouseBufferCoords(f);y&&(this._activeSelectionMode=2,this._selectLineAt(y[1]))}shouldColumnSelect(f){return f.altKey&&!(o.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(f){if(f.stopImmediatePropagation(),!this._model.selectionStart)return;const y=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(f),!this._model.selectionEnd)return void this.refresh(!0);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(f),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));const T=this._bufferService.buffer;if(this._model.selectionEnd[1]<T.lines.length){const O=T.lines.get(this._model.selectionEnd[1]);O&&O.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]<this._bufferService.cols&&this._model.selectionEnd[0]++}y&&y[0]===this._model.selectionEnd[0]&&y[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});const f=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(f.ydisp+this._bufferService.rows,f.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=f.ydisp),this.refresh()}}_handleMouseUp(f){const y=f.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&y<500&&f.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){const T=this._mouseService.getCoords(f,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(T&&T[0]!==void 0&&T[1]!==void 0){const O=(0,v.moveToCellSequence)(T[0]-1,T[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(O,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){const f=this._model.finalSelectionStart,y=this._model.finalSelectionEnd,T=!(!f||!y||f[0]===y[0]&&f[1]===y[1]);T?f&&y&&(this._oldSelectionStart&&this._oldSelectionEnd&&f[0]===this._oldSelectionStart[0]&&f[1]===this._oldSelectionStart[1]&&y[0]===this._oldSelectionEnd[0]&&y[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(f,y,T)):this._oldHasSelection&&this._fireOnSelectionChange(f,y,T)}_fireOnSelectionChange(f,y,T){this._oldSelectionStart=f,this._oldSelectionEnd=y,this._oldHasSelection=T,this._onSelectionChange.fire()}_handleBufferActivate(f){this.clearSelection(),this._trimListener.dispose(),this._trimListener=f.activeBuffer.lines.onTrim(y=>this._handleTrim(y))}_convertViewportColToCharacterIndex(f,y){let T=y;for(let O=0;y>=O;O++){const P=f.loadCell(O,this._workCell).getChars().length;this._workCell.getWidth()===0?T--:P>1&&y!==O&&(T+=P-1)}return T}setSelection(f,y,T){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[f,y],this._model.selectionStartLength=T,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(f){this._isClickInSelection(f)||(this._selectWordAtCursor(f,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(f,y,T=!0,O=!0){if(f[0]>=this._bufferService.cols)return;const P=this._bufferService.buffer,D=P.lines.get(f[1]);if(!D)return;const N=P.translateBufferLineToString(f[1],!1);let X=this._convertViewportColToCharacterIndex(D,f[0]),Z=X;const se=f[0]-X;let ee=0,E=0,A=0,M=0;if(N.charAt(X)===" "){for(;X>0&&N.charAt(X-1)===" ";)X--;for(;Z<N.length&&N.charAt(Z+1)===" ";)Z++}else{let re=f[0],le=f[0];D.getWidth(re)===0&&(ee++,re--),D.getWidth(le)===2&&(E++,le++);const fe=D.getString(le).length;for(fe>1&&(M+=fe-1,Z+=fe-1);re>0&&X>0&&!this._isCharWordSeparator(D.loadCell(re-1,this._workCell));){D.loadCell(re-1,this._workCell);const U=this._workCell.getChars().length;this._workCell.getWidth()===0?(ee++,re--):U>1&&(A+=U-1,X-=U-1),X--,re--}for(;le<D.length&&Z+1<N.length&&!this._isCharWordSeparator(D.loadCell(le+1,this._workCell));){D.loadCell(le+1,this._workCell);const U=this._workCell.getChars().length;this._workCell.getWidth()===2?(E++,le++):U>1&&(M+=U-1,Z+=U-1),Z++,le++}}Z++;let H=X+se-ee+A,Q=Math.min(this._bufferService.cols,Z-X+ee+E-A-M);if(y||N.slice(X,Z).trim()!==""){if(T&&H===0&&D.getCodePoint(0)!==32){const re=P.lines.get(f[1]-1);if(re&&D.isWrapped&&re.getCodePoint(this._bufferService.cols-1)!==32){const le=this._getWordAt([this._bufferService.cols-1,f[1]-1],!1,!0,!1);if(le){const fe=this._bufferService.cols-le.start;H-=fe,Q+=fe}}}if(O&&H+Q===this._bufferService.cols&&D.getCodePoint(this._bufferService.cols-1)!==32){const re=P.lines.get(f[1]+1);if(re!=null&&re.isWrapped&&re.getCodePoint(0)!==32){const le=this._getWordAt([0,f[1]+1],!1,!1,!0);le&&(Q+=le.length)}}return{start:H,length:Q}}}_selectWordAt(f,y){const T=this._getWordAt(f,y);if(T){for(;T.start<0;)T.start+=this._bufferService.cols,f[1]--;this._model.selectionStart=[T.start,f[1]],this._model.selectionStartLength=T.length}}_selectToWordAt(f){const y=this._getWordAt(f,!0);if(y){let T=f[1];for(;y.start<0;)y.start+=this._bufferService.cols,T--;if(!this._model.areSelectionValuesReversed())for(;y.start+y.length>this._bufferService.cols;)y.length-=this._bufferService.cols,T++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?y.start:y.start+y.length,T]}}_isCharWordSeparator(f){return f.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(f.getChars())>=0}_selectLineAt(f){const y=this._bufferService.buffer.getWrappedRangeForLine(f),T={start:{x:0,y:y.first},end:{x:this._bufferService.cols-1,y:y.last}};this._model.selectionStart=[0,y.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,r.getRangeLength)(T,this._bufferService.cols)}};a.SelectionService=C=_([p(3,c.IBufferService),p(4,c.ICoreService),p(5,b.IMouseService),p(6,c.IOptionsService),p(7,b.IRenderService),p(8,b.ICoreBrowserService)],C)},4725:(j,a,u)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.ILinkProviderService=a.IThemeService=a.ICharacterJoinerService=a.ISelectionService=a.IRenderService=a.IMouseService=a.ICoreBrowserService=a.ICharSizeService=void 0;const _=u(8343);a.ICharSizeService=(0,_.createDecorator)("CharSizeService"),a.ICoreBrowserService=(0,_.createDecorator)("CoreBrowserService"),a.IMouseService=(0,_.createDecorator)("MouseService"),a.IRenderService=(0,_.createDecorator)("RenderService"),a.ISelectionService=(0,_.createDecorator)("SelectionService"),a.ICharacterJoinerService=(0,_.createDecorator)("CharacterJoinerService"),a.IThemeService=(0,_.createDecorator)("ThemeService"),a.ILinkProviderService=(0,_.createDecorator)("LinkProviderService")},6731:function(j,a,u){var _=this&&this.__decorate||function(C,f,y,T){var O,P=arguments.length,D=P<3?f:T===null?T=Object.getOwnPropertyDescriptor(f,y):T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")D=Reflect.decorate(C,f,y,T);else for(var N=C.length-1;N>=0;N--)(O=C[N])&&(D=(P<3?O(D):P>3?O(f,y,D):O(f,y))||D);return P>3&&D&&Object.defineProperty(f,y,D),D},p=this&&this.__param||function(C,f){return function(y,T){f(y,T,C)}};Object.defineProperty(a,"__esModule",{value:!0}),a.ThemeService=a.DEFAULT_ANSI_COLORS=void 0;const l=u(7239),v=u(8055),m=u(8460),b=u(844),d=u(2585),s=v.css.toColor("#ffffff"),o=v.css.toColor("#000000"),r=v.css.toColor("#ffffff"),n=v.css.toColor("#000000"),c={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};a.DEFAULT_ANSI_COLORS=Object.freeze((()=>{const C=[v.css.toColor("#2e3436"),v.css.toColor("#cc0000"),v.css.toColor("#4e9a06"),v.css.toColor("#c4a000"),v.css.toColor("#3465a4"),v.css.toColor("#75507b"),v.css.toColor("#06989a"),v.css.toColor("#d3d7cf"),v.css.toColor("#555753"),v.css.toColor("#ef2929"),v.css.toColor("#8ae234"),v.css.toColor("#fce94f"),v.css.toColor("#729fcf"),v.css.toColor("#ad7fa8"),v.css.toColor("#34e2e2"),v.css.toColor("#eeeeec")],f=[0,95,135,175,215,255];for(let y=0;y<216;y++){const T=f[y/36%6|0],O=f[y/6%6|0],P=f[y%6];C.push({css:v.channels.toCss(T,O,P),rgba:v.channels.toRgba(T,O,P)})}for(let y=0;y<24;y++){const T=8+10*y;C.push({css:v.channels.toCss(T,T,T),rgba:v.channels.toRgba(T,T,T)})}return C})());let g=a.ThemeService=class extends b.Disposable{get colors(){return this._colors}constructor(C){super(),this._optionsService=C,this._contrastCache=new l.ColorContrastCache,this._halfContrastCache=new l.ColorContrastCache,this._onChangeColors=this.register(new m.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._colors={foreground:s,background:o,cursor:r,cursorAccent:n,selectionForeground:void 0,selectionBackgroundTransparent:c,selectionBackgroundOpaque:v.color.blend(o,c),selectionInactiveBackgroundTransparent:c,selectionInactiveBackgroundOpaque:v.color.blend(o,c),ansi:a.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache,halfContrastCache:this._halfContrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this.register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}_setTheme(C={}){const f=this._colors;if(f.foreground=S(C.foreground,s),f.background=S(C.background,o),f.cursor=S(C.cursor,r),f.cursorAccent=S(C.cursorAccent,n),f.selectionBackgroundTransparent=S(C.selectionBackground,c),f.selectionBackgroundOpaque=v.color.blend(f.background,f.selectionBackgroundTransparent),f.selectionInactiveBackgroundTransparent=S(C.selectionInactiveBackground,f.selectionBackgroundTransparent),f.selectionInactiveBackgroundOpaque=v.color.blend(f.background,f.selectionInactiveBackgroundTransparent),f.selectionForeground=C.selectionForeground?S(C.selectionForeground,v.NULL_COLOR):void 0,f.selectionForeground===v.NULL_COLOR&&(f.selectionForeground=void 0),v.color.isOpaque(f.selectionBackgroundTransparent)&&(f.selectionBackgroundTransparent=v.color.opacity(f.selectionBackgroundTransparent,.3)),v.color.isOpaque(f.selectionInactiveBackgroundTransparent)&&(f.selectionInactiveBackgroundTransparent=v.color.opacity(f.selectionInactiveBackgroundTransparent,.3)),f.ansi=a.DEFAULT_ANSI_COLORS.slice(),f.ansi[0]=S(C.black,a.DEFAULT_ANSI_COLORS[0]),f.ansi[1]=S(C.red,a.DEFAULT_ANSI_COLORS[1]),f.ansi[2]=S(C.green,a.DEFAULT_ANSI_COLORS[2]),f.ansi[3]=S(C.yellow,a.DEFAULT_ANSI_COLORS[3]),f.ansi[4]=S(C.blue,a.DEFAULT_ANSI_COLORS[4]),f.ansi[5]=S(C.magenta,a.DEFAULT_ANSI_COLORS[5]),f.ansi[6]=S(C.cyan,a.DEFAULT_ANSI_COLORS[6]),f.ansi[7]=S(C.white,a.DEFAULT_ANSI_COLORS[7]),f.ansi[8]=S(C.brightBlack,a.DEFAULT_ANSI_COLORS[8]),f.ansi[9]=S(C.brightRed,a.DEFAULT_ANSI_COLORS[9]),f.ansi[10]=S(C.brightGreen,a.DEFAULT_ANSI_COLORS[10]),f.ansi[11]=S(C.brightYellow,a.DEFAULT_ANSI_COLORS[11]),f.ansi[12]=S(C.brightBlue,a.DEFAULT_ANSI_COLORS[12]),f.ansi[13]=S(C.brightMagenta,a.DEFAULT_ANSI_COLORS[13]),f.ansi[14]=S(C.brightCyan,a.DEFAULT_ANSI_COLORS[14]),f.ansi[15]=S(C.brightWhite,a.DEFAULT_ANSI_COLORS[15]),C.extendedAnsi){const y=Math.min(f.ansi.length-16,C.extendedAnsi.length);for(let T=0;T<y;T++)f.ansi[T+16]=S(C.extendedAnsi[T],a.DEFAULT_ANSI_COLORS[T+16])}this._contrastCache.clear(),this._halfContrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(C){this._restoreColor(C),this._onChangeColors.fire(this.colors)}_restoreColor(C){if(C!==void 0)switch(C){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[C]=this._restoreColors.ansi[C]}else for(let f=0;f<this._restoreColors.ansi.length;++f)this._colors.ansi[f]=this._restoreColors.ansi[f]}modifyColors(C){C(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function S(C,f){if(C!==void 0)try{return v.css.toColor(C)}catch{}return f}a.ThemeService=g=_([p(0,d.IOptionsService)],g)},6349:(j,a,u)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.CircularList=void 0;const _=u(8460),p=u(844);class l extends p.Disposable{constructor(m){super(),this._maxLength=m,this.onDeleteEmitter=this.register(new _.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new _.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new _.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(m){if(this._maxLength===m)return;const b=new Array(m);for(let d=0;d<Math.min(m,this.length);d++)b[d]=this._array[this._getCyclicIndex(d)];this._array=b,this._maxLength=m,this._startIndex=0}get length(){return this._length}set length(m){if(m>this._length)for(let b=this._length;b<m;b++)this._array[b]=void 0;this._length=m}get(m){return this._array[this._getCyclicIndex(m)]}set(m,b){this._array[this._getCyclicIndex(m)]=b}push(m){this._array[this._getCyclicIndex(this._length)]=m,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(m,b,...d){if(b){for(let s=m;s<this._length-b;s++)this._array[this._getCyclicIndex(s)]=this._array[this._getCyclicIndex(s+b)];this._length-=b,this.onDeleteEmitter.fire({index:m,amount:b})}for(let s=this._length-1;s>=m;s--)this._array[this._getCyclicIndex(s+d.length)]=this._array[this._getCyclicIndex(s)];for(let s=0;s<d.length;s++)this._array[this._getCyclicIndex(m+s)]=d[s];if(d.length&&this.onInsertEmitter.fire({index:m,amount:d.length}),this._length+d.length>this._maxLength){const s=this._length+d.length-this._maxLength;this._startIndex+=s,this._length=this._maxLength,this.onTrimEmitter.fire(s)}else this._length+=d.length}trimStart(m){m>this._length&&(m=this._length),this._startIndex+=m,this._length-=m,this.onTrimEmitter.fire(m)}shiftElements(m,b,d){if(!(b<=0)){if(m<0||m>=this._length)throw new Error("start argument out of range");if(m+d<0)throw new Error("Cannot shift elements in list beyond index 0");if(d>0){for(let o=b-1;o>=0;o--)this.set(m+o+d,this.get(m+o));const s=m+b+d-this._length;if(s>0)for(this._length+=s;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let s=0;s<b;s++)this.set(m+s+d,this.get(m+s))}}_getCyclicIndex(m){return(this._startIndex+m)%this._maxLength}}a.CircularList=l},1439:(j,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.clone=void 0,a.clone=function u(_,p=5){if(typeof _!="object")return _;const l=Array.isArray(_)?[]:{};for(const v in _)l[v]=p<=1?_[v]:_[v]&&u(_[v],p-1);return l}},8055:(j,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.contrastRatio=a.toPaddedHex=a.rgba=a.rgb=a.css=a.color=a.channels=a.NULL_COLOR=void 0;let u=0,_=0,p=0,l=0;var v,m,b,d,s;function o(n){const c=n.toString(16);return c.length<2?"0"+c:c}function r(n,c){return n<c?(c+.05)/(n+.05):(n+.05)/(c+.05)}a.NULL_COLOR={css:"#00000000",rgba:0},function(n){n.toCss=function(c,g,S,C){return C!==void 0?`#${o(c)}${o(g)}${o(S)}${o(C)}`:`#${o(c)}${o(g)}${o(S)}`},n.toRgba=function(c,g,S,C=255){return(c<<24|g<<16|S<<8|C)>>>0},n.toColor=function(c,g,S,C){return{css:n.toCss(c,g,S,C),rgba:n.toRgba(c,g,S,C)}}}(v||(a.channels=v={})),function(n){function c(g,S){return l=Math.round(255*S),[u,_,p]=s.toChannels(g.rgba),{css:v.toCss(u,_,p,l),rgba:v.toRgba(u,_,p,l)}}n.blend=function(g,S){if(l=(255&S.rgba)/255,l===1)return{css:S.css,rgba:S.rgba};const C=S.rgba>>24&255,f=S.rgba>>16&255,y=S.rgba>>8&255,T=g.rgba>>24&255,O=g.rgba>>16&255,P=g.rgba>>8&255;return u=T+Math.round((C-T)*l),_=O+Math.round((f-O)*l),p=P+Math.round((y-P)*l),{css:v.toCss(u,_,p),rgba:v.toRgba(u,_,p)}},n.isOpaque=function(g){return(255&g.rgba)==255},n.ensureContrastRatio=function(g,S,C){const f=s.ensureContrastRatio(g.rgba,S.rgba,C);if(f)return v.toColor(f>>24&255,f>>16&255,f>>8&255)},n.opaque=function(g){const S=(255|g.rgba)>>>0;return[u,_,p]=s.toChannels(S),{css:v.toCss(u,_,p),rgba:S}},n.opacity=c,n.multiplyOpacity=function(g,S){return l=255&g.rgba,c(g,l*S/255)},n.toColorRGB=function(g){return[g.rgba>>24&255,g.rgba>>16&255,g.rgba>>8&255]}}(m||(a.color=m={})),function(n){let c,g;try{const S=document.createElement("canvas");S.width=1,S.height=1;const C=S.getContext("2d",{willReadFrequently:!0});C&&(c=C,c.globalCompositeOperation="copy",g=c.createLinearGradient(0,0,1,1))}catch{}n.toColor=function(S){if(S.match(/#[\da-f]{3,8}/i))switch(S.length){case 4:return u=parseInt(S.slice(1,2).repeat(2),16),_=parseInt(S.slice(2,3).repeat(2),16),p=parseInt(S.slice(3,4).repeat(2),16),v.toColor(u,_,p);case 5:return u=parseInt(S.slice(1,2).repeat(2),16),_=parseInt(S.slice(2,3).repeat(2),16),p=parseInt(S.slice(3,4).repeat(2),16),l=parseInt(S.slice(4,5).repeat(2),16),v.toColor(u,_,p,l);case 7:return{css:S,rgba:(parseInt(S.slice(1),16)<<8|255)>>>0};case 9:return{css:S,rgba:parseInt(S.slice(1),16)>>>0}}const C=S.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(C)return u=parseInt(C[1]),_=parseInt(C[2]),p=parseInt(C[3]),l=Math.round(255*(C[5]===void 0?1:parseFloat(C[5]))),v.toColor(u,_,p,l);if(!c||!g)throw new Error("css.toColor: Unsupported css format");if(c.fillStyle=g,c.fillStyle=S,typeof c.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(c.fillRect(0,0,1,1),[u,_,p,l]=c.getImageData(0,0,1,1).data,l!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:v.toRgba(u,_,p,l),css:S}}}(b||(a.css=b={})),function(n){function c(g,S,C){const f=g/255,y=S/255,T=C/255;return .2126*(f<=.03928?f/12.92:Math.pow((f+.055)/1.055,2.4))+.7152*(y<=.03928?y/12.92:Math.pow((y+.055)/1.055,2.4))+.0722*(T<=.03928?T/12.92:Math.pow((T+.055)/1.055,2.4))}n.relativeLuminance=function(g){return c(g>>16&255,g>>8&255,255&g)},n.relativeLuminance2=c}(d||(a.rgb=d={})),function(n){function c(S,C,f){const y=S>>24&255,T=S>>16&255,O=S>>8&255;let P=C>>24&255,D=C>>16&255,N=C>>8&255,X=r(d.relativeLuminance2(P,D,N),d.relativeLuminance2(y,T,O));for(;X<f&&(P>0||D>0||N>0);)P-=Math.max(0,Math.ceil(.1*P)),D-=Math.max(0,Math.ceil(.1*D)),N-=Math.max(0,Math.ceil(.1*N)),X=r(d.relativeLuminance2(P,D,N),d.relativeLuminance2(y,T,O));return(P<<24|D<<16|N<<8|255)>>>0}function g(S,C,f){const y=S>>24&255,T=S>>16&255,O=S>>8&255;let P=C>>24&255,D=C>>16&255,N=C>>8&255,X=r(d.relativeLuminance2(P,D,N),d.relativeLuminance2(y,T,O));for(;X<f&&(P<255||D<255||N<255);)P=Math.min(255,P+Math.ceil(.1*(255-P))),D=Math.min(255,D+Math.ceil(.1*(255-D))),N=Math.min(255,N+Math.ceil(.1*(255-N))),X=r(d.relativeLuminance2(P,D,N),d.relativeLuminance2(y,T,O));return(P<<24|D<<16|N<<8|255)>>>0}n.blend=function(S,C){if(l=(255&C)/255,l===1)return C;const f=C>>24&255,y=C>>16&255,T=C>>8&255,O=S>>24&255,P=S>>16&255,D=S>>8&255;return u=O+Math.round((f-O)*l),_=P+Math.round((y-P)*l),p=D+Math.round((T-D)*l),v.toRgba(u,_,p)},n.ensureContrastRatio=function(S,C,f){const y=d.relativeLuminance(S>>8),T=d.relativeLuminance(C>>8);if(r(y,T)<f){if(T<y){const D=c(S,C,f),N=r(y,d.relativeLuminance(D>>8));if(N<f){const X=g(S,C,f);return N>r(y,d.relativeLuminance(X>>8))?D:X}return D}const O=g(S,C,f),P=r(y,d.relativeLuminance(O>>8));if(P<f){const D=c(S,C,f);return P>r(y,d.relativeLuminance(D>>8))?O:D}return O}},n.reduceLuminance=c,n.increaseLuminance=g,n.toChannels=function(S){return[S>>24&255,S>>16&255,S>>8&255,255&S]}}(s||(a.rgba=s={})),a.toPaddedHex=o,a.contrastRatio=r},8969:(j,a,u)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.CoreTerminal=void 0;const _=u(844),p=u(2585),l=u(4348),v=u(7866),m=u(744),b=u(7302),d=u(6975),s=u(8460),o=u(1753),r=u(1480),n=u(7994),c=u(9282),g=u(5435),S=u(5981),C=u(2660);let f=!1;class y extends _.Disposable{get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new s.EventEmitter),this._onScroll.event(O=>{var P;(P=this._onScrollApi)==null||P.fire(O.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(O){for(const P in O)this.optionsService.options[P]=O[P]}constructor(O){super(),this._windowsWrappingHeuristics=this.register(new _.MutableDisposable),this._onBinary=this.register(new s.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new s.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new s.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new s.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new s.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new s.EventEmitter),this._instantiationService=new l.InstantiationService,this.optionsService=this.register(new b.OptionsService(O)),this._instantiationService.setService(p.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(m.BufferService)),this._instantiationService.setService(p.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(v.LogService)),this._instantiationService.setService(p.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(d.CoreService)),this._instantiationService.setService(p.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(o.CoreMouseService)),this._instantiationService.setService(p.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(r.UnicodeService)),this._instantiationService.setService(p.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(n.CharsetService),this._instantiationService.setService(p.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(C.OscLinkService),this._instantiationService.setService(p.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new g.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,s.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,s.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,s.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,s.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom())),this.register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this.register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],()=>this._handleWindowsPtyOptionChange())),this.register(this._bufferService.onScroll(P=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this.register(this._inputHandler.onScroll(P=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this.register(new S.WriteBuffer((P,D)=>this._inputHandler.parse(P,D))),this.register((0,s.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed))}write(O,P){this._writeBuffer.write(O,P)}writeSync(O,P){this._logService.logLevel<=p.LogLevelEnum.WARN&&!f&&(this._logService.warn("writeSync is unreliable and will be removed soon."),f=!0),this._writeBuffer.writeSync(O,P)}input(O,P=!0){this.coreService.triggerDataEvent(O,P)}resize(O,P){isNaN(O)||isNaN(P)||(O=Math.max(O,m.MINIMUM_COLS),P=Math.max(P,m.MINIMUM_ROWS),this._bufferService.resize(O,P))}scroll(O,P=!1){this._bufferService.scroll(O,P)}scrollLines(O,P,D){this._bufferService.scrollLines(O,P,D)}scrollPages(O){this.scrollLines(O*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(){this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(O){const P=O-this._bufferService.buffer.ydisp;P!==0&&this.scrollLines(P)}registerEscHandler(O,P){return this._inputHandler.registerEscHandler(O,P)}registerDcsHandler(O,P){return this._inputHandler.registerDcsHandler(O,P)}registerCsiHandler(O,P){return this._inputHandler.registerCsiHandler(O,P)}registerOscHandler(O,P){return this._inputHandler.registerOscHandler(O,P)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){let O=!1;const P=this.optionsService.rawOptions.windowsPty;P&&P.buildNumber!==void 0&&P.buildNumber!==void 0?O=P.backend==="conpty"&&P.buildNumber<21376:this.optionsService.rawOptions.windowsMode&&(O=!0),O?this._enableWindowsWrappingHeuristics():this._windowsWrappingHeuristics.clear()}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics.value){const O=[];O.push(this.onLineFeed(c.updateWindowsModeWrappedState.bind(null,this._bufferService))),O.push(this.registerCsiHandler({final:"H"},()=>((0,c.updateWindowsModeWrappedState)(this._bufferService),!1))),this._windowsWrappingHeuristics.value=(0,_.toDisposable)(()=>{for(const P of O)P.dispose()})}}}a.CoreTerminal=y},8460:(j,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.runAndSubscribe=a.forwardEvent=a.EventEmitter=void 0,a.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=u=>(this._listeners.push(u),{dispose:()=>{if(!this._disposed){for(let _=0;_<this._listeners.length;_++)if(this._listeners[_]===u)return void this._listeners.splice(_,1)}}})),this._event}fire(u,_){const p=[];for(let l=0;l<this._listeners.length;l++)p.push(this._listeners[l]);for(let l=0;l<p.length;l++)p[l].call(void 0,u,_)}dispose(){this.clearListeners(),this._disposed=!0}clearListeners(){this._listeners&&(this._listeners.length=0)}},a.forwardEvent=function(u,_){return u(p=>_.fire(p))},a.runAndSubscribe=function(u,_){return _(void 0),u(p=>_(p))}},5435:function(j,a,u){var _=this&&this.__decorate||function(ee,E,A,M){var H,Q=arguments.length,re=Q<3?E:M===null?M=Object.getOwnPropertyDescriptor(E,A):M;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")re=Reflect.decorate(ee,E,A,M);else for(var le=ee.length-1;le>=0;le--)(H=ee[le])&&(re=(Q<3?H(re):Q>3?H(E,A,re):H(E,A))||re);return Q>3&&re&&Object.defineProperty(E,A,re),re},p=this&&this.__param||function(ee,E){return function(A,M){E(A,M,ee)}};Object.defineProperty(a,"__esModule",{value:!0}),a.InputHandler=a.WindowsOptionsReportType=void 0;const l=u(2584),v=u(7116),m=u(2015),b=u(844),d=u(482),s=u(8437),o=u(8460),r=u(643),n=u(511),c=u(3734),g=u(2585),S=u(1480),C=u(6242),f=u(6351),y=u(5941),T={"(":0,")":1,"*":2,"+":3,"-":1,".":2},O=131072;function P(ee,E){if(ee>24)return E.setWinLines||!1;switch(ee){case 1:return!!E.restoreWin;case 2:return!!E.minimizeWin;case 3:return!!E.setWinPosition;case 4:return!!E.setWinSizePixels;case 5:return!!E.raiseWin;case 6:return!!E.lowerWin;case 7:return!!E.refreshWin;case 8:return!!E.setWinSizeChars;case 9:return!!E.maximizeWin;case 10:return!!E.fullscreenWin;case 11:return!!E.getWinState;case 13:return!!E.getWinPosition;case 14:return!!E.getWinSizePixels;case 15:return!!E.getScreenSizePixels;case 16:return!!E.getCellSizePixels;case 18:return!!E.getWinSizeChars;case 19:return!!E.getScreenSizeChars;case 20:return!!E.getIconTitle;case 21:return!!E.getWinTitle;case 22:return!!E.pushTitle;case 23:return!!E.popTitle;case 24:return!!E.setWinLines}return!1}var D;(function(ee){ee[ee.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",ee[ee.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(D||(a.WindowsOptionsReportType=D={}));let N=0;class X extends b.Disposable{getAttrData(){return this._curAttrData}constructor(E,A,M,H,Q,re,le,fe,U=new m.EscapeSequenceParser){super(),this._bufferService=E,this._charsetService=A,this._coreService=M,this._logService=H,this._optionsService=Q,this._oscLinkService=re,this._coreMouseService=le,this._unicodeService=fe,this._parser=U,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new d.StringToUtf32,this._utf8Decoder=new d.Utf8ToUtf32,this._workCell=new n.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=s.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=s.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new o.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new o.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new o.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new o.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new o.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new o.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new o.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new o.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new o.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new o.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new o.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new o.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new o.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new Z(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(R=>this._activeBuffer=R.activeBuffer)),this._parser.setCsiHandlerFallback((R,J)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(R),params:J.toArray()})}),this._parser.setEscHandlerFallback(R=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(R)})}),this._parser.setExecuteHandlerFallback(R=>{this._logService.debug("Unknown EXECUTE code: ",{code:R})}),this._parser.setOscHandlerFallback((R,J,z)=>{this._logService.debug("Unknown OSC code: ",{identifier:R,action:J,data:z})}),this._parser.setDcsHandlerFallback((R,J,z)=>{J==="HOOK"&&(z=z.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(R),action:J,payload:z})}),this._parser.setPrintHandler((R,J,z)=>this.print(R,J,z)),this._parser.registerCsiHandler({final:"@"},R=>this.insertChars(R)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},R=>this.scrollLeft(R)),this._parser.registerCsiHandler({final:"A"},R=>this.cursorUp(R)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},R=>this.scrollRight(R)),this._parser.registerCsiHandler({final:"B"},R=>this.cursorDown(R)),this._parser.registerCsiHandler({final:"C"},R=>this.cursorForward(R)),this._parser.registerCsiHandler({final:"D"},R=>this.cursorBackward(R)),this._parser.registerCsiHandler({final:"E"},R=>this.cursorNextLine(R)),this._parser.registerCsiHandler({final:"F"},R=>this.cursorPrecedingLine(R)),this._parser.registerCsiHandler({final:"G"},R=>this.cursorCharAbsolute(R)),this._parser.registerCsiHandler({final:"H"},R=>this.cursorPosition(R)),this._parser.registerCsiHandler({final:"I"},R=>this.cursorForwardTab(R)),this._parser.registerCsiHandler({final:"J"},R=>this.eraseInDisplay(R,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},R=>this.eraseInDisplay(R,!0)),this._parser.registerCsiHandler({final:"K"},R=>this.eraseInLine(R,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},R=>this.eraseInLine(R,!0)),this._parser.registerCsiHandler({final:"L"},R=>this.insertLines(R)),this._parser.registerCsiHandler({final:"M"},R=>this.deleteLines(R)),this._parser.registerCsiHandler({final:"P"},R=>this.deleteChars(R)),this._parser.registerCsiHandler({final:"S"},R=>this.scrollUp(R)),this._parser.registerCsiHandler({final:"T"},R=>this.scrollDown(R)),this._parser.registerCsiHandler({final:"X"},R=>this.eraseChars(R)),this._parser.registerCsiHandler({final:"Z"},R=>this.cursorBackwardTab(R)),this._parser.registerCsiHandler({final:"`"},R=>this.charPosAbsolute(R)),this._parser.registerCsiHandler({final:"a"},R=>this.hPositionRelative(R)),this._parser.registerCsiHandler({final:"b"},R=>this.repeatPrecedingCharacter(R)),this._parser.registerCsiHandler({final:"c"},R=>this.sendDeviceAttributesPrimary(R)),this._parser.registerCsiHandler({prefix:">",final:"c"},R=>this.sendDeviceAttributesSecondary(R)),this._parser.registerCsiHandler({final:"d"},R=>this.linePosAbsolute(R)),this._parser.registerCsiHandler({final:"e"},R=>this.vPositionRelative(R)),this._parser.registerCsiHandler({final:"f"},R=>this.hVPosition(R)),this._parser.registerCsiHandler({final:"g"},R=>this.tabClear(R)),this._parser.registerCsiHandler({final:"h"},R=>this.setMode(R)),this._parser.registerCsiHandler({prefix:"?",final:"h"},R=>this.setModePrivate(R)),this._parser.registerCsiHandler({final:"l"},R=>this.resetMode(R)),this._parser.registerCsiHandler({prefix:"?",final:"l"},R=>this.resetModePrivate(R)),this._parser.registerCsiHandler({final:"m"},R=>this.charAttributes(R)),this._parser.registerCsiHandler({final:"n"},R=>this.deviceStatus(R)),this._parser.registerCsiHandler({prefix:"?",final:"n"},R=>this.deviceStatusPrivate(R)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},R=>this.softReset(R)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},R=>this.setCursorStyle(R)),this._parser.registerCsiHandler({final:"r"},R=>this.setScrollRegion(R)),this._parser.registerCsiHandler({final:"s"},R=>this.saveCursor(R)),this._parser.registerCsiHandler({final:"t"},R=>this.windowOptions(R)),this._parser.registerCsiHandler({final:"u"},R=>this.restoreCursor(R)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},R=>this.insertColumns(R)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},R=>this.deleteColumns(R)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},R=>this.selectProtected(R)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},R=>this.requestMode(R,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},R=>this.requestMode(R,!1)),this._parser.setExecuteHandler(l.C0.BEL,()=>this.bell()),this._parser.setExecuteHandler(l.C0.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(l.C0.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(l.C0.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(l.C0.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(l.C0.BS,()=>this.backspace()),this._parser.setExecuteHandler(l.C0.HT,()=>this.tab()),this._parser.setExecuteHandler(l.C0.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(l.C0.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(l.C1.IND,()=>this.index()),this._parser.setExecuteHandler(l.C1.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(l.C1.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new C.OscHandler(R=>(this.setTitle(R),this.setIconName(R),!0))),this._parser.registerOscHandler(1,new C.OscHandler(R=>this.setIconName(R))),this._parser.registerOscHandler(2,new C.OscHandler(R=>this.setTitle(R))),this._parser.registerOscHandler(4,new C.OscHandler(R=>this.setOrReportIndexedColor(R))),this._parser.registerOscHandler(8,new C.OscHandler(R=>this.setHyperlink(R))),this._parser.registerOscHandler(10,new C.OscHandler(R=>this.setOrReportFgColor(R))),this._parser.registerOscHandler(11,new C.OscHandler(R=>this.setOrReportBgColor(R))),this._parser.registerOscHandler(12,new C.OscHandler(R=>this.setOrReportCursorColor(R))),this._parser.registerOscHandler(104,new C.OscHandler(R=>this.restoreIndexedColor(R))),this._parser.registerOscHandler(110,new C.OscHandler(R=>this.restoreFgColor(R))),this._parser.registerOscHandler(111,new C.OscHandler(R=>this.restoreBgColor(R))),this._parser.registerOscHandler(112,new C.OscHandler(R=>this.restoreCursorColor(R))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(const R in v.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:R},()=>this.selectCharset("("+R)),this._parser.registerEscHandler({intermediates:")",final:R},()=>this.selectCharset(")"+R)),this._parser.registerEscHandler({intermediates:"*",final:R},()=>this.selectCharset("*"+R)),this._parser.registerEscHandler({intermediates:"+",final:R},()=>this.selectCharset("+"+R)),this._parser.registerEscHandler({intermediates:"-",final:R},()=>this.selectCharset("-"+R)),this._parser.registerEscHandler({intermediates:".",final:R},()=>this.selectCharset("."+R)),this._parser.registerEscHandler({intermediates:"/",final:R},()=>this.selectCharset("/"+R));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(R=>(this._logService.error("Parsing error: ",R),R)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new f.DcsHandler((R,J)=>this.requestStatusString(R,J)))}_preserveStack(E,A,M,H){this._parseStack.paused=!0,this._parseStack.cursorStartX=E,this._parseStack.cursorStartY=A,this._parseStack.decodedLength=M,this._parseStack.position=H}_logSlowResolvingAsync(E){this._logService.logLevel<=g.LogLevelEnum.WARN&&Promise.race([E,new Promise((A,M)=>setTimeout(()=>M("#SLOW_TIMEOUT"),5e3))]).catch(A=>{if(A!=="#SLOW_TIMEOUT")throw A;console.warn("async parser handler taking longer than 5000 ms")})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(E,A){let M,H=this._activeBuffer.x,Q=this._activeBuffer.y,re=0;const le=this._parseStack.paused;if(le){if(M=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,A))return this._logSlowResolvingAsync(M),M;H=this._parseStack.cursorStartX,Q=this._parseStack.cursorStartY,this._parseStack.paused=!1,E.length>O&&(re=this._parseStack.position+O)}if(this._logService.logLevel<=g.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof E=="string"?` "${E}"`:` "${Array.prototype.map.call(E,R=>String.fromCharCode(R)).join("")}"`),typeof E=="string"?E.split("").map(R=>R.charCodeAt(0)):E),this._parseBuffer.length<E.length&&this._parseBuffer.length<O&&(this._parseBuffer=new Uint32Array(Math.min(E.length,O))),le||this._dirtyRowTracker.clearRange(),E.length>O)for(let R=re;R<E.length;R+=O){const J=R+O<E.length?R+O:E.length,z=typeof E=="string"?this._stringDecoder.decode(E.substring(R,J),this._parseBuffer):this._utf8Decoder.decode(E.subarray(R,J),this._parseBuffer);if(M=this._parser.parse(this._parseBuffer,z))return this._preserveStack(H,Q,z,R),this._logSlowResolvingAsync(M),M}else if(!le){const R=typeof E=="string"?this._stringDecoder.decode(E,this._parseBuffer):this._utf8Decoder.decode(E,this._parseBuffer);if(M=this._parser.parse(this._parseBuffer,R))return this._preserveStack(H,Q,R,0),this._logSlowResolvingAsync(M),M}this._activeBuffer.x===H&&this._activeBuffer.y===Q||this._onCursorMove.fire();const fe=this._dirtyRowTracker.end+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp),U=this._dirtyRowTracker.start+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp);U<this._bufferService.rows&&this._onRequestRefreshRows.fire(Math.min(U,this._bufferService.rows-1),Math.min(fe,this._bufferService.rows-1))}print(E,A,M){let H,Q;const re=this._charsetService.charset,le=this._optionsService.rawOptions.screenReaderMode,fe=this._bufferService.cols,U=this._coreService.decPrivateModes.wraparound,R=this._coreService.modes.insertMode,J=this._curAttrData;let z=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&M-A>0&&z.getWidth(this._activeBuffer.x-1)===2&&z.setCellFromCodepoint(this._activeBuffer.x-1,0,1,J);let ne=this._parser.precedingJoinState;for(let ie=A;ie<M;++ie){if(H=E[ie],H<127&&re){const Je=re[String.fromCharCode(H)];Je&&(H=Je.charCodeAt(0))}const Ee=this._unicodeService.charProperties(H,ne);Q=S.UnicodeService.extractWidth(Ee);const Le=S.UnicodeService.extractShouldJoin(Ee),Me=Le?S.UnicodeService.extractWidth(ne):0;if(ne=Ee,le&&this._onA11yChar.fire((0,d.stringFromCodePoint)(H)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),this._activeBuffer.x+Q-Me>fe){if(U){const Je=z;let ue=this._activeBuffer.x-Me;for(this._activeBuffer.x=Me,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),z=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y),Me>0&&z instanceof s.BufferLine&&z.copyCellsFrom(Je,ue,0,Me,!1);ue<fe;)Je.setCellFromCodepoint(ue++,0,1,J)}else if(this._activeBuffer.x=fe-1,Q===2)continue}if(Le&&this._activeBuffer.x){const Je=z.getWidth(this._activeBuffer.x-1)?1:2;z.addCodepointToCell(this._activeBuffer.x-Je,H,Q);for(let ue=Q-Me;--ue>=0;)z.setCellFromCodepoint(this._activeBuffer.x++,0,0,J)}else if(R&&(z.insertCells(this._activeBuffer.x,Q-Me,this._activeBuffer.getNullCell(J)),z.getWidth(fe-1)===2&&z.setCellFromCodepoint(fe-1,r.NULL_CELL_CODE,r.NULL_CELL_WIDTH,J)),z.setCellFromCodepoint(this._activeBuffer.x++,H,Q,J),Q>0)for(;--Q;)z.setCellFromCodepoint(this._activeBuffer.x++,0,0,J)}this._parser.precedingJoinState=ne,this._activeBuffer.x<fe&&M-A>0&&z.getWidth(this._activeBuffer.x)===0&&!z.hasContent(this._activeBuffer.x)&&z.setCellFromCodepoint(this._activeBuffer.x,0,1,J),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(E,A){return E.final!=="t"||E.prefix||E.intermediates?this._parser.registerCsiHandler(E,A):this._parser.registerCsiHandler(E,M=>!P(M.params[0],this._optionsService.rawOptions.windowOptions)||A(M))}registerDcsHandler(E,A){return this._parser.registerDcsHandler(E,new f.DcsHandler(A))}registerEscHandler(E,A){return this._parser.registerEscHandler(E,A)}registerOscHandler(E,A){return this._parser.registerOscHandler(E,new C.OscHandler(A))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){var E;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&((E=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))!=null&&E.isWrapped)){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;const A=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);A.hasWidth(this._activeBuffer.x)&&!A.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;const E=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-E),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(E=this._bufferService.cols-1){this._activeBuffer.x=Math.min(E,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(E,A){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=E,this._activeBuffer.y=this._activeBuffer.scrollTop+A):(this._activeBuffer.x=E,this._activeBuffer.y=A),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(E,A){this._restrictCursor(),this._setCursor(this._activeBuffer.x+E,this._activeBuffer.y+A)}cursorUp(E){const A=this._activeBuffer.y-this._activeBuffer.scrollTop;return A>=0?this._moveCursor(0,-Math.min(A,E.params[0]||1)):this._moveCursor(0,-(E.params[0]||1)),!0}cursorDown(E){const A=this._activeBuffer.scrollBottom-this._activeBuffer.y;return A>=0?this._moveCursor(0,Math.min(A,E.params[0]||1)):this._moveCursor(0,E.params[0]||1),!0}cursorForward(E){return this._moveCursor(E.params[0]||1,0),!0}cursorBackward(E){return this._moveCursor(-(E.params[0]||1),0),!0}cursorNextLine(E){return this.cursorDown(E),this._activeBuffer.x=0,!0}cursorPrecedingLine(E){return this.cursorUp(E),this._activeBuffer.x=0,!0}cursorCharAbsolute(E){return this._setCursor((E.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(E){return this._setCursor(E.length>=2?(E.params[1]||1)-1:0,(E.params[0]||1)-1),!0}charPosAbsolute(E){return this._setCursor((E.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(E){return this._moveCursor(E.params[0]||1,0),!0}linePosAbsolute(E){return this._setCursor(this._activeBuffer.x,(E.params[0]||1)-1),!0}vPositionRelative(E){return this._moveCursor(0,E.params[0]||1),!0}hVPosition(E){return this.cursorPosition(E),!0}tabClear(E){const A=E.params[0];return A===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:A===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(E){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let A=E.params[0]||1;for(;A--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(E){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let A=E.params[0]||1;for(;A--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(E){const A=E.params[0];return A===1&&(this._curAttrData.bg|=536870912),A!==2&&A!==0||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(E,A,M,H=!1,Q=!1){const re=this._activeBuffer.lines.get(this._activeBuffer.ybase+E);re.replaceCells(A,M,this._activeBuffer.getNullCell(this._eraseAttrData()),Q),H&&(re.isWrapped=!1)}_resetBufferLine(E,A=!1){const M=this._activeBuffer.lines.get(this._activeBuffer.ybase+E);M&&(M.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),A),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+E),M.isWrapped=!1)}eraseInDisplay(E,A=!1){let M;switch(this._restrictCursor(this._bufferService.cols),E.params[0]){case 0:for(M=this._activeBuffer.y,this._dirtyRowTracker.markDirty(M),this._eraseInBufferLine(M++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,A);M<this._bufferService.rows;M++)this._resetBufferLine(M,A);this._dirtyRowTracker.markDirty(M);break;case 1:for(M=this._activeBuffer.y,this._dirtyRowTracker.markDirty(M),this._eraseInBufferLine(M,0,this._activeBuffer.x+1,!0,A),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(M+1).isWrapped=!1);M--;)this._resetBufferLine(M,A);this._dirtyRowTracker.markDirty(0);break;case 2:for(M=this._bufferService.rows,this._dirtyRowTracker.markDirty(M-1);M--;)this._resetBufferLine(M,A);this._dirtyRowTracker.markDirty(0);break;case 3:const H=this._activeBuffer.lines.length-this._bufferService.rows;H>0&&(this._activeBuffer.lines.trimStart(H),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-H,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-H,0),this._onScroll.fire(0))}return!0}eraseInLine(E,A=!1){switch(this._restrictCursor(this._bufferService.cols),E.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,A);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,A);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,A)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(E){this._restrictCursor();let A=E.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const M=this._activeBuffer.ybase+this._activeBuffer.y,H=this._bufferService.rows-1-this._activeBuffer.scrollBottom,Q=this._bufferService.rows-1+this._activeBuffer.ybase-H+1;for(;A--;)this._activeBuffer.lines.splice(Q-1,1),this._activeBuffer.lines.splice(M,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(E){this._restrictCursor();let A=E.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const M=this._activeBuffer.ybase+this._activeBuffer.y;let H;for(H=this._bufferService.rows-1-this._activeBuffer.scrollBottom,H=this._bufferService.rows-1+this._activeBuffer.ybase-H;A--;)this._activeBuffer.lines.splice(M,1),this._activeBuffer.lines.splice(H,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(E){this._restrictCursor();const A=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return A&&(A.insertCells(this._activeBuffer.x,E.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(E){this._restrictCursor();const A=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return A&&(A.deleteCells(this._activeBuffer.x,E.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(E){let A=E.params[0]||1;for(;A--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(E){let A=E.params[0]||1;for(;A--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(s.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(E){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const A=E.params[0]||1;for(let M=this._activeBuffer.scrollTop;M<=this._activeBuffer.scrollBottom;++M){const H=this._activeBuffer.lines.get(this._activeBuffer.ybase+M);H.deleteCells(0,A,this._activeBuffer.getNullCell(this._eraseAttrData())),H.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(E){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const A=E.params[0]||1;for(let M=this._activeBuffer.scrollTop;M<=this._activeBuffer.scrollBottom;++M){const H=this._activeBuffer.lines.get(this._activeBuffer.ybase+M);H.insertCells(0,A,this._activeBuffer.getNullCell(this._eraseAttrData())),H.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(E){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const A=E.params[0]||1;for(let M=this._activeBuffer.scrollTop;M<=this._activeBuffer.scrollBottom;++M){const H=this._activeBuffer.lines.get(this._activeBuffer.ybase+M);H.insertCells(this._activeBuffer.x,A,this._activeBuffer.getNullCell(this._eraseAttrData())),H.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(E){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const A=E.params[0]||1;for(let M=this._activeBuffer.scrollTop;M<=this._activeBuffer.scrollBottom;++M){const H=this._activeBuffer.lines.get(this._activeBuffer.ybase+M);H.deleteCells(this._activeBuffer.x,A,this._activeBuffer.getNullCell(this._eraseAttrData())),H.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(E){this._restrictCursor();const A=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return A&&(A.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(E.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(E){const A=this._parser.precedingJoinState;if(!A)return!0;const M=E.params[0]||1,H=S.UnicodeService.extractWidth(A),Q=this._activeBuffer.x-H,re=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).getString(Q),le=new Uint32Array(re.length*M);let fe=0;for(let R=0;R<re.length;){const J=re.codePointAt(R)||0;le[fe++]=J,R+=J>65535?2:1}let U=fe;for(let R=1;R<M;++R)le.copyWithin(U,0,fe),U+=fe;return this.print(le,0,U),!0}sendDeviceAttributesPrimary(E){return E.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(l.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(l.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(E){return E.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(l.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(l.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(E.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(l.C0.ESC+"[>83;40003;0c")),!0}_is(E){return(this._optionsService.rawOptions.termName+"").indexOf(E)===0}setMode(E){for(let A=0;A<E.length;A++)switch(E.params[A]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(E){for(let A=0;A<E.length;A++)switch(E.params[A]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,v.DEFAULT_CHARSET),this._charsetService.setgCharset(1,v.DEFAULT_CHARSET),this._charsetService.setgCharset(2,v.DEFAULT_CHARSET),this._charsetService.setgCharset(3,v.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(E){for(let A=0;A<E.length;A++)switch(E.params[A]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(E){for(let A=0;A<E.length;A++)switch(E.params[A]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),E.params[A]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(E,A){const M=this._coreService.decPrivateModes,{activeProtocol:H,activeEncoding:Q}=this._coreMouseService,re=this._coreService,{buffers:le,cols:fe}=this._bufferService,{active:U,alt:R}=le,J=this._optionsService.rawOptions,z=Le=>Le?1:2,ne=E.params[0];return ie=ne,Ee=A?ne===2?4:ne===4?z(re.modes.insertMode):ne===12?3:ne===20?z(J.convertEol):0:ne===1?z(M.applicationCursorKeys):ne===3?J.windowOptions.setWinLines?fe===80?2:fe===132?1:0:0:ne===6?z(M.origin):ne===7?z(M.wraparound):ne===8?3:ne===9?z(H==="X10"):ne===12?z(J.cursorBlink):ne===25?z(!re.isCursorHidden):ne===45?z(M.reverseWraparound):ne===66?z(M.applicationKeypad):ne===67?4:ne===1e3?z(H==="VT200"):ne===1002?z(H==="DRAG"):ne===1003?z(H==="ANY"):ne===1004?z(M.sendFocus):ne===1005?4:ne===1006?z(Q==="SGR"):ne===1015?4:ne===1016?z(Q==="SGR_PIXELS"):ne===1048?1:ne===47||ne===1047||ne===1049?z(U===R):ne===2004?z(M.bracketedPasteMode):0,re.triggerDataEvent(`${l.C0.ESC}[${A?"":"?"}${ie};${Ee}$y`),!0;var ie,Ee}_updateAttrColor(E,A,M,H,Q){return A===2?(E|=50331648,E&=-16777216,E|=c.AttributeData.fromColorRGB([M,H,Q])):A===5&&(E&=-50331904,E|=33554432|255&M),E}_extractColor(E,A,M){const H=[0,0,-1,0,0,0];let Q=0,re=0;do{if(H[re+Q]=E.params[A+re],E.hasSubParams(A+re)){const le=E.getSubParams(A+re);let fe=0;do H[1]===5&&(Q=1),H[re+fe+1+Q]=le[fe];while(++fe<le.length&&fe+re+1+Q<H.length);break}if(H[1]===5&&re+Q>=2||H[1]===2&&re+Q>=5)break;H[1]&&(Q=1)}while(++re+A<E.length&&re+Q<H.length);for(let le=2;le<H.length;++le)H[le]===-1&&(H[le]=0);switch(H[0]){case 38:M.fg=this._updateAttrColor(M.fg,H[1],H[3],H[4],H[5]);break;case 48:M.bg=this._updateAttrColor(M.bg,H[1],H[3],H[4],H[5]);break;case 58:M.extended=M.extended.clone(),M.extended.underlineColor=this._updateAttrColor(M.extended.underlineColor,H[1],H[3],H[4],H[5])}return re}_processUnderline(E,A){A.extended=A.extended.clone(),(!~E||E>5)&&(E=1),A.extended.underlineStyle=E,A.fg|=268435456,E===0&&(A.fg&=-268435457),A.updateExtended()}_processSGR0(E){E.fg=s.DEFAULT_ATTR_DATA.fg,E.bg=s.DEFAULT_ATTR_DATA.bg,E.extended=E.extended.clone(),E.extended.underlineStyle=0,E.extended.underlineColor&=-67108864,E.updateExtended()}charAttributes(E){if(E.length===1&&E.params[0]===0)return this._processSGR0(this._curAttrData),!0;const A=E.length;let M;const H=this._curAttrData;for(let Q=0;Q<A;Q++)M=E.params[Q],M>=30&&M<=37?(H.fg&=-50331904,H.fg|=16777216|M-30):M>=40&&M<=47?(H.bg&=-50331904,H.bg|=16777216|M-40):M>=90&&M<=97?(H.fg&=-50331904,H.fg|=16777224|M-90):M>=100&&M<=107?(H.bg&=-50331904,H.bg|=16777224|M-100):M===0?this._processSGR0(H):M===1?H.fg|=134217728:M===3?H.bg|=67108864:M===4?(H.fg|=268435456,this._processUnderline(E.hasSubParams(Q)?E.getSubParams(Q)[0]:1,H)):M===5?H.fg|=536870912:M===7?H.fg|=67108864:M===8?H.fg|=1073741824:M===9?H.fg|=2147483648:M===2?H.bg|=134217728:M===21?this._processUnderline(2,H):M===22?(H.fg&=-134217729,H.bg&=-134217729):M===23?H.bg&=-67108865:M===24?(H.fg&=-268435457,this._processUnderline(0,H)):M===25?H.fg&=-536870913:M===27?H.fg&=-67108865:M===28?H.fg&=-1073741825:M===29?H.fg&=2147483647:M===39?(H.fg&=-67108864,H.fg|=16777215&s.DEFAULT_ATTR_DATA.fg):M===49?(H.bg&=-67108864,H.bg|=16777215&s.DEFAULT_ATTR_DATA.bg):M===38||M===48||M===58?Q+=this._extractColor(E,Q,H):M===53?H.bg|=1073741824:M===55?H.bg&=-1073741825:M===59?(H.extended=H.extended.clone(),H.extended.underlineColor=-1,H.updateExtended()):M===100?(H.fg&=-67108864,H.fg|=16777215&s.DEFAULT_ATTR_DATA.fg,H.bg&=-67108864,H.bg|=16777215&s.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",M);return!0}deviceStatus(E){switch(E.params[0]){case 5:this._coreService.triggerDataEvent(`${l.C0.ESC}[0n`);break;case 6:const A=this._activeBuffer.y+1,M=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${l.C0.ESC}[${A};${M}R`)}return!0}deviceStatusPrivate(E){if(E.params[0]===6){const A=this._activeBuffer.y+1,M=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${l.C0.ESC}[?${A};${M}R`)}return!0}softReset(E){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=s.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(E){const A=E.params[0]||1;switch(A){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}const M=A%2==1;return this._optionsService.options.cursorBlink=M,!0}setScrollRegion(E){const A=E.params[0]||1;let M;return(E.length<2||(M=E.params[1])>this._bufferService.rows||M===0)&&(M=this._bufferService.rows),M>A&&(this._activeBuffer.scrollTop=A-1,this._activeBuffer.scrollBottom=M-1,this._setCursor(0,0)),!0}windowOptions(E){if(!P(E.params[0],this._optionsService.rawOptions.windowOptions))return!0;const A=E.length>1?E.params[1]:0;switch(E.params[0]){case 14:A!==2&&this._onRequestWindowsOptionsReport.fire(D.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(D.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${l.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:A!==0&&A!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),A!==0&&A!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:A!==0&&A!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),A!==0&&A!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(E){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(E){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(E){return this._windowTitle=E,this._onTitleChange.fire(E),!0}setIconName(E){return this._iconName=E,!0}setOrReportIndexedColor(E){const A=[],M=E.split(";");for(;M.length>1;){const H=M.shift(),Q=M.shift();if(/^\d+$/.exec(H)){const re=parseInt(H);if(se(re))if(Q==="?")A.push({type:0,index:re});else{const le=(0,y.parseColor)(Q);le&&A.push({type:1,index:re,color:le})}}}return A.length&&this._onColor.fire(A),!0}setHyperlink(E){const A=E.split(";");return!(A.length<2)&&(A[1]?this._createHyperlink(A[0],A[1]):!A[0]&&this._finishHyperlink())}_createHyperlink(E,A){this._getCurrentLinkId()&&this._finishHyperlink();const M=E.split(":");let H;const Q=M.findIndex(re=>re.startsWith("id="));return Q!==-1&&(H=M[Q].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:H,uri:A}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(E,A){const M=E.split(";");for(let H=0;H<M.length&&!(A>=this._specialColors.length);++H,++A)if(M[H]==="?")this._onColor.fire([{type:0,index:this._specialColors[A]}]);else{const Q=(0,y.parseColor)(M[H]);Q&&this._onColor.fire([{type:1,index:this._specialColors[A],color:Q}])}return!0}setOrReportFgColor(E){return this._setOrReportSpecialColor(E,0)}setOrReportBgColor(E){return this._setOrReportSpecialColor(E,1)}setOrReportCursorColor(E){return this._setOrReportSpecialColor(E,2)}restoreIndexedColor(E){if(!E)return this._onColor.fire([{type:2}]),!0;const A=[],M=E.split(";");for(let H=0;H<M.length;++H)if(/^\d+$/.exec(M[H])){const Q=parseInt(M[H]);se(Q)&&A.push({type:2,index:Q})}return A.length&&this._onColor.fire(A),!0}restoreFgColor(E){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(E){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(E){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,v.DEFAULT_CHARSET),!0}selectCharset(E){return E.length!==2?(this.selectDefaultCharset(),!0):(E[0]==="/"||this._charsetService.setgCharset(T[E[0]],v.CHARSETS[E[1]]||v.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){const E=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,E,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=s.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=s.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(E){return this._charsetService.setgLevel(E),!0}screenAlignmentPattern(){const E=new n.CellData;E.content=4194304|"E".charCodeAt(0),E.fg=this._curAttrData.fg,E.bg=this._curAttrData.bg,this._setCursor(0,0);for(let A=0;A<this._bufferService.rows;++A){const M=this._activeBuffer.ybase+this._activeBuffer.y+A,H=this._activeBuffer.lines.get(M);H&&(H.fill(E),H.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(E,A){const M=this._bufferService.buffer,H=this._optionsService.rawOptions;return(Q=>(this._coreService.triggerDataEvent(`${l.C0.ESC}${Q}${l.C0.ESC}\\`),!0))(E==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:E==='"p'?'P1$r61;1"p':E==="r"?`P1$r${M.scrollTop+1};${M.scrollBottom+1}r`:E==="m"?"P1$r0m":E===" q"?`P1$r${{block:2,underline:4,bar:6}[H.cursorStyle]-(H.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(E,A){this._dirtyRowTracker.markRangeDirty(E,A)}}a.InputHandler=X;let Z=class{constructor(ee){this._bufferService=ee,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(ee){ee<this.start?this.start=ee:ee>this.end&&(this.end=ee)}markRangeDirty(ee,E){ee>E&&(N=ee,ee=E,E=N),ee<this.start&&(this.start=ee),E>this.end&&(this.end=E)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};function se(ee){return 0<=ee&&ee<256}Z=_([p(0,g.IBufferService)],Z)},844:(j,a)=>{function u(_){for(const p of _)p.dispose();_.length=0}Object.defineProperty(a,"__esModule",{value:!0}),a.getDisposeArrayDisposable=a.disposeArray=a.toDisposable=a.MutableDisposable=a.Disposable=void 0,a.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const _ of this._disposables)_.dispose();this._disposables.length=0}register(_){return this._disposables.push(_),_}unregister(_){const p=this._disposables.indexOf(_);p!==-1&&this._disposables.splice(p,1)}},a.MutableDisposable=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(_){var p;this._isDisposed||_===this._value||((p=this._value)==null||p.dispose(),this._value=_)}clear(){this.value=void 0}dispose(){var _;this._isDisposed=!0,(_=this._value)==null||_.dispose(),this._value=void 0}},a.toDisposable=function(_){return{dispose:_}},a.disposeArray=u,a.getDisposeArrayDisposable=function(_){return{dispose:()=>u(_)}}},1505:(j,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.FourKeyMap=a.TwoKeyMap=void 0;class u{constructor(){this._data={}}set(p,l,v){this._data[p]||(this._data[p]={}),this._data[p][l]=v}get(p,l){return this._data[p]?this._data[p][l]:void 0}clear(){this._data={}}}a.TwoKeyMap=u,a.FourKeyMap=class{constructor(){this._data=new u}set(_,p,l,v,m){this._data.get(_,p)||this._data.set(_,p,new u),this._data.get(_,p).set(l,v,m)}get(_,p,l,v){var m;return(m=this._data.get(_,p))==null?void 0:m.get(l,v)}clear(){this._data.clear()}}},6114:(j,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.isChromeOS=a.isLinux=a.isWindows=a.isIphone=a.isIpad=a.isMac=a.getSafariVersion=a.isSafari=a.isLegacyEdge=a.isFirefox=a.isNode=void 0,a.isNode=typeof process<"u"&&"title"in process;const u=a.isNode?"node":navigator.userAgent,_=a.isNode?"node":navigator.platform;a.isFirefox=u.includes("Firefox"),a.isLegacyEdge=u.includes("Edge"),a.isSafari=/^((?!chrome|android).)*safari/i.test(u),a.getSafariVersion=function(){if(!a.isSafari)return 0;const p=u.match(/Version\/(\d+)/);return p===null||p.length<2?0:parseInt(p[1])},a.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(_),a.isIpad=_==="iPad",a.isIphone=_==="iPhone",a.isWindows=["Windows","Win16","Win32","WinCE"].includes(_),a.isLinux=_.indexOf("Linux")>=0,a.isChromeOS=/\bCrOS\b/.test(u)},6106:(j,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.SortedList=void 0;let u=0;a.SortedList=class{constructor(_){this._getKey=_,this._array=[]}clear(){this._array.length=0}insert(_){this._array.length!==0?(u=this._search(this._getKey(_)),this._array.splice(u,0,_)):this._array.push(_)}delete(_){if(this._array.length===0)return!1;const p=this._getKey(_);if(p===void 0||(u=this._search(p),u===-1)||this._getKey(this._array[u])!==p)return!1;do if(this._array[u]===_)return this._array.splice(u,1),!0;while(++u<this._array.length&&this._getKey(this._array[u])===p);return!1}*getKeyIterator(_){if(this._array.length!==0&&(u=this._search(_),!(u<0||u>=this._array.length)&&this._getKey(this._array[u])===_))do yield this._array[u];while(++u<this._array.length&&this._getKey(this._array[u])===_)}forEachByKey(_,p){if(this._array.length!==0&&(u=this._search(_),!(u<0||u>=this._array.length)&&this._getKey(this._array[u])===_))do p(this._array[u]);while(++u<this._array.length&&this._getKey(this._array[u])===_)}values(){return[...this._array].values()}_search(_){let p=0,l=this._array.length-1;for(;l>=p;){let v=p+l>>1;const m=this._getKey(this._array[v]);if(m>_)l=v-1;else{if(!(m<_)){for(;v>0&&this._getKey(this._array[v-1])===_;)v--;return v}p=v+1}}return p}}},7226:(j,a,u)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.DebouncedIdleTask=a.IdleTaskQueue=a.PriorityTaskQueue=void 0;const _=u(6114);class p{constructor(){this._tasks=[],this._i=0}enqueue(m){this._tasks.push(m),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(m){this._idleCallback=void 0;let b=0,d=0,s=m.timeRemaining(),o=0;for(;this._i<this._tasks.length;){if(b=Date.now(),this._tasks[this._i]()||this._i++,b=Math.max(1,Date.now()-b),d=Math.max(b,d),o=m.timeRemaining(),1.5*d>o)return s-b<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(s-b))}ms`),void this._start();s=o}this.clear()}}class l extends p{_requestCallback(m){return setTimeout(()=>m(this._createDeadline(16)))}_cancelCallback(m){clearTimeout(m)}_createDeadline(m){const b=Date.now()+m;return{timeRemaining:()=>Math.max(0,b-Date.now())}}}a.PriorityTaskQueue=l,a.IdleTaskQueue=!_.isNode&&"requestIdleCallback"in window?class extends p{_requestCallback(v){return requestIdleCallback(v)}_cancelCallback(v){cancelIdleCallback(v)}}:l,a.DebouncedIdleTask=class{constructor(){this._queue=new a.IdleTaskQueue}set(v){this._queue.clear(),this._queue.enqueue(v)}flush(){this._queue.flush()}}},9282:(j,a,u)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.updateWindowsModeWrappedState=void 0;const _=u(643);a.updateWindowsModeWrappedState=function(p){const l=p.buffer.lines.get(p.buffer.ybase+p.buffer.y-1),v=l==null?void 0:l.get(p.cols-1),m=p.buffer.lines.get(p.buffer.ybase+p.buffer.y);m&&v&&(m.isWrapped=v[_.CHAR_DATA_CODE_INDEX]!==_.NULL_CELL_CODE&&v[_.CHAR_DATA_CODE_INDEX]!==_.WHITESPACE_CELL_CODE)}},3734:(j,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.ExtendedAttrs=a.AttributeData=void 0;class u{constructor(){this.fg=0,this.bg=0,this.extended=new _}static toColorRGB(l){return[l>>>16&255,l>>>8&255,255&l]}static fromColorRGB(l){return(255&l[0])<<16|(255&l[1])<<8|255&l[2]}clone(){const l=new u;return l.fg=this.fg,l.bg=this.bg,l.extended=this.extended.clone(),l}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}getUnderlineVariantOffset(){return this.extended.underlineVariantOffset}}a.AttributeData=u;class _{get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(l){this._ext=l}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(l){this._ext&=-469762049,this._ext|=l<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(l){this._ext&=-67108864,this._ext|=67108863&l}get urlId(){return this._urlId}set urlId(l){this._urlId=l}get underlineVariantOffset(){const l=(3758096384&this._ext)>>29;return l<0?4294967288^l:l}set underlineVariantOffset(l){this._ext&=536870911,this._ext|=l<<29&3758096384}constructor(l=0,v=0){this._ext=0,this._urlId=0,this._ext=l,this._urlId=v}clone(){return new _(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}a.ExtendedAttrs=_},9092:(j,a,u)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.Buffer=a.MAX_BUFFER_SIZE=void 0;const _=u(6349),p=u(7226),l=u(3734),v=u(8437),m=u(4634),b=u(511),d=u(643),s=u(4863),o=u(7116);a.MAX_BUFFER_SIZE=4294967295,a.Buffer=class{constructor(r,n,c){this._hasScrollback=r,this._optionsService=n,this._bufferService=c,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=v.DEFAULT_ATTR_DATA.clone(),this.savedCharset=o.DEFAULT_CHARSET,this.markers=[],this._nullCell=b.CellData.fromCharData([0,d.NULL_CELL_CHAR,d.NULL_CELL_WIDTH,d.NULL_CELL_CODE]),this._whitespaceCell=b.CellData.fromCharData([0,d.WHITESPACE_CELL_CHAR,d.WHITESPACE_CELL_WIDTH,d.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new p.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new _.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(r){return r?(this._nullCell.fg=r.fg,this._nullCell.bg=r.bg,this._nullCell.extended=r.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new l.ExtendedAttrs),this._nullCell}getWhitespaceCell(r){return r?(this._whitespaceCell.fg=r.fg,this._whitespaceCell.bg=r.bg,this._whitespaceCell.extended=r.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new l.ExtendedAttrs),this._whitespaceCell}getBlankLine(r,n){return new v.BufferLine(this._bufferService.cols,this.getNullCell(r),n)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){const r=this.ybase+this.y-this.ydisp;return r>=0&&r<this._rows}_getCorrectBufferLength(r){if(!this._hasScrollback)return r;const n=r+this._optionsService.rawOptions.scrollback;return n>a.MAX_BUFFER_SIZE?a.MAX_BUFFER_SIZE:n}fillViewportRows(r){if(this.lines.length===0){r===void 0&&(r=v.DEFAULT_ATTR_DATA);let n=this._rows;for(;n--;)this.lines.push(this.getBlankLine(r))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new _.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(r,n){const c=this.getNullCell(v.DEFAULT_ATTR_DATA);let g=0;const S=this._getCorrectBufferLength(n);if(S>this.lines.maxLength&&(this.lines.maxLength=S),this.lines.length>0){if(this._cols<r)for(let f=0;f<this.lines.length;f++)g+=+this.lines.get(f).resize(r,c);let C=0;if(this._rows<n)for(let f=this._rows;f<n;f++)this.lines.length<n+this.ybase&&(this._optionsService.rawOptions.windowsMode||this._optionsService.rawOptions.windowsPty.backend!==void 0||this._optionsService.rawOptions.windowsPty.buildNumber!==void 0?this.lines.push(new v.BufferLine(r,c)):this.ybase>0&&this.lines.length<=this.ybase+this.y+C+1?(this.ybase--,C++,this.ydisp>0&&this.ydisp--):this.lines.push(new v.BufferLine(r,c)));else for(let f=this._rows;f>n;f--)this.lines.length>n+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(S<this.lines.maxLength){const f=this.lines.length-S;f>0&&(this.lines.trimStart(f),this.ybase=Math.max(this.ybase-f,0),this.ydisp=Math.max(this.ydisp-f,0),this.savedY=Math.max(this.savedY-f,0)),this.lines.maxLength=S}this.x=Math.min(this.x,r-1),this.y=Math.min(this.y,n-1),C&&(this.y+=C),this.savedX=Math.min(this.savedX,r-1),this.scrollTop=0}if(this.scrollBottom=n-1,this._isReflowEnabled&&(this._reflow(r,n),this._cols>r))for(let C=0;C<this.lines.length;C++)g+=+this.lines.get(C).resize(r,c);this._cols=r,this._rows=n,this._memoryCleanupQueue.clear(),g>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let r=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,r=!1);let n=0;for(;this._memoryCleanupPosition<this.lines.length;)if(n+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),n>100)return!0;return r}get _isReflowEnabled(){const r=this._optionsService.rawOptions.windowsPty;return r&&r.buildNumber?this._hasScrollback&&r.backend==="conpty"&&r.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(r,n){this._cols!==r&&(r>this._cols?this._reflowLarger(r,n):this._reflowSmaller(r,n))}_reflowLarger(r,n){const c=(0,m.reflowLargerGetLinesToRemove)(this.lines,this._cols,r,this.ybase+this.y,this.getNullCell(v.DEFAULT_ATTR_DATA));if(c.length>0){const g=(0,m.reflowLargerCreateNewLayout)(this.lines,c);(0,m.reflowLargerApplyNewLayout)(this.lines,g.layout),this._reflowLargerAdjustViewport(r,n,g.countRemoved)}}_reflowLargerAdjustViewport(r,n,c){const g=this.getNullCell(v.DEFAULT_ATTR_DATA);let S=c;for(;S-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<n&&this.lines.push(new v.BufferLine(r,g))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-c,0)}_reflowSmaller(r,n){const c=this.getNullCell(v.DEFAULT_ATTR_DATA),g=[];let S=0;for(let C=this.lines.length-1;C>=0;C--){let f=this.lines.get(C);if(!f||!f.isWrapped&&f.getTrimmedLength()<=r)continue;const y=[f];for(;f.isWrapped&&C>0;)f=this.lines.get(--C),y.unshift(f);const T=this.ybase+this.y;if(T>=C&&T<C+y.length)continue;const O=y[y.length-1].getTrimmedLength(),P=(0,m.reflowSmallerGetNewLineLengths)(y,this._cols,r),D=P.length-y.length;let N;N=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+D):Math.max(0,this.lines.length-this.lines.maxLength+D);const X=[];for(let M=0;M<D;M++){const H=this.getBlankLine(v.DEFAULT_ATTR_DATA,!0);X.push(H)}X.length>0&&(g.push({start:C+y.length+S,newLines:X}),S+=X.length),y.push(...X);let Z=P.length-1,se=P[Z];se===0&&(Z--,se=P[Z]);let ee=y.length-D-1,E=O;for(;ee>=0;){const M=Math.min(E,se);if(y[Z]===void 0)break;if(y[Z].copyCellsFrom(y[ee],E-M,se-M,M,!0),se-=M,se===0&&(Z--,se=P[Z]),E-=M,E===0){ee--;const H=Math.max(ee,0);E=(0,m.getWrappedLineTrimmedLength)(y,H,this._cols)}}for(let M=0;M<y.length;M++)P[M]<r&&y[M].setCell(P[M],c);let A=D-N;for(;A-- >0;)this.ybase===0?this.y<n-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+S)-n&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+D,this.ybase+n-1)}if(g.length>0){const C=[],f=[];for(let Z=0;Z<this.lines.length;Z++)f.push(this.lines.get(Z));const y=this.lines.length;let T=y-1,O=0,P=g[O];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+S);let D=0;for(let Z=Math.min(this.lines.maxLength-1,y+S-1);Z>=0;Z--)if(P&&P.start>T+D){for(let se=P.newLines.length-1;se>=0;se--)this.lines.set(Z--,P.newLines[se]);Z++,C.push({index:T+1,amount:P.newLines.length}),D+=P.newLines.length,P=g[++O]}else this.lines.set(Z,f[T--]);let N=0;for(let Z=C.length-1;Z>=0;Z--)C[Z].index+=N,this.lines.onInsertEmitter.fire(C[Z]),N+=C[Z].amount;const X=Math.max(0,y+S-this.lines.maxLength);X>0&&this.lines.onTrimEmitter.fire(X)}}translateBufferLineToString(r,n,c=0,g){const S=this.lines.get(r);return S?S.translateToString(n,c,g):""}getWrappedRangeForLine(r){let n=r,c=r;for(;n>0&&this.lines.get(n).isWrapped;)n--;for(;c+1<this.lines.length&&this.lines.get(c+1).isWrapped;)c++;return{first:n,last:c}}setupTabStops(r){for(r!=null?this.tabs[r]||(r=this.prevStop(r)):(this.tabs={},r=0);r<this._cols;r+=this._optionsService.rawOptions.tabStopWidth)this.tabs[r]=!0}prevStop(r){for(r==null&&(r=this.x);!this.tabs[--r]&&r>0;);return r>=this._cols?this._cols-1:r<0?0:r}nextStop(r){for(r==null&&(r=this.x);!this.tabs[++r]&&r<this._cols;);return r>=this._cols?this._cols-1:r<0?0:r}clearMarkers(r){this._isClearing=!0;for(let n=0;n<this.markers.length;n++)this.markers[n].line===r&&(this.markers[n].dispose(),this.markers.splice(n--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let r=0;r<this.markers.length;r++)this.markers[r].dispose(),this.markers.splice(r--,1);this._isClearing=!1}addMarker(r){const n=new s.Marker(r);return this.markers.push(n),n.register(this.lines.onTrim(c=>{n.line-=c,n.line<0&&n.dispose()})),n.register(this.lines.onInsert(c=>{n.line>=c.index&&(n.line+=c.amount)})),n.register(this.lines.onDelete(c=>{n.line>=c.index&&n.line<c.index+c.amount&&n.dispose(),n.line>c.index&&(n.line-=c.amount)})),n.register(n.onDispose(()=>this._removeMarker(n))),n}_removeMarker(r){this._isClearing||this.markers.splice(this.markers.indexOf(r),1)}}},8437:(j,a,u)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.BufferLine=a.DEFAULT_ATTR_DATA=void 0;const _=u(3734),p=u(511),l=u(643),v=u(482);a.DEFAULT_ATTR_DATA=Object.freeze(new _.AttributeData);let m=0;class b{constructor(s,o,r=!1){this.isWrapped=r,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*s);const n=o||p.CellData.fromCharData([0,l.NULL_CELL_CHAR,l.NULL_CELL_WIDTH,l.NULL_CELL_CODE]);for(let c=0;c<s;++c)this.setCell(c,n);this.length=s}get(s){const o=this._data[3*s+0],r=2097151&o;return[this._data[3*s+1],2097152&o?this._combined[s]:r?(0,v.stringFromCodePoint)(r):"",o>>22,2097152&o?this._combined[s].charCodeAt(this._combined[s].length-1):r]}set(s,o){this._data[3*s+1]=o[l.CHAR_DATA_ATTR_INDEX],o[l.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[s]=o[1],this._data[3*s+0]=2097152|s|o[l.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*s+0]=o[l.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|o[l.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(s){return this._data[3*s+0]>>22}hasWidth(s){return 12582912&this._data[3*s+0]}getFg(s){return this._data[3*s+1]}getBg(s){return this._data[3*s+2]}hasContent(s){return 4194303&this._data[3*s+0]}getCodePoint(s){const o=this._data[3*s+0];return 2097152&o?this._combined[s].charCodeAt(this._combined[s].length-1):2097151&o}isCombined(s){return 2097152&this._data[3*s+0]}getString(s){const o=this._data[3*s+0];return 2097152&o?this._combined[s]:2097151&o?(0,v.stringFromCodePoint)(2097151&o):""}isProtected(s){return 536870912&this._data[3*s+2]}loadCell(s,o){return m=3*s,o.content=this._data[m+0],o.fg=this._data[m+1],o.bg=this._data[m+2],2097152&o.content&&(o.combinedData=this._combined[s]),268435456&o.bg&&(o.extended=this._extendedAttrs[s]),o}setCell(s,o){2097152&o.content&&(this._combined[s]=o.combinedData),268435456&o.bg&&(this._extendedAttrs[s]=o.extended),this._data[3*s+0]=o.content,this._data[3*s+1]=o.fg,this._data[3*s+2]=o.bg}setCellFromCodepoint(s,o,r,n){268435456&n.bg&&(this._extendedAttrs[s]=n.extended),this._data[3*s+0]=o|r<<22,this._data[3*s+1]=n.fg,this._data[3*s+2]=n.bg}addCodepointToCell(s,o,r){let n=this._data[3*s+0];2097152&n?this._combined[s]+=(0,v.stringFromCodePoint)(o):2097151&n?(this._combined[s]=(0,v.stringFromCodePoint)(2097151&n)+(0,v.stringFromCodePoint)(o),n&=-2097152,n|=2097152):n=o|4194304,r&&(n&=-12582913,n|=r<<22),this._data[3*s+0]=n}insertCells(s,o,r){if((s%=this.length)&&this.getWidth(s-1)===2&&this.setCellFromCodepoint(s-1,0,1,r),o<this.length-s){const n=new p.CellData;for(let c=this.length-s-o-1;c>=0;--c)this.setCell(s+o+c,this.loadCell(s+c,n));for(let c=0;c<o;++c)this.setCell(s+c,r)}else for(let n=s;n<this.length;++n)this.setCell(n,r);this.getWidth(this.length-1)===2&&this.setCellFromCodepoint(this.length-1,0,1,r)}deleteCells(s,o,r){if(s%=this.length,o<this.length-s){const n=new p.CellData;for(let c=0;c<this.length-s-o;++c)this.setCell(s+c,this.loadCell(s+o+c,n));for(let c=this.length-o;c<this.length;++c)this.setCell(c,r)}else for(let n=s;n<this.length;++n)this.setCell(n,r);s&&this.getWidth(s-1)===2&&this.setCellFromCodepoint(s-1,0,1,r),this.getWidth(s)!==0||this.hasContent(s)||this.setCellFromCodepoint(s,0,1,r)}replaceCells(s,o,r,n=!1){if(n)for(s&&this.getWidth(s-1)===2&&!this.isProtected(s-1)&&this.setCellFromCodepoint(s-1,0,1,r),o<this.length&&this.getWidth(o-1)===2&&!this.isProtected(o)&&this.setCellFromCodepoint(o,0,1,r);s<o&&s<this.length;)this.isProtected(s)||this.setCell(s,r),s++;else for(s&&this.getWidth(s-1)===2&&this.setCellFromCodepoint(s-1,0,1,r),o<this.length&&this.getWidth(o-1)===2&&this.setCellFromCodepoint(o,0,1,r);s<o&&s<this.length;)this.setCell(s++,r)}resize(s,o){if(s===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;const r=3*s;if(s>this.length){if(this._data.buffer.byteLength>=4*r)this._data=new Uint32Array(this._data.buffer,0,r);else{const n=new Uint32Array(r);n.set(this._data),this._data=n}for(let n=this.length;n<s;++n)this.setCell(n,o)}else{this._data=this._data.subarray(0,r);const n=Object.keys(this._combined);for(let g=0;g<n.length;g++){const S=parseInt(n[g],10);S>=s&&delete this._combined[S]}const c=Object.keys(this._extendedAttrs);for(let g=0;g<c.length;g++){const S=parseInt(c[g],10);S>=s&&delete this._extendedAttrs[S]}}return this.length=s,4*r*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){const s=new Uint32Array(this._data.length);return s.set(this._data),this._data=s,1}return 0}fill(s,o=!1){if(o)for(let r=0;r<this.length;++r)this.isProtected(r)||this.setCell(r,s);else{this._combined={},this._extendedAttrs={};for(let r=0;r<this.length;++r)this.setCell(r,s)}}copyFrom(s){this.length!==s.length?this._data=new Uint32Array(s._data):this._data.set(s._data),this.length=s.length,this._combined={};for(const o in s._combined)this._combined[o]=s._combined[o];this._extendedAttrs={};for(const o in s._extendedAttrs)this._extendedAttrs[o]=s._extendedAttrs[o];this.isWrapped=s.isWrapped}clone(){const s=new b(0);s._data=new Uint32Array(this._data),s.length=this.length;for(const o in this._combined)s._combined[o]=this._combined[o];for(const o in this._extendedAttrs)s._extendedAttrs[o]=this._extendedAttrs[o];return s.isWrapped=this.isWrapped,s}getTrimmedLength(){for(let s=this.length-1;s>=0;--s)if(4194303&this._data[3*s+0])return s+(this._data[3*s+0]>>22);return 0}getNoBgTrimmedLength(){for(let s=this.length-1;s>=0;--s)if(4194303&this._data[3*s+0]||50331648&this._data[3*s+2])return s+(this._data[3*s+0]>>22);return 0}copyCellsFrom(s,o,r,n,c){const g=s._data;if(c)for(let C=n-1;C>=0;C--){for(let f=0;f<3;f++)this._data[3*(r+C)+f]=g[3*(o+C)+f];268435456&g[3*(o+C)+2]&&(this._extendedAttrs[r+C]=s._extendedAttrs[o+C])}else for(let C=0;C<n;C++){for(let f=0;f<3;f++)this._data[3*(r+C)+f]=g[3*(o+C)+f];268435456&g[3*(o+C)+2]&&(this._extendedAttrs[r+C]=s._extendedAttrs[o+C])}const S=Object.keys(s._combined);for(let C=0;C<S.length;C++){const f=parseInt(S[C],10);f>=o&&(this._combined[f-o+r]=s._combined[f])}}translateToString(s,o,r,n){o=o??0,r=r??this.length,s&&(r=Math.min(r,this.getTrimmedLength())),n&&(n.length=0);let c="";for(;o<r;){const g=this._data[3*o+0],S=2097151&g,C=2097152&g?this._combined[o]:S?(0,v.stringFromCodePoint)(S):l.WHITESPACE_CELL_CHAR;if(c+=C,n)for(let f=0;f<C.length;++f)n.push(o);o+=g>>22||1}return n&&n.push(o),c}}a.BufferLine=b},4841:(j,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.getRangeLength=void 0,a.getRangeLength=function(u,_){if(u.start.y>u.end.y)throw new Error(`Buffer range end (${u.end.x}, ${u.end.y}) cannot be before start (${u.start.x}, ${u.start.y})`);return _*(u.end.y-u.start.y)+(u.end.x-u.start.x+1)}},4634:(j,a)=>{function u(_,p,l){if(p===_.length-1)return _[p].getTrimmedLength();const v=!_[p].hasContent(l-1)&&_[p].getWidth(l-1)===1,m=_[p+1].getWidth(0)===2;return v&&m?l-1:l}Object.defineProperty(a,"__esModule",{value:!0}),a.getWrappedLineTrimmedLength=a.reflowSmallerGetNewLineLengths=a.reflowLargerApplyNewLayout=a.reflowLargerCreateNewLayout=a.reflowLargerGetLinesToRemove=void 0,a.reflowLargerGetLinesToRemove=function(_,p,l,v,m){const b=[];for(let d=0;d<_.length-1;d++){let s=d,o=_.get(++s);if(!o.isWrapped)continue;const r=[_.get(d)];for(;s<_.length&&o.isWrapped;)r.push(o),o=_.get(++s);if(v>=d&&v<s){d+=r.length-1;continue}let n=0,c=u(r,n,p),g=1,S=0;for(;g<r.length;){const f=u(r,g,p),y=f-S,T=l-c,O=Math.min(y,T);r[n].copyCellsFrom(r[g],S,c,O,!1),c+=O,c===l&&(n++,c=0),S+=O,S===f&&(g++,S=0),c===0&&n!==0&&r[n-1].getWidth(l-1)===2&&(r[n].copyCellsFrom(r[n-1],l-1,c++,1,!1),r[n-1].setCell(l-1,m))}r[n].replaceCells(c,l,m);let C=0;for(let f=r.length-1;f>0&&(f>n||r[f].getTrimmedLength()===0);f--)C++;C>0&&(b.push(d+r.length-C),b.push(C)),d+=r.length-1}return b},a.reflowLargerCreateNewLayout=function(_,p){const l=[];let v=0,m=p[v],b=0;for(let d=0;d<_.length;d++)if(m===d){const s=p[++v];_.onDeleteEmitter.fire({index:d-b,amount:s}),d+=s-1,b+=s,m=p[++v]}else l.push(d);return{layout:l,countRemoved:b}},a.reflowLargerApplyNewLayout=function(_,p){const l=[];for(let v=0;v<p.length;v++)l.push(_.get(p[v]));for(let v=0;v<l.length;v++)_.set(v,l[v]);_.length=p.length},a.reflowSmallerGetNewLineLengths=function(_,p,l){const v=[],m=_.map((o,r)=>u(_,r,p)).reduce((o,r)=>o+r);let b=0,d=0,s=0;for(;s<m;){if(m-s<l){v.push(m-s);break}b+=l;const o=u(_,d,p);b>o&&(b-=o,d++);const r=_[d].getWidth(b-1)===2;r&&b--;const n=r?l-1:l;v.push(n),s+=n}return v},a.getWrappedLineTrimmedLength=u},5295:(j,a,u)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.BufferSet=void 0;const _=u(8460),p=u(844),l=u(9092);class v extends p.Disposable{constructor(b,d){super(),this._optionsService=b,this._bufferService=d,this._onBufferActivate=this.register(new _.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new l.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new l.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(b){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(b),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(b,d){this._normal.resize(b,d),this._alt.resize(b,d),this.setupTabStops(b)}setupTabStops(b){this._normal.setupTabStops(b),this._alt.setupTabStops(b)}}a.BufferSet=v},511:(j,a,u)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.CellData=void 0;const _=u(482),p=u(643),l=u(3734);class v extends l.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new l.ExtendedAttrs,this.combinedData=""}static fromCharData(b){const d=new v;return d.setFromCharData(b),d}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,_.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(b){this.fg=b[p.CHAR_DATA_ATTR_INDEX],this.bg=0;let d=!1;if(b[p.CHAR_DATA_CHAR_INDEX].length>2)d=!0;else if(b[p.CHAR_DATA_CHAR_INDEX].length===2){const s=b[p.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=s&&s<=56319){const o=b[p.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=o&&o<=57343?this.content=1024*(s-55296)+o-56320+65536|b[p.CHAR_DATA_WIDTH_INDEX]<<22:d=!0}else d=!0}else this.content=b[p.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|b[p.CHAR_DATA_WIDTH_INDEX]<<22;d&&(this.combinedData=b[p.CHAR_DATA_CHAR_INDEX],this.content=2097152|b[p.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}a.CellData=v},643:(j,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.WHITESPACE_CELL_CODE=a.WHITESPACE_CELL_WIDTH=a.WHITESPACE_CELL_CHAR=a.NULL_CELL_CODE=a.NULL_CELL_WIDTH=a.NULL_CELL_CHAR=a.CHAR_DATA_CODE_INDEX=a.CHAR_DATA_WIDTH_INDEX=a.CHAR_DATA_CHAR_INDEX=a.CHAR_DATA_ATTR_INDEX=a.DEFAULT_EXT=a.DEFAULT_ATTR=a.DEFAULT_COLOR=void 0,a.DEFAULT_COLOR=0,a.DEFAULT_ATTR=256|a.DEFAULT_COLOR<<9,a.DEFAULT_EXT=0,a.CHAR_DATA_ATTR_INDEX=0,a.CHAR_DATA_CHAR_INDEX=1,a.CHAR_DATA_WIDTH_INDEX=2,a.CHAR_DATA_CODE_INDEX=3,a.NULL_CELL_CHAR="",a.NULL_CELL_WIDTH=1,a.NULL_CELL_CODE=0,a.WHITESPACE_CELL_CHAR=" ",a.WHITESPACE_CELL_WIDTH=1,a.WHITESPACE_CELL_CODE=32},4863:(j,a,u)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.Marker=void 0;const _=u(8460),p=u(844);class l{get id(){return this._id}constructor(m){this.line=m,this.isDisposed=!1,this._disposables=[],this._id=l._nextId++,this._onDispose=this.register(new _.EventEmitter),this.onDispose=this._onDispose.event}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,p.disposeArray)(this._disposables),this._disposables.length=0)}register(m){return this._disposables.push(m),m}}a.Marker=l,l._nextId=1},7116:(j,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.DEFAULT_CHARSET=a.CHARSETS=void 0,a.CHARSETS={},a.DEFAULT_CHARSET=a.CHARSETS.B,a.CHARSETS[0]={"`":"â",a:"â",b:"â",c:"â",d:"â",e:"â",f:"Â°",g:"Â±",h:"â¤",i:"â",j:"â",k:"â",l:"â",m:"â",n:"â¼",o:"âº",p:"â»",q:"â",r:"â¼",s:"â½",t:"â",u:"â¤",v:"â´",w:"â¬",x:"â",y:"â¤",z:"â¥","{":"Ï","|":"â ","}":"Â£","~":"Â·"},a.CHARSETS.A={"#":"Â£"},a.CHARSETS.B=void 0,a.CHARSETS[4]={"#":"Â£","@":"Â¾","[":"ij","\\":"Â½","]":"|","{":"Â¨","|":"f","}":"Â¼","~":"Â´"},a.CHARSETS.C=a.CHARSETS[5]={"[":"Ã","\\":"Ã","]":"Ã","^":"Ã","`":"Ã©","{":"Ã¤","|":"Ã¶","}":"Ã¥","~":"Ã¼"},a.CHARSETS.R={"#":"Â£","@":"Ã ","[":"Â°","\\":"Ã§","]":"Â§","{":"Ã©","|":"Ã¹","}":"Ã¨","~":"Â¨"},a.CHARSETS.Q={"@":"Ã ","[":"Ã¢","\\":"Ã§","]":"Ãª","^":"Ã®","`":"Ã´","{":"Ã©","|":"Ã¹","}":"Ã¨","~":"Ã»"},a.CHARSETS.K={"@":"Â§","[":"Ã","\\":"Ã","]":"Ã","{":"Ã¤","|":"Ã¶","}":"Ã¼","~":"Ã"},a.CHARSETS.Y={"#":"Â£","@":"Â§","[":"Â°","\\":"Ã§","]":"Ã©","`":"Ã¹","{":"Ã ","|":"Ã²","}":"Ã¨","~":"Ã¬"},a.CHARSETS.E=a.CHARSETS[6]={"@":"Ã","[":"Ã","\\":"Ã","]":"Ã","^":"Ã","`":"Ã¤","{":"Ã¦","|":"Ã¸","}":"Ã¥","~":"Ã¼"},a.CHARSETS.Z={"#":"Â£","@":"Â§","[":"Â¡","\\":"Ã","]":"Â¿","{":"Â°","|":"Ã±","}":"Ã§"},a.CHARSETS.H=a.CHARSETS[7]={"@":"Ã","[":"Ã","\\":"Ã","]":"Ã","^":"Ã","`":"Ã©","{":"Ã¤","|":"Ã¶","}":"Ã¥","~":"Ã¼"},a.CHARSETS["="]={"#":"Ã¹","@":"Ã ","[":"Ã©","\\":"Ã§","]":"Ãª","^":"Ã®",_:"Ã¨","`":"Ã´","{":"Ã¤","|":"Ã¶","}":"Ã¼","~":"Ã»"}},2584:(j,a)=>{var u,_,p;Object.defineProperty(a,"__esModule",{value:!0}),a.C1_ESCAPED=a.C1=a.C0=void 0,function(l){l.NUL="\0",l.SOH="",l.STX="",l.ETX="",l.EOT="",l.ENQ="",l.ACK="",l.BEL="\x07",l.BS="\b",l.HT="	",l.LF=`
`,l.VT="\v",l.FF="\f",l.CR="\r",l.SO="",l.SI="",l.DLE="",l.DC1="",l.DC2="",l.DC3="",l.DC4="",l.NAK="",l.SYN="",l.ETB="",l.CAN="",l.EM="",l.SUB="",l.ESC="\x1B",l.FS="",l.GS="",l.RS="",l.US="",l.SP=" ",l.DEL=""}(u||(a.C0=u={})),function(l){l.PAD="Â",l.HOP="Â",l.BPH="Â",l.NBH="Â",l.IND="Â",l.NEL="Â",l.SSA="Â",l.ESA="Â",l.HTS="Â",l.HTJ="Â",l.VTS="Â",l.PLD="Â",l.PLU="Â",l.RI="Â",l.SS2="Â",l.SS3="Â",l.DCS="Â",l.PU1="Â",l.PU2="Â",l.STS="Â",l.CCH="Â",l.MW="Â",l.SPA="Â",l.EPA="Â",l.SOS="Â",l.SGCI="Â",l.SCI="Â",l.CSI="Â",l.ST="Â",l.OSC="Â",l.PM="Â",l.APC="Â"}(_||(a.C1=_={})),function(l){l.ST=`${u.ESC}\\`}(p||(a.C1_ESCAPED=p={}))},7399:(j,a,u)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.evaluateKeyboardEvent=void 0;const _=u(2584),p={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};a.evaluateKeyboardEvent=function(l,v,m,b){const d={type:0,cancel:!1,key:void 0},s=(l.shiftKey?1:0)|(l.altKey?2:0)|(l.ctrlKey?4:0)|(l.metaKey?8:0);switch(l.keyCode){case 0:l.key==="UIKeyInputUpArrow"?d.key=v?_.C0.ESC+"OA":_.C0.ESC+"[A":l.key==="UIKeyInputLeftArrow"?d.key=v?_.C0.ESC+"OD":_.C0.ESC+"[D":l.key==="UIKeyInputRightArrow"?d.key=v?_.C0.ESC+"OC":_.C0.ESC+"[C":l.key==="UIKeyInputDownArrow"&&(d.key=v?_.C0.ESC+"OB":_.C0.ESC+"[B");break;case 8:d.key=l.ctrlKey?"\b":_.C0.DEL,l.altKey&&(d.key=_.C0.ESC+d.key);break;case 9:if(l.shiftKey){d.key=_.C0.ESC+"[Z";break}d.key=_.C0.HT,d.cancel=!0;break;case 13:d.key=l.altKey?_.C0.ESC+_.C0.CR:_.C0.CR,d.cancel=!0;break;case 27:d.key=_.C0.ESC,l.altKey&&(d.key=_.C0.ESC+_.C0.ESC),d.cancel=!0;break;case 37:if(l.metaKey)break;s?(d.key=_.C0.ESC+"[1;"+(s+1)+"D",d.key===_.C0.ESC+"[1;3D"&&(d.key=_.C0.ESC+(m?"b":"[1;5D"))):d.key=v?_.C0.ESC+"OD":_.C0.ESC+"[D";break;case 39:if(l.metaKey)break;s?(d.key=_.C0.ESC+"[1;"+(s+1)+"C",d.key===_.C0.ESC+"[1;3C"&&(d.key=_.C0.ESC+(m?"f":"[1;5C"))):d.key=v?_.C0.ESC+"OC":_.C0.ESC+"[C";break;case 38:if(l.metaKey)break;s?(d.key=_.C0.ESC+"[1;"+(s+1)+"A",m||d.key!==_.C0.ESC+"[1;3A"||(d.key=_.C0.ESC+"[1;5A")):d.key=v?_.C0.ESC+"OA":_.C0.ESC+"[A";break;case 40:if(l.metaKey)break;s?(d.key=_.C0.ESC+"[1;"+(s+1)+"B",m||d.key!==_.C0.ESC+"[1;3B"||(d.key=_.C0.ESC+"[1;5B")):d.key=v?_.C0.ESC+"OB":_.C0.ESC+"[B";break;case 45:l.shiftKey||l.ctrlKey||(d.key=_.C0.ESC+"[2~");break;case 46:d.key=s?_.C0.ESC+"[3;"+(s+1)+"~":_.C0.ESC+"[3~";break;case 36:d.key=s?_.C0.ESC+"[1;"+(s+1)+"H":v?_.C0.ESC+"OH":_.C0.ESC+"[H";break;case 35:d.key=s?_.C0.ESC+"[1;"+(s+1)+"F":v?_.C0.ESC+"OF":_.C0.ESC+"[F";break;case 33:l.shiftKey?d.type=2:l.ctrlKey?d.key=_.C0.ESC+"[5;"+(s+1)+"~":d.key=_.C0.ESC+"[5~";break;case 34:l.shiftKey?d.type=3:l.ctrlKey?d.key=_.C0.ESC+"[6;"+(s+1)+"~":d.key=_.C0.ESC+"[6~";break;case 112:d.key=s?_.C0.ESC+"[1;"+(s+1)+"P":_.C0.ESC+"OP";break;case 113:d.key=s?_.C0.ESC+"[1;"+(s+1)+"Q":_.C0.ESC+"OQ";break;case 114:d.key=s?_.C0.ESC+"[1;"+(s+1)+"R":_.C0.ESC+"OR";break;case 115:d.key=s?_.C0.ESC+"[1;"+(s+1)+"S":_.C0.ESC+"OS";break;case 116:d.key=s?_.C0.ESC+"[15;"+(s+1)+"~":_.C0.ESC+"[15~";break;case 117:d.key=s?_.C0.ESC+"[17;"+(s+1)+"~":_.C0.ESC+"[17~";break;case 118:d.key=s?_.C0.ESC+"[18;"+(s+1)+"~":_.C0.ESC+"[18~";break;case 119:d.key=s?_.C0.ESC+"[19;"+(s+1)+"~":_.C0.ESC+"[19~";break;case 120:d.key=s?_.C0.ESC+"[20;"+(s+1)+"~":_.C0.ESC+"[20~";break;case 121:d.key=s?_.C0.ESC+"[21;"+(s+1)+"~":_.C0.ESC+"[21~";break;case 122:d.key=s?_.C0.ESC+"[23;"+(s+1)+"~":_.C0.ESC+"[23~";break;case 123:d.key=s?_.C0.ESC+"[24;"+(s+1)+"~":_.C0.ESC+"[24~";break;default:if(!l.ctrlKey||l.shiftKey||l.altKey||l.metaKey)if(m&&!b||!l.altKey||l.metaKey)!m||l.altKey||l.ctrlKey||l.shiftKey||!l.metaKey?l.key&&!l.ctrlKey&&!l.altKey&&!l.metaKey&&l.keyCode>=48&&l.key.length===1?d.key=l.key:l.key&&l.ctrlKey&&(l.key==="_"&&(d.key=_.C0.US),l.key==="@"&&(d.key=_.C0.NUL)):l.keyCode===65&&(d.type=1);else{const o=p[l.keyCode],r=o==null?void 0:o[l.shiftKey?1:0];if(r)d.key=_.C0.ESC+r;else if(l.keyCode>=65&&l.keyCode<=90){const n=l.ctrlKey?l.keyCode-64:l.keyCode+32;let c=String.fromCharCode(n);l.shiftKey&&(c=c.toUpperCase()),d.key=_.C0.ESC+c}else if(l.keyCode===32)d.key=_.C0.ESC+(l.ctrlKey?_.C0.NUL:" ");else if(l.key==="Dead"&&l.code.startsWith("Key")){let n=l.code.slice(3,4);l.shiftKey||(n=n.toLowerCase()),d.key=_.C0.ESC+n,d.cancel=!0}}else l.keyCode>=65&&l.keyCode<=90?d.key=String.fromCharCode(l.keyCode-64):l.keyCode===32?d.key=_.C0.NUL:l.keyCode>=51&&l.keyCode<=55?d.key=String.fromCharCode(l.keyCode-51+27):l.keyCode===56?d.key=_.C0.DEL:l.keyCode===219?d.key=_.C0.ESC:l.keyCode===220?d.key=_.C0.FS:l.keyCode===221&&(d.key=_.C0.GS)}return d}},482:(j,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.Utf8ToUtf32=a.StringToUtf32=a.utf32ToString=a.stringFromCodePoint=void 0,a.stringFromCodePoint=function(u){return u>65535?(u-=65536,String.fromCharCode(55296+(u>>10))+String.fromCharCode(u%1024+56320)):String.fromCharCode(u)},a.utf32ToString=function(u,_=0,p=u.length){let l="";for(let v=_;v<p;++v){let m=u[v];m>65535?(m-=65536,l+=String.fromCharCode(55296+(m>>10))+String.fromCharCode(m%1024+56320)):l+=String.fromCharCode(m)}return l},a.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(u,_){const p=u.length;if(!p)return 0;let l=0,v=0;if(this._interim){const m=u.charCodeAt(v++);56320<=m&&m<=57343?_[l++]=1024*(this._interim-55296)+m-56320+65536:(_[l++]=this._interim,_[l++]=m),this._interim=0}for(let m=v;m<p;++m){const b=u.charCodeAt(m);if(55296<=b&&b<=56319){if(++m>=p)return this._interim=b,l;const d=u.charCodeAt(m);56320<=d&&d<=57343?_[l++]=1024*(b-55296)+d-56320+65536:(_[l++]=b,_[l++]=d)}else b!==65279&&(_[l++]=b)}return l}},a.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(u,_){const p=u.length;if(!p)return 0;let l,v,m,b,d=0,s=0,o=0;if(this.interim[0]){let c=!1,g=this.interim[0];g&=(224&g)==192?31:(240&g)==224?15:7;let S,C=0;for(;(S=63&this.interim[++C])&&C<4;)g<<=6,g|=S;const f=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,y=f-C;for(;o<y;){if(o>=p)return 0;if(S=u[o++],(192&S)!=128){o--,c=!0;break}this.interim[C++]=S,g<<=6,g|=63&S}c||(f===2?g<128?o--:_[d++]=g:f===3?g<2048||g>=55296&&g<=57343||g===65279||(_[d++]=g):g<65536||g>1114111||(_[d++]=g)),this.interim.fill(0)}const r=p-4;let n=o;for(;n<p;){for(;!(!(n<r)||128&(l=u[n])||128&(v=u[n+1])||128&(m=u[n+2])||128&(b=u[n+3]));)_[d++]=l,_[d++]=v,_[d++]=m,_[d++]=b,n+=4;if(l=u[n++],l<128)_[d++]=l;else if((224&l)==192){if(n>=p)return this.interim[0]=l,d;if(v=u[n++],(192&v)!=128){n--;continue}if(s=(31&l)<<6|63&v,s<128){n--;continue}_[d++]=s}else if((240&l)==224){if(n>=p)return this.interim[0]=l,d;if(v=u[n++],(192&v)!=128){n--;continue}if(n>=p)return this.interim[0]=l,this.interim[1]=v,d;if(m=u[n++],(192&m)!=128){n--;continue}if(s=(15&l)<<12|(63&v)<<6|63&m,s<2048||s>=55296&&s<=57343||s===65279)continue;_[d++]=s}else if((248&l)==240){if(n>=p)return this.interim[0]=l,d;if(v=u[n++],(192&v)!=128){n--;continue}if(n>=p)return this.interim[0]=l,this.interim[1]=v,d;if(m=u[n++],(192&m)!=128){n--;continue}if(n>=p)return this.interim[0]=l,this.interim[1]=v,this.interim[2]=m,d;if(b=u[n++],(192&b)!=128){n--;continue}if(s=(7&l)<<18|(63&v)<<12|(63&m)<<6|63&b,s<65536||s>1114111)continue;_[d++]=s}}return d}}},225:(j,a,u)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.UnicodeV6=void 0;const _=u(1480),p=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],l=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];let v;a.UnicodeV6=class{constructor(){if(this.version="6",!v){v=new Uint8Array(65536),v.fill(1),v[0]=0,v.fill(0,1,32),v.fill(0,127,160),v.fill(2,4352,4448),v[9001]=2,v[9002]=2,v.fill(2,11904,42192),v[12351]=1,v.fill(2,44032,55204),v.fill(2,63744,64256),v.fill(2,65040,65050),v.fill(2,65072,65136),v.fill(2,65280,65377),v.fill(2,65504,65511);for(let m=0;m<p.length;++m)v.fill(0,p[m][0],p[m][1]+1)}}wcwidth(m){return m<32?0:m<127?1:m<65536?v[m]:function(b,d){let s,o=0,r=d.length-1;if(b<d[0][0]||b>d[r][1])return!1;for(;r>=o;)if(s=o+r>>1,b>d[s][1])o=s+1;else{if(!(b<d[s][0]))return!0;r=s-1}return!1}(m,l)?0:m>=131072&&m<=196605||m>=196608&&m<=262141?2:1}charProperties(m,b){let d=this.wcwidth(m),s=d===0&&b!==0;if(s){const o=_.UnicodeService.extractWidth(b);o===0?s=!1:o>d&&(d=o)}return _.UnicodeService.createPropertyValue(0,d,s)}}},5981:(j,a,u)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.WriteBuffer=void 0;const _=u(8460),p=u(844);class l extends p.Disposable{constructor(m){super(),this._action=m,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new _.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(m,b){if(b!==void 0&&this._syncCalls>b)return void(this._syncCalls=0);if(this._pendingData+=m.length,this._writeBuffer.push(m),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let d;for(this._isSyncWriting=!0;d=this._writeBuffer.shift();){this._action(d);const s=this._callbacks.shift();s&&s()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(m,b){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=m.length,this._writeBuffer.push(m),this._callbacks.push(b),void this._innerWrite();setTimeout(()=>this._innerWrite())}this._pendingData+=m.length,this._writeBuffer.push(m),this._callbacks.push(b)}_innerWrite(m=0,b=!0){const d=m||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){const s=this._writeBuffer[this._bufferOffset],o=this._action(s,b);if(o){const n=c=>Date.now()-d>=12?setTimeout(()=>this._innerWrite(0,c)):this._innerWrite(d,c);return void o.catch(c=>(queueMicrotask(()=>{throw c}),Promise.resolve(!1))).then(n)}const r=this._callbacks[this._bufferOffset];if(r&&r(),this._bufferOffset++,this._pendingData-=s.length,Date.now()-d>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}a.WriteBuffer=l},5941:(j,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.toRgbString=a.parseColor=void 0;const u=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,_=/^[\da-f]+$/;function p(l,v){const m=l.toString(16),b=m.length<2?"0"+m:m;switch(v){case 4:return m[0];case 8:return b;case 12:return(b+b).slice(0,3);default:return b+b}}a.parseColor=function(l){if(!l)return;let v=l.toLowerCase();if(v.indexOf("rgb:")===0){v=v.slice(4);const m=u.exec(v);if(m){const b=m[1]?15:m[4]?255:m[7]?4095:65535;return[Math.round(parseInt(m[1]||m[4]||m[7]||m[10],16)/b*255),Math.round(parseInt(m[2]||m[5]||m[8]||m[11],16)/b*255),Math.round(parseInt(m[3]||m[6]||m[9]||m[12],16)/b*255)]}}else if(v.indexOf("#")===0&&(v=v.slice(1),_.exec(v)&&[3,6,9,12].includes(v.length))){const m=v.length/3,b=[0,0,0];for(let d=0;d<3;++d){const s=parseInt(v.slice(m*d,m*d+m),16);b[d]=m===1?s<<4:m===2?s:m===3?s>>4:s>>8}return b}},a.toRgbString=function(l,v=16){const[m,b,d]=l;return`rgb:${p(m,v)}/${p(b,v)}/${p(d,v)}`}},5770:(j,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.PAYLOAD_LIMIT=void 0,a.PAYLOAD_LIMIT=1e7},6351:(j,a,u)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.DcsHandler=a.DcsParser=void 0;const _=u(482),p=u(8742),l=u(5770),v=[];a.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=v,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=v}registerHandler(b,d){this._handlers[b]===void 0&&(this._handlers[b]=[]);const s=this._handlers[b];return s.push(d),{dispose:()=>{const o=s.indexOf(d);o!==-1&&s.splice(o,1)}}}clearHandler(b){this._handlers[b]&&delete this._handlers[b]}setHandlerFallback(b){this._handlerFb=b}reset(){if(this._active.length)for(let b=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;b>=0;--b)this._active[b].unhook(!1);this._stack.paused=!1,this._active=v,this._ident=0}hook(b,d){if(this.reset(),this._ident=b,this._active=this._handlers[b]||v,this._active.length)for(let s=this._active.length-1;s>=0;s--)this._active[s].hook(d);else this._handlerFb(this._ident,"HOOK",d)}put(b,d,s){if(this._active.length)for(let o=this._active.length-1;o>=0;o--)this._active[o].put(b,d,s);else this._handlerFb(this._ident,"PUT",(0,_.utf32ToString)(b,d,s))}unhook(b,d=!0){if(this._active.length){let s=!1,o=this._active.length-1,r=!1;if(this._stack.paused&&(o=this._stack.loopPosition-1,s=d,r=this._stack.fallThrough,this._stack.paused=!1),!r&&s===!1){for(;o>=0&&(s=this._active[o].unhook(b),s!==!0);o--)if(s instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=o,this._stack.fallThrough=!1,s;o--}for(;o>=0;o--)if(s=this._active[o].unhook(!1),s instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=o,this._stack.fallThrough=!0,s}else this._handlerFb(this._ident,"UNHOOK",b);this._active=v,this._ident=0}};const m=new p.Params;m.addParam(0),a.DcsHandler=class{constructor(b){this._handler=b,this._data="",this._params=m,this._hitLimit=!1}hook(b){this._params=b.length>1||b.params[0]?b.clone():m,this._data="",this._hitLimit=!1}put(b,d,s){this._hitLimit||(this._data+=(0,_.utf32ToString)(b,d,s),this._data.length>l.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(b){let d=!1;if(this._hitLimit)d=!1;else if(b&&(d=this._handler(this._data,this._params),d instanceof Promise))return d.then(s=>(this._params=m,this._data="",this._hitLimit=!1,s));return this._params=m,this._data="",this._hitLimit=!1,d}}},2015:(j,a,u)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.EscapeSequenceParser=a.VT500_TRANSITION_TABLE=a.TransitionTable=void 0;const _=u(844),p=u(8742),l=u(6242),v=u(6351);class m{constructor(o){this.table=new Uint8Array(o)}setDefault(o,r){this.table.fill(o<<4|r)}add(o,r,n,c){this.table[r<<8|o]=n<<4|c}addMany(o,r,n,c){for(let g=0;g<o.length;g++)this.table[r<<8|o[g]]=n<<4|c}}a.TransitionTable=m;const b=160;a.VT500_TRANSITION_TABLE=function(){const s=new m(4095),o=Array.apply(null,Array(256)).map((C,f)=>f),r=(C,f)=>o.slice(C,f),n=r(32,127),c=r(0,24);c.push(25),c.push.apply(c,r(28,32));const g=r(0,14);let S;for(S in s.setDefault(1,0),s.addMany(n,0,2,0),g)s.addMany([24,26,153,154],S,3,0),s.addMany(r(128,144),S,3,0),s.addMany(r(144,152),S,3,0),s.add(156,S,0,0),s.add(27,S,11,1),s.add(157,S,4,8),s.addMany([152,158,159],S,0,7),s.add(155,S,11,3),s.add(144,S,11,9);return s.addMany(c,0,3,0),s.addMany(c,1,3,1),s.add(127,1,0,1),s.addMany(c,8,0,8),s.addMany(c,3,3,3),s.add(127,3,0,3),s.addMany(c,4,3,4),s.add(127,4,0,4),s.addMany(c,6,3,6),s.addMany(c,5,3,5),s.add(127,5,0,5),s.addMany(c,2,3,2),s.add(127,2,0,2),s.add(93,1,4,8),s.addMany(n,8,5,8),s.add(127,8,5,8),s.addMany([156,27,24,26,7],8,6,0),s.addMany(r(28,32),8,0,8),s.addMany([88,94,95],1,0,7),s.addMany(n,7,0,7),s.addMany(c,7,0,7),s.add(156,7,0,0),s.add(127,7,0,7),s.add(91,1,11,3),s.addMany(r(64,127),3,7,0),s.addMany(r(48,60),3,8,4),s.addMany([60,61,62,63],3,9,4),s.addMany(r(48,60),4,8,4),s.addMany(r(64,127),4,7,0),s.addMany([60,61,62,63],4,0,6),s.addMany(r(32,64),6,0,6),s.add(127,6,0,6),s.addMany(r(64,127),6,0,0),s.addMany(r(32,48),3,9,5),s.addMany(r(32,48),5,9,5),s.addMany(r(48,64),5,0,6),s.addMany(r(64,127),5,7,0),s.addMany(r(32,48),4,9,5),s.addMany(r(32,48),1,9,2),s.addMany(r(32,48),2,9,2),s.addMany(r(48,127),2,10,0),s.addMany(r(48,80),1,10,0),s.addMany(r(81,88),1,10,0),s.addMany([89,90,92],1,10,0),s.addMany(r(96,127),1,10,0),s.add(80,1,11,9),s.addMany(c,9,0,9),s.add(127,9,0,9),s.addMany(r(28,32),9,0,9),s.addMany(r(32,48),9,9,12),s.addMany(r(48,60),9,8,10),s.addMany([60,61,62,63],9,9,10),s.addMany(c,11,0,11),s.addMany(r(32,128),11,0,11),s.addMany(r(28,32),11,0,11),s.addMany(c,10,0,10),s.add(127,10,0,10),s.addMany(r(28,32),10,0,10),s.addMany(r(48,60),10,8,10),s.addMany([60,61,62,63],10,0,11),s.addMany(r(32,48),10,9,12),s.addMany(c,12,0,12),s.add(127,12,0,12),s.addMany(r(28,32),12,0,12),s.addMany(r(32,48),12,9,12),s.addMany(r(48,64),12,0,11),s.addMany(r(64,127),12,12,13),s.addMany(r(64,127),10,12,13),s.addMany(r(64,127),9,12,13),s.addMany(c,13,13,13),s.addMany(n,13,13,13),s.add(127,13,0,13),s.addMany([27,156,24,26],13,14,0),s.add(b,0,2,0),s.add(b,8,5,8),s.add(b,6,0,6),s.add(b,11,0,11),s.add(b,13,13,13),s}();class d extends _.Disposable{constructor(o=a.VT500_TRANSITION_TABLE){super(),this._transitions=o,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new p.Params,this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._printHandlerFb=(r,n,c)=>{},this._executeHandlerFb=r=>{},this._csiHandlerFb=(r,n)=>{},this._escHandlerFb=r=>{},this._errorHandlerFb=r=>r,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,_.toDisposable)(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this.register(new l.OscParser),this._dcsParser=this.register(new v.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(o,r=[64,126]){let n=0;if(o.prefix){if(o.prefix.length>1)throw new Error("only one byte as prefix supported");if(n=o.prefix.charCodeAt(0),n&&60>n||n>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(o.intermediates){if(o.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let g=0;g<o.intermediates.length;++g){const S=o.intermediates.charCodeAt(g);if(32>S||S>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");n<<=8,n|=S}}if(o.final.length!==1)throw new Error("final must be a single byte");const c=o.final.charCodeAt(0);if(r[0]>c||c>r[1])throw new Error(`final must be in range ${r[0]} .. ${r[1]}`);return n<<=8,n|=c,n}identToString(o){const r=[];for(;o;)r.push(String.fromCharCode(255&o)),o>>=8;return r.reverse().join("")}setPrintHandler(o){this._printHandler=o}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(o,r){const n=this._identifier(o,[48,126]);this._escHandlers[n]===void 0&&(this._escHandlers[n]=[]);const c=this._escHandlers[n];return c.push(r),{dispose:()=>{const g=c.indexOf(r);g!==-1&&c.splice(g,1)}}}clearEscHandler(o){this._escHandlers[this._identifier(o,[48,126])]&&delete this._escHandlers[this._identifier(o,[48,126])]}setEscHandlerFallback(o){this._escHandlerFb=o}setExecuteHandler(o,r){this._executeHandlers[o.charCodeAt(0)]=r}clearExecuteHandler(o){this._executeHandlers[o.charCodeAt(0)]&&delete this._executeHandlers[o.charCodeAt(0)]}setExecuteHandlerFallback(o){this._executeHandlerFb=o}registerCsiHandler(o,r){const n=this._identifier(o);this._csiHandlers[n]===void 0&&(this._csiHandlers[n]=[]);const c=this._csiHandlers[n];return c.push(r),{dispose:()=>{const g=c.indexOf(r);g!==-1&&c.splice(g,1)}}}clearCsiHandler(o){this._csiHandlers[this._identifier(o)]&&delete this._csiHandlers[this._identifier(o)]}setCsiHandlerFallback(o){this._csiHandlerFb=o}registerDcsHandler(o,r){return this._dcsParser.registerHandler(this._identifier(o),r)}clearDcsHandler(o){this._dcsParser.clearHandler(this._identifier(o))}setDcsHandlerFallback(o){this._dcsParser.setHandlerFallback(o)}registerOscHandler(o,r){return this._oscParser.registerHandler(o,r)}clearOscHandler(o){this._oscParser.clearHandler(o)}setOscHandlerFallback(o){this._oscParser.setHandlerFallback(o)}setErrorHandler(o){this._errorHandler=o}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(o,r,n,c,g){this._parseStack.state=o,this._parseStack.handlers=r,this._parseStack.handlerPos=n,this._parseStack.transition=c,this._parseStack.chunkPos=g}parse(o,r,n){let c,g=0,S=0,C=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,C=this._parseStack.chunkPos+1;else{if(n===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");const f=this._parseStack.handlers;let y=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(n===!1&&y>-1){for(;y>=0&&(c=f[y](this._params),c!==!0);y--)if(c instanceof Promise)return this._parseStack.handlerPos=y,c}this._parseStack.handlers=[];break;case 4:if(n===!1&&y>-1){for(;y>=0&&(c=f[y](),c!==!0);y--)if(c instanceof Promise)return this._parseStack.handlerPos=y,c}this._parseStack.handlers=[];break;case 6:if(g=o[this._parseStack.chunkPos],c=this._dcsParser.unhook(g!==24&&g!==26,n),c)return c;g===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(g=o[this._parseStack.chunkPos],c=this._oscParser.end(g!==24&&g!==26,n),c)return c;g===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,C=this._parseStack.chunkPos+1,this.precedingJoinState=0,this.currentState=15&this._parseStack.transition}for(let f=C;f<r;++f){switch(g=o[f],S=this._transitions.table[this.currentState<<8|(g<160?g:b)],S>>4){case 2:for(let D=f+1;;++D){if(D>=r||(g=o[D])<32||g>126&&g<b){this._printHandler(o,f,D),f=D-1;break}if(++D>=r||(g=o[D])<32||g>126&&g<b){this._printHandler(o,f,D),f=D-1;break}if(++D>=r||(g=o[D])<32||g>126&&g<b){this._printHandler(o,f,D),f=D-1;break}if(++D>=r||(g=o[D])<32||g>126&&g<b){this._printHandler(o,f,D),f=D-1;break}}break;case 3:this._executeHandlers[g]?this._executeHandlers[g]():this._executeHandlerFb(g),this.precedingJoinState=0;break;case 0:break;case 1:if(this._errorHandler({position:f,code:g,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:const y=this._csiHandlers[this._collect<<8|g];let T=y?y.length-1:-1;for(;T>=0&&(c=y[T](this._params),c!==!0);T--)if(c instanceof Promise)return this._preserveStack(3,y,T,S,f),c;T<0&&this._csiHandlerFb(this._collect<<8|g,this._params),this.precedingJoinState=0;break;case 8:do switch(g){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(g-48)}while(++f<r&&(g=o[f])>47&&g<60);f--;break;case 9:this._collect<<=8,this._collect|=g;break;case 10:const O=this._escHandlers[this._collect<<8|g];let P=O?O.length-1:-1;for(;P>=0&&(c=O[P](),c!==!0);P--)if(c instanceof Promise)return this._preserveStack(4,O,P,S,f),c;P<0&&this._escHandlerFb(this._collect<<8|g),this.precedingJoinState=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|g,this._params);break;case 13:for(let D=f+1;;++D)if(D>=r||(g=o[D])===24||g===26||g===27||g>127&&g<b){this._dcsParser.put(o,f,D),f=D-1;break}break;case 14:if(c=this._dcsParser.unhook(g!==24&&g!==26),c)return this._preserveStack(6,[],0,S,f),c;g===27&&(S|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0;break;case 4:this._oscParser.start();break;case 5:for(let D=f+1;;D++)if(D>=r||(g=o[D])<32||g>127&&g<b){this._oscParser.put(o,f,D),f=D-1;break}break;case 6:if(c=this._oscParser.end(g!==24&&g!==26),c)return this._preserveStack(5,[],0,S,f),c;g===27&&(S|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0}this.currentState=15&S}}}a.EscapeSequenceParser=d},6242:(j,a,u)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.OscHandler=a.OscParser=void 0;const _=u(5770),p=u(482),l=[];a.OscParser=class{constructor(){this._state=0,this._active=l,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(v,m){this._handlers[v]===void 0&&(this._handlers[v]=[]);const b=this._handlers[v];return b.push(m),{dispose:()=>{const d=b.indexOf(m);d!==-1&&b.splice(d,1)}}}clearHandler(v){this._handlers[v]&&delete this._handlers[v]}setHandlerFallback(v){this._handlerFb=v}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=l}reset(){if(this._state===2)for(let v=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;v>=0;--v)this._active[v].end(!1);this._stack.paused=!1,this._active=l,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||l,this._active.length)for(let v=this._active.length-1;v>=0;v--)this._active[v].start();else this._handlerFb(this._id,"START")}_put(v,m,b){if(this._active.length)for(let d=this._active.length-1;d>=0;d--)this._active[d].put(v,m,b);else this._handlerFb(this._id,"PUT",(0,p.utf32ToString)(v,m,b))}start(){this.reset(),this._state=1}put(v,m,b){if(this._state!==3){if(this._state===1)for(;m<b;){const d=v[m++];if(d===59){this._state=2,this._start();break}if(d<48||57<d)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+d-48}this._state===2&&b-m>0&&this._put(v,m,b)}}end(v,m=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let b=!1,d=this._active.length-1,s=!1;if(this._stack.paused&&(d=this._stack.loopPosition-1,b=m,s=this._stack.fallThrough,this._stack.paused=!1),!s&&b===!1){for(;d>=0&&(b=this._active[d].end(v),b!==!0);d--)if(b instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=d,this._stack.fallThrough=!1,b;d--}for(;d>=0;d--)if(b=this._active[d].end(!1),b instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=d,this._stack.fallThrough=!0,b}else this._handlerFb(this._id,"END",v);this._active=l,this._id=-1,this._state=0}}},a.OscHandler=class{constructor(v){this._handler=v,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(v,m,b){this._hitLimit||(this._data+=(0,p.utf32ToString)(v,m,b),this._data.length>_.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(v){let m=!1;if(this._hitLimit)m=!1;else if(v&&(m=this._handler(this._data),m instanceof Promise))return m.then(b=>(this._data="",this._hitLimit=!1,b));return this._data="",this._hitLimit=!1,m}}},8742:(j,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.Params=void 0;const u=2147483647;class _{static fromArray(l){const v=new _;if(!l.length)return v;for(let m=Array.isArray(l[0])?1:0;m<l.length;++m){const b=l[m];if(Array.isArray(b))for(let d=0;d<b.length;++d)v.addSubParam(b[d]);else v.addParam(b)}return v}constructor(l=32,v=32){if(this.maxLength=l,this.maxSubParamsLength=v,v>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(l),this.length=0,this._subParams=new Int32Array(v),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(l),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}clone(){const l=new _(this.maxLength,this.maxSubParamsLength);return l.params.set(this.params),l.length=this.length,l._subParams.set(this._subParams),l._subParamsLength=this._subParamsLength,l._subParamsIdx.set(this._subParamsIdx),l._rejectDigits=this._rejectDigits,l._rejectSubDigits=this._rejectSubDigits,l._digitIsSub=this._digitIsSub,l}toArray(){const l=[];for(let v=0;v<this.length;++v){l.push(this.params[v]);const m=this._subParamsIdx[v]>>8,b=255&this._subParamsIdx[v];b-m>0&&l.push(Array.prototype.slice.call(this._subParams,m,b))}return l}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(l){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(l<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=l>u?u:l}}addSubParam(l){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(l<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=l>u?u:l,this._subParamsIdx[this.length-1]++}}hasSubParams(l){return(255&this._subParamsIdx[l])-(this._subParamsIdx[l]>>8)>0}getSubParams(l){const v=this._subParamsIdx[l]>>8,m=255&this._subParamsIdx[l];return m-v>0?this._subParams.subarray(v,m):null}getSubParamsAll(){const l={};for(let v=0;v<this.length;++v){const m=this._subParamsIdx[v]>>8,b=255&this._subParamsIdx[v];b-m>0&&(l[v]=this._subParams.slice(m,b))}return l}addDigit(l){let v;if(this._rejectDigits||!(v=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;const m=this._digitIsSub?this._subParams:this.params,b=m[v-1];m[v-1]=~b?Math.min(10*b+l,u):l}}a.Params=_},5741:(j,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.AddonManager=void 0,a.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let u=this._addons.length-1;u>=0;u--)this._addons[u].instance.dispose()}loadAddon(u,_){const p={instance:_,dispose:_.dispose,isDisposed:!1};this._addons.push(p),_.dispose=()=>this._wrappedAddonDispose(p),_.activate(u)}_wrappedAddonDispose(u){if(u.isDisposed)return;let _=-1;for(let p=0;p<this._addons.length;p++)if(this._addons[p]===u){_=p;break}if(_===-1)throw new Error("Could not dispose an addon that has not been loaded");u.isDisposed=!0,u.dispose.apply(u.instance),this._addons.splice(_,1)}}},8771:(j,a,u)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.BufferApiView=void 0;const _=u(3785),p=u(511);a.BufferApiView=class{constructor(l,v){this._buffer=l,this.type=v}init(l){return this._buffer=l,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(l){const v=this._buffer.lines.get(l);if(v)return new _.BufferLineApiView(v)}getNullCell(){return new p.CellData}}},3785:(j,a,u)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.BufferLineApiView=void 0;const _=u(511);a.BufferLineApiView=class{constructor(p){this._line=p}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(p,l){if(!(p<0||p>=this._line.length))return l?(this._line.loadCell(p,l),l):this._line.loadCell(p,new _.CellData)}translateToString(p,l,v){return this._line.translateToString(p,l,v)}}},8285:(j,a,u)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.BufferNamespaceApi=void 0;const _=u(8771),p=u(8460),l=u(844);class v extends l.Disposable{constructor(b){super(),this._core=b,this._onBufferChange=this.register(new p.EventEmitter),this.onBufferChange=this._onBufferChange.event,this._normal=new _.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new _.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}a.BufferNamespaceApi=v},7975:(j,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.ParserApi=void 0,a.ParserApi=class{constructor(u){this._core=u}registerCsiHandler(u,_){return this._core.registerCsiHandler(u,p=>_(p.toArray()))}addCsiHandler(u,_){return this.registerCsiHandler(u,_)}registerDcsHandler(u,_){return this._core.registerDcsHandler(u,(p,l)=>_(p,l.toArray()))}addDcsHandler(u,_){return this.registerDcsHandler(u,_)}registerEscHandler(u,_){return this._core.registerEscHandler(u,_)}addEscHandler(u,_){return this.registerEscHandler(u,_)}registerOscHandler(u,_){return this._core.registerOscHandler(u,_)}addOscHandler(u,_){return this.registerOscHandler(u,_)}}},7090:(j,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.UnicodeApi=void 0,a.UnicodeApi=class{constructor(u){this._core=u}register(u){this._core.unicodeService.register(u)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(u){this._core.unicodeService.activeVersion=u}}},744:function(j,a,u){var _=this&&this.__decorate||function(s,o,r,n){var c,g=arguments.length,S=g<3?o:n===null?n=Object.getOwnPropertyDescriptor(o,r):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(s,o,r,n);else for(var C=s.length-1;C>=0;C--)(c=s[C])&&(S=(g<3?c(S):g>3?c(o,r,S):c(o,r))||S);return g>3&&S&&Object.defineProperty(o,r,S),S},p=this&&this.__param||function(s,o){return function(r,n){o(r,n,s)}};Object.defineProperty(a,"__esModule",{value:!0}),a.BufferService=a.MINIMUM_ROWS=a.MINIMUM_COLS=void 0;const l=u(8460),v=u(844),m=u(5295),b=u(2585);a.MINIMUM_COLS=2,a.MINIMUM_ROWS=1;let d=a.BufferService=class extends v.Disposable{get buffer(){return this.buffers.active}constructor(s){super(),this.isUserScrolling=!1,this._onResize=this.register(new l.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new l.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(s.rawOptions.cols||0,a.MINIMUM_COLS),this.rows=Math.max(s.rawOptions.rows||0,a.MINIMUM_ROWS),this.buffers=this.register(new m.BufferSet(s,this))}resize(s,o){this.cols=s,this.rows=o,this.buffers.resize(s,o),this._onResize.fire({cols:s,rows:o})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(s,o=!1){const r=this.buffer;let n;n=this._cachedBlankLine,n&&n.length===this.cols&&n.getFg(0)===s.fg&&n.getBg(0)===s.bg||(n=r.getBlankLine(s,o),this._cachedBlankLine=n),n.isWrapped=o;const c=r.ybase+r.scrollTop,g=r.ybase+r.scrollBottom;if(r.scrollTop===0){const S=r.lines.isFull;g===r.lines.length-1?S?r.lines.recycle().copyFrom(n):r.lines.push(n.clone()):r.lines.splice(g+1,0,n.clone()),S?this.isUserScrolling&&(r.ydisp=Math.max(r.ydisp-1,0)):(r.ybase++,this.isUserScrolling||r.ydisp++)}else{const S=g-c+1;r.lines.shiftElements(c+1,S-1,-1),r.lines.set(g,n.clone())}this.isUserScrolling||(r.ydisp=r.ybase),this._onScroll.fire(r.ydisp)}scrollLines(s,o,r){const n=this.buffer;if(s<0){if(n.ydisp===0)return;this.isUserScrolling=!0}else s+n.ydisp>=n.ybase&&(this.isUserScrolling=!1);const c=n.ydisp;n.ydisp=Math.max(Math.min(n.ydisp+s,n.ybase),0),c!==n.ydisp&&(o||this._onScroll.fire(n.ydisp))}};a.BufferService=d=_([p(0,b.IOptionsService)],d)},7994:(j,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.CharsetService=void 0,a.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(u){this.glevel=u,this.charset=this._charsets[u]}setgCharset(u,_){this._charsets[u]=_,this.glevel===u&&(this.charset=_)}}},1753:function(j,a,u){var _=this&&this.__decorate||function(n,c,g,S){var C,f=arguments.length,y=f<3?c:S===null?S=Object.getOwnPropertyDescriptor(c,g):S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(n,c,g,S);else for(var T=n.length-1;T>=0;T--)(C=n[T])&&(y=(f<3?C(y):f>3?C(c,g,y):C(c,g))||y);return f>3&&y&&Object.defineProperty(c,g,y),y},p=this&&this.__param||function(n,c){return function(g,S){c(g,S,n)}};Object.defineProperty(a,"__esModule",{value:!0}),a.CoreMouseService=void 0;const l=u(2585),v=u(8460),m=u(844),b={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:n=>n.button!==4&&n.action===1&&(n.ctrl=!1,n.alt=!1,n.shift=!1,!0)},VT200:{events:19,restrict:n=>n.action!==32},DRAG:{events:23,restrict:n=>n.action!==32||n.button!==3},ANY:{events:31,restrict:n=>!0}};function d(n,c){let g=(n.ctrl?16:0)|(n.shift?4:0)|(n.alt?8:0);return n.button===4?(g|=64,g|=n.action):(g|=3&n.button,4&n.button&&(g|=64),8&n.button&&(g|=128),n.action===32?g|=32:n.action!==0||c||(g|=3)),g}const s=String.fromCharCode,o={DEFAULT:n=>{const c=[d(n,!1)+32,n.col+32,n.row+32];return c[0]>255||c[1]>255||c[2]>255?"":`\x1B[M${s(c[0])}${s(c[1])}${s(c[2])}`},SGR:n=>{const c=n.action===0&&n.button!==4?"m":"M";return`\x1B[<${d(n,!0)};${n.col};${n.row}${c}`},SGR_PIXELS:n=>{const c=n.action===0&&n.button!==4?"m":"M";return`\x1B[<${d(n,!0)};${n.x};${n.y}${c}`}};let r=a.CoreMouseService=class extends m.Disposable{constructor(n,c){super(),this._bufferService=n,this._coreService=c,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new v.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(const g of Object.keys(b))this.addProtocol(g,b[g]);for(const g of Object.keys(o))this.addEncoding(g,o[g]);this.reset()}addProtocol(n,c){this._protocols[n]=c}addEncoding(n,c){this._encodings[n]=c}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(n){if(!this._protocols[n])throw new Error(`unknown protocol "${n}"`);this._activeProtocol=n,this._onProtocolChange.fire(this._protocols[n].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(n){if(!this._encodings[n])throw new Error(`unknown encoding "${n}"`);this._activeEncoding=n}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(n){if(n.col<0||n.col>=this._bufferService.cols||n.row<0||n.row>=this._bufferService.rows||n.button===4&&n.action===32||n.button===3&&n.action!==32||n.button!==4&&(n.action===2||n.action===3)||(n.col++,n.row++,n.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,n,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(n))return!1;const c=this._encodings[this._activeEncoding](n);return c&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(c):this._coreService.triggerDataEvent(c,!0)),this._lastEvent=n,!0}explainEvents(n){return{down:!!(1&n),up:!!(2&n),drag:!!(4&n),move:!!(8&n),wheel:!!(16&n)}}_equalEvents(n,c,g){if(g){if(n.x!==c.x||n.y!==c.y)return!1}else if(n.col!==c.col||n.row!==c.row)return!1;return n.button===c.button&&n.action===c.action&&n.ctrl===c.ctrl&&n.alt===c.alt&&n.shift===c.shift}};a.CoreMouseService=r=_([p(0,l.IBufferService),p(1,l.ICoreService)],r)},6975:function(j,a,u){var _=this&&this.__decorate||function(r,n,c,g){var S,C=arguments.length,f=C<3?n:g===null?g=Object.getOwnPropertyDescriptor(n,c):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(r,n,c,g);else for(var y=r.length-1;y>=0;y--)(S=r[y])&&(f=(C<3?S(f):C>3?S(n,c,f):S(n,c))||f);return C>3&&f&&Object.defineProperty(n,c,f),f},p=this&&this.__param||function(r,n){return function(c,g){n(c,g,r)}};Object.defineProperty(a,"__esModule",{value:!0}),a.CoreService=void 0;const l=u(1439),v=u(8460),m=u(844),b=u(2585),d=Object.freeze({insertMode:!1}),s=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0});let o=a.CoreService=class extends m.Disposable{constructor(r,n,c){super(),this._bufferService=r,this._logService=n,this._optionsService=c,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new v.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new v.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new v.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new v.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,l.clone)(d),this.decPrivateModes=(0,l.clone)(s)}reset(){this.modes=(0,l.clone)(d),this.decPrivateModes=(0,l.clone)(s)}triggerDataEvent(r,n=!1){if(this._optionsService.rawOptions.disableStdin)return;const c=this._bufferService.buffer;n&&this._optionsService.rawOptions.scrollOnUserInput&&c.ybase!==c.ydisp&&this._onRequestScrollToBottom.fire(),n&&this._onUserInput.fire(),this._logService.debug(`sending data "${r}"`,()=>r.split("").map(g=>g.charCodeAt(0))),this._onData.fire(r)}triggerBinaryEvent(r){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${r}"`,()=>r.split("").map(n=>n.charCodeAt(0))),this._onBinary.fire(r))}};a.CoreService=o=_([p(0,b.IBufferService),p(1,b.ILogService),p(2,b.IOptionsService)],o)},9074:(j,a,u)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.DecorationService=void 0;const _=u(8055),p=u(8460),l=u(844),v=u(6106);let m=0,b=0;class d extends l.Disposable{get decorations(){return this._decorations.values()}constructor(){super(),this._decorations=new v.SortedList(r=>r==null?void 0:r.marker.line),this._onDecorationRegistered=this.register(new p.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new p.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,l.toDisposable)(()=>this.reset()))}registerDecoration(r){if(r.marker.isDisposed)return;const n=new s(r);if(n){const c=n.marker.onDispose(()=>n.dispose());n.onDispose(()=>{n&&(this._decorations.delete(n)&&this._onDecorationRemoved.fire(n),c.dispose())}),this._decorations.insert(n),this._onDecorationRegistered.fire(n)}return n}reset(){for(const r of this._decorations.values())r.dispose();this._decorations.clear()}*getDecorationsAtCell(r,n,c){let g=0,S=0;for(const C of this._decorations.getKeyIterator(n))g=C.options.x??0,S=g+(C.options.width??1),r>=g&&r<S&&(!c||(C.options.layer??"bottom")===c)&&(yield C)}forEachDecorationAtCell(r,n,c,g){this._decorations.forEachByKey(n,S=>{m=S.options.x??0,b=m+(S.options.width??1),r>=m&&r<b&&(!c||(S.options.layer??"bottom")===c)&&g(S)})}}a.DecorationService=d;class s extends l.Disposable{get isDisposed(){return this._isDisposed}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=_.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=_.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}constructor(r){super(),this.options=r,this.onRenderEmitter=this.register(new p.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new p.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=r.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(j,a,u)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.InstantiationService=a.ServiceCollection=void 0;const _=u(2585),p=u(8343);class l{constructor(...m){this._entries=new Map;for(const[b,d]of m)this.set(b,d)}set(m,b){const d=this._entries.get(m);return this._entries.set(m,b),d}forEach(m){for(const[b,d]of this._entries.entries())m(b,d)}has(m){return this._entries.has(m)}get(m){return this._entries.get(m)}}a.ServiceCollection=l,a.InstantiationService=class{constructor(){this._services=new l,this._services.set(_.IInstantiationService,this)}setService(v,m){this._services.set(v,m)}getService(v){return this._services.get(v)}createInstance(v,...m){const b=(0,p.getServiceDependencies)(v).sort((o,r)=>o.index-r.index),d=[];for(const o of b){const r=this._services.get(o.id);if(!r)throw new Error(`[createInstance] ${v.name} depends on UNKNOWN service ${o.id}.`);d.push(r)}const s=b.length>0?b[0].index:m.length;if(m.length!==s)throw new Error(`[createInstance] First service dependency of ${v.name} at position ${s+1} conflicts with ${m.length} static arguments`);return new v(...m,...d)}}},7866:function(j,a,u){var _=this&&this.__decorate||function(s,o,r,n){var c,g=arguments.length,S=g<3?o:n===null?n=Object.getOwnPropertyDescriptor(o,r):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(s,o,r,n);else for(var C=s.length-1;C>=0;C--)(c=s[C])&&(S=(g<3?c(S):g>3?c(o,r,S):c(o,r))||S);return g>3&&S&&Object.defineProperty(o,r,S),S},p=this&&this.__param||function(s,o){return function(r,n){o(r,n,s)}};Object.defineProperty(a,"__esModule",{value:!0}),a.traceCall=a.setTraceLogger=a.LogService=void 0;const l=u(844),v=u(2585),m={trace:v.LogLevelEnum.TRACE,debug:v.LogLevelEnum.DEBUG,info:v.LogLevelEnum.INFO,warn:v.LogLevelEnum.WARN,error:v.LogLevelEnum.ERROR,off:v.LogLevelEnum.OFF};let b,d=a.LogService=class extends l.Disposable{get logLevel(){return this._logLevel}constructor(s){super(),this._optionsService=s,this._logLevel=v.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel())),b=this}_updateLogLevel(){this._logLevel=m[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(s){for(let o=0;o<s.length;o++)typeof s[o]=="function"&&(s[o]=s[o]())}_log(s,o,r){this._evalLazyOptionalParams(r),s.call(console,(this._optionsService.options.logger?"":"xterm.js: ")+o,...r)}trace(s,...o){var r;this._logLevel<=v.LogLevelEnum.TRACE&&this._log(((r=this._optionsService.options.logger)==null?void 0:r.trace.bind(this._optionsService.options.logger))??console.log,s,o)}debug(s,...o){var r;this._logLevel<=v.LogLevelEnum.DEBUG&&this._log(((r=this._optionsService.options.logger)==null?void 0:r.debug.bind(this._optionsService.options.logger))??console.log,s,o)}info(s,...o){var r;this._logLevel<=v.LogLevelEnum.INFO&&this._log(((r=this._optionsService.options.logger)==null?void 0:r.info.bind(this._optionsService.options.logger))??console.info,s,o)}warn(s,...o){var r;this._logLevel<=v.LogLevelEnum.WARN&&this._log(((r=this._optionsService.options.logger)==null?void 0:r.warn.bind(this._optionsService.options.logger))??console.warn,s,o)}error(s,...o){var r;this._logLevel<=v.LogLevelEnum.ERROR&&this._log(((r=this._optionsService.options.logger)==null?void 0:r.error.bind(this._optionsService.options.logger))??console.error,s,o)}};a.LogService=d=_([p(0,v.IOptionsService)],d),a.setTraceLogger=function(s){b=s},a.traceCall=function(s,o,r){if(typeof r.value!="function")throw new Error("not supported");const n=r.value;r.value=function(...c){if(b.logLevel!==v.LogLevelEnum.TRACE)return n.apply(this,c);b.trace(`GlyphRenderer#${n.name}(${c.map(S=>JSON.stringify(S)).join(", ")})`);const g=n.apply(this,c);return b.trace(`GlyphRenderer#${n.name} return`,g),g}}},7302:(j,a,u)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.OptionsService=a.DEFAULT_OPTIONS=void 0;const _=u(8460),p=u(844),l=u(6114);a.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,cursorInactiveStyle:"outline",customGlyphs:!0,drawBoldTextInBrightColors:!0,documentOverride:null,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",ignoreBracketedPasteMode:!1,lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",logger:null,scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rescaleOverlappingGlyphs:!1,rightClickSelectsWord:l.isMac,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};const v=["normal","bold","100","200","300","400","500","600","700","800","900"];class m extends p.Disposable{constructor(d){super(),this._onOptionChange=this.register(new _.EventEmitter),this.onOptionChange=this._onOptionChange.event;const s={...a.DEFAULT_OPTIONS};for(const o in d)if(o in s)try{const r=d[o];s[o]=this._sanitizeAndValidateOption(o,r)}catch(r){console.error(r)}this.rawOptions=s,this.options={...s},this._setupOptions(),this.register((0,p.toDisposable)(()=>{this.rawOptions.linkHandler=null,this.rawOptions.documentOverride=null}))}onSpecificOptionChange(d,s){return this.onOptionChange(o=>{o===d&&s(this.rawOptions[d])})}onMultipleOptionChange(d,s){return this.onOptionChange(o=>{d.indexOf(o)!==-1&&s()})}_setupOptions(){const d=o=>{if(!(o in a.DEFAULT_OPTIONS))throw new Error(`No option with key "${o}"`);return this.rawOptions[o]},s=(o,r)=>{if(!(o in a.DEFAULT_OPTIONS))throw new Error(`No option with key "${o}"`);r=this._sanitizeAndValidateOption(o,r),this.rawOptions[o]!==r&&(this.rawOptions[o]=r,this._onOptionChange.fire(o))};for(const o in this.rawOptions){const r={get:d.bind(this,o),set:s.bind(this,o)};Object.defineProperty(this.options,o,r)}}_sanitizeAndValidateOption(d,s){switch(d){case"cursorStyle":if(s||(s=a.DEFAULT_OPTIONS[d]),!function(o){return o==="block"||o==="underline"||o==="bar"}(s))throw new Error(`"${s}" is not a valid value for ${d}`);break;case"wordSeparator":s||(s=a.DEFAULT_OPTIONS[d]);break;case"fontWeight":case"fontWeightBold":if(typeof s=="number"&&1<=s&&s<=1e3)break;s=v.includes(s)?s:a.DEFAULT_OPTIONS[d];break;case"cursorWidth":s=Math.floor(s);case"lineHeight":case"tabStopWidth":if(s<1)throw new Error(`${d} cannot be less than 1, value: ${s}`);break;case"minimumContrastRatio":s=Math.max(1,Math.min(21,Math.round(10*s)/10));break;case"scrollback":if((s=Math.min(s,4294967295))<0)throw new Error(`${d} cannot be less than 0, value: ${s}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(s<=0)throw new Error(`${d} cannot be less than or equal to 0, value: ${s}`);break;case"rows":case"cols":if(!s&&s!==0)throw new Error(`${d} must be numeric, value: ${s}`);break;case"windowsPty":s=s??{}}return s}}a.OptionsService=m},2660:function(j,a,u){var _=this&&this.__decorate||function(m,b,d,s){var o,r=arguments.length,n=r<3?b:s===null?s=Object.getOwnPropertyDescriptor(b,d):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(m,b,d,s);else for(var c=m.length-1;c>=0;c--)(o=m[c])&&(n=(r<3?o(n):r>3?o(b,d,n):o(b,d))||n);return r>3&&n&&Object.defineProperty(b,d,n),n},p=this&&this.__param||function(m,b){return function(d,s){b(d,s,m)}};Object.defineProperty(a,"__esModule",{value:!0}),a.OscLinkService=void 0;const l=u(2585);let v=a.OscLinkService=class{constructor(m){this._bufferService=m,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(m){const b=this._bufferService.buffer;if(m.id===void 0){const c=b.addMarker(b.ybase+b.y),g={data:m,id:this._nextId++,lines:[c]};return c.onDispose(()=>this._removeMarkerFromLink(g,c)),this._dataByLinkId.set(g.id,g),g.id}const d=m,s=this._getEntryIdKey(d),o=this._entriesWithId.get(s);if(o)return this.addLineToLink(o.id,b.ybase+b.y),o.id;const r=b.addMarker(b.ybase+b.y),n={id:this._nextId++,key:this._getEntryIdKey(d),data:d,lines:[r]};return r.onDispose(()=>this._removeMarkerFromLink(n,r)),this._entriesWithId.set(n.key,n),this._dataByLinkId.set(n.id,n),n.id}addLineToLink(m,b){const d=this._dataByLinkId.get(m);if(d&&d.lines.every(s=>s.line!==b)){const s=this._bufferService.buffer.addMarker(b);d.lines.push(s),s.onDispose(()=>this._removeMarkerFromLink(d,s))}}getLinkData(m){var b;return(b=this._dataByLinkId.get(m))==null?void 0:b.data}_getEntryIdKey(m){return`${m.id};;${m.uri}`}_removeMarkerFromLink(m,b){const d=m.lines.indexOf(b);d!==-1&&(m.lines.splice(d,1),m.lines.length===0&&(m.data.id!==void 0&&this._entriesWithId.delete(m.key),this._dataByLinkId.delete(m.id)))}};a.OscLinkService=v=_([p(0,l.IBufferService)],v)},8343:(j,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.createDecorator=a.getServiceDependencies=a.serviceRegistry=void 0;const u="di$target",_="di$dependencies";a.serviceRegistry=new Map,a.getServiceDependencies=function(p){return p[_]||[]},a.createDecorator=function(p){if(a.serviceRegistry.has(p))return a.serviceRegistry.get(p);const l=function(v,m,b){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");(function(d,s,o){s[u]===s?s[_].push({id:d,index:o}):(s[_]=[{id:d,index:o}],s[u]=s)})(l,v,b)};return l.toString=()=>p,a.serviceRegistry.set(p,l),l}},2585:(j,a,u)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.IDecorationService=a.IUnicodeService=a.IOscLinkService=a.IOptionsService=a.ILogService=a.LogLevelEnum=a.IInstantiationService=a.ICharsetService=a.ICoreService=a.ICoreMouseService=a.IBufferService=void 0;const _=u(8343);var p;a.IBufferService=(0,_.createDecorator)("BufferService"),a.ICoreMouseService=(0,_.createDecorator)("CoreMouseService"),a.ICoreService=(0,_.createDecorator)("CoreService"),a.ICharsetService=(0,_.createDecorator)("CharsetService"),a.IInstantiationService=(0,_.createDecorator)("InstantiationService"),function(l){l[l.TRACE=0]="TRACE",l[l.DEBUG=1]="DEBUG",l[l.INFO=2]="INFO",l[l.WARN=3]="WARN",l[l.ERROR=4]="ERROR",l[l.OFF=5]="OFF"}(p||(a.LogLevelEnum=p={})),a.ILogService=(0,_.createDecorator)("LogService"),a.IOptionsService=(0,_.createDecorator)("OptionsService"),a.IOscLinkService=(0,_.createDecorator)("OscLinkService"),a.IUnicodeService=(0,_.createDecorator)("UnicodeService"),a.IDecorationService=(0,_.createDecorator)("DecorationService")},1480:(j,a,u)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.UnicodeService=void 0;const _=u(8460),p=u(225);class l{static extractShouldJoin(m){return(1&m)!=0}static extractWidth(m){return m>>1&3}static extractCharKind(m){return m>>3}static createPropertyValue(m,b,d=!1){return(16777215&m)<<3|(3&b)<<1|(d?1:0)}constructor(){this._providers=Object.create(null),this._active="",this._onChange=new _.EventEmitter,this.onChange=this._onChange.event;const m=new p.UnicodeV6;this.register(m),this._active=m.version,this._activeProvider=m}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(m){if(!this._providers[m])throw new Error(`unknown Unicode version "${m}"`);this._active=m,this._activeProvider=this._providers[m],this._onChange.fire(m)}register(m){this._providers[m.version]=m}wcwidth(m){return this._activeProvider.wcwidth(m)}getStringCellWidth(m){let b=0,d=0;const s=m.length;for(let o=0;o<s;++o){let r=m.charCodeAt(o);if(55296<=r&&r<=56319){if(++o>=s)return b+this.wcwidth(r);const g=m.charCodeAt(o);56320<=g&&g<=57343?r=1024*(r-55296)+g-56320+65536:b+=this.wcwidth(g)}const n=this.charProperties(r,d);let c=l.extractWidth(n);l.extractShouldJoin(n)&&(c-=l.extractWidth(d)),b+=c,d=n}return b}charProperties(m,b){return this._activeProvider.charProperties(m,b)}}a.UnicodeService=l}},Ne={};function ye(j){var a=Ne[j];if(a!==void 0)return a.exports;var u=Ne[j]={exports:{}};return k[j].call(u.exports,u,u.exports,ye),u.exports}var ot={};return(()=>{var j=ot;Object.defineProperty(j,"__esModule",{value:!0}),j.Terminal=void 0;const a=ye(9042),u=ye(3236),_=ye(844),p=ye(5741),l=ye(8285),v=ye(7975),m=ye(7090),b=["cols","rows"];class d extends _.Disposable{constructor(o){super(),this._core=this.register(new u.Terminal(o)),this._addonManager=this.register(new p.AddonManager),this._publicOptions={...this._core.options};const r=c=>this._core.options[c],n=(c,g)=>{this._checkReadonlyOptions(c),this._core.options[c]=g};for(const c in this._core.options){const g={get:r.bind(this,c),set:n.bind(this,c)};Object.defineProperty(this._publicOptions,c,g)}}_checkReadonlyOptions(o){if(b.includes(o))throw new Error(`Option "${o}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new v.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new m.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=this.register(new l.BufferNamespaceApi(this._core))),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){const o=this._core.coreService.decPrivateModes;let r="none";switch(this._core.coreMouseService.activeProtocol){case"X10":r="x10";break;case"VT200":r="vt200";break;case"DRAG":r="drag";break;case"ANY":r="any"}return{applicationCursorKeysMode:o.applicationCursorKeys,applicationKeypadMode:o.applicationKeypad,bracketedPasteMode:o.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:r,originMode:o.origin,reverseWraparoundMode:o.reverseWraparound,sendFocusMode:o.sendFocus,wraparoundMode:o.wraparound}}get options(){return this._publicOptions}set options(o){for(const r in o)this._publicOptions[r]=o[r]}blur(){this._core.blur()}focus(){this._core.focus()}input(o,r=!0){this._core.input(o,r)}resize(o,r){this._verifyIntegers(o,r),this._core.resize(o,r)}open(o){this._core.open(o)}attachCustomKeyEventHandler(o){this._core.attachCustomKeyEventHandler(o)}attachCustomWheelEventHandler(o){this._core.attachCustomWheelEventHandler(o)}registerLinkProvider(o){return this._core.registerLinkProvider(o)}registerCharacterJoiner(o){return this._checkProposedApi(),this._core.registerCharacterJoiner(o)}deregisterCharacterJoiner(o){this._checkProposedApi(),this._core.deregisterCharacterJoiner(o)}registerMarker(o=0){return this._verifyIntegers(o),this._core.registerMarker(o)}registerDecoration(o){return this._checkProposedApi(),this._verifyPositiveIntegers(o.x??0,o.width??0,o.height??0),this._core.registerDecoration(o)}hasSelection(){return this._core.hasSelection()}select(o,r,n){this._verifyIntegers(o,r,n),this._core.select(o,r,n)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(o,r){this._verifyIntegers(o,r),this._core.selectLines(o,r)}dispose(){super.dispose()}scrollLines(o){this._verifyIntegers(o),this._core.scrollLines(o)}scrollPages(o){this._verifyIntegers(o),this._core.scrollPages(o)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(o){this._verifyIntegers(o),this._core.scrollToLine(o)}clear(){this._core.clear()}write(o,r){this._core.write(o,r)}writeln(o,r){this._core.write(o),this._core.write(`\r
`,r)}paste(o){this._core.paste(o)}refresh(o,r){this._verifyIntegers(o,r),this._core.refresh(o,r)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(o){this._addonManager.loadAddon(this,o)}static get strings(){return a}_verifyIntegers(...o){for(const r of o)if(r===1/0||isNaN(r)||r%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...o){for(const r of o)if(r&&(r===1/0||isNaN(r)||r%1!=0||r<0))throw new Error("This API only accepts positive integers")}}j.Terminal=d})(),ot})())})(eh);var sp=eh.exports,ih={exports:{}};(function(Nt,Et){(function(k,Ne){Nt.exports=Ne()})(self,()=>(()=>{var k={};return(()=>{var Ne=k;Object.defineProperty(Ne,"__esModule",{value:!0}),Ne.FitAddon=void 0,Ne.FitAddon=class{activate(ye){this._terminal=ye}dispose(){}fit(){const ye=this.proposeDimensions();if(!ye||!this._terminal||isNaN(ye.cols)||isNaN(ye.rows))return;const ot=this._terminal._core;this._terminal.rows===ye.rows&&this._terminal.cols===ye.cols||(ot._renderService.clear(),this._terminal.resize(ye.cols,ye.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;const ye=this._terminal._core,ot=ye._renderService.dimensions;if(ot.css.cell.width===0||ot.css.cell.height===0)return;const j=this._terminal.options.scrollback===0?0:ye.viewport.scrollBarWidth,a=window.getComputedStyle(this._terminal.element.parentElement),u=parseInt(a.getPropertyValue("height")),_=Math.max(0,parseInt(a.getPropertyValue("width"))),p=window.getComputedStyle(this._terminal.element),l=u-(parseInt(p.getPropertyValue("padding-top"))+parseInt(p.getPropertyValue("padding-bottom"))),v=_-(parseInt(p.getPropertyValue("padding-right"))+parseInt(p.getPropertyValue("padding-left")))-j;return{cols:Math.max(2,Math.floor(v/ot.css.cell.width)),rows:Math.max(1,Math.floor(l/ot.css.cell.height))}}}})(),k})())})(ih);var np=ih.exports,Jr={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */Jr.exports;(function(Nt,Et){(function(){var k,Ne="4.17.21",ye=200,ot="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",j="Expected a function",a="Invalid `variable` option passed into `_.template`",u="__lodash_hash_undefined__",_=500,p="__lodash_placeholder__",l=1,v=2,m=4,b=1,d=2,s=1,o=2,r=4,n=8,c=16,g=32,S=64,C=128,f=256,y=512,T=30,O="...",P=800,D=16,N=1,X=2,Z=3,se=1/0,ee=9007199254740991,E=17976931348623157e292,A=0/0,M=4294967295,H=M-1,Q=M>>>1,re=[["ary",C],["bind",s],["bindKey",o],["curry",n],["curryRight",c],["flip",y],["partial",g],["partialRight",S],["rearg",f]],le="[object Arguments]",fe="[object Array]",U="[object AsyncFunction]",R="[object Boolean]",J="[object Date]",z="[object DOMException]",ne="[object Error]",ie="[object Function]",Ee="[object GeneratorFunction]",Le="[object Map]",Me="[object Number]",Je="[object Null]",ue="[object Object]",$t="[object Promise]",_i="[object Proxy]",Ot="[object RegExp]",it="[object Set]",xt="[object String]",q="[object Symbol]",te="[object Undefined]",he="[object WeakMap]",ze="[object WeakSet]",Ke="[object ArrayBuffer]",et="[object DataView]",zt="[object Float32Array]",rt="[object Float64Array]",It="[object Int8Array]",Ie="[object Int16Array]",Gt="[object Int32Array]",Ui="[object Uint8Array]",Ni="[object Uint8ClampedArray]",$i="[object Uint16Array]",zi="[object Uint32Array]",Yr=/\b__p \+= '';/g,Zr=/\b(__p \+=) '' \+/g,de=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Ki=/&(?:amp|lt|gt|quot|#39);/g,Ye=/[&<>"']/g,Qr=RegExp(Ki.source),es=RegExp(Ye.source),rh=/<%-([\s\S]+?)%>/g,sh=/<%([\s\S]+?)%>/g,gn=/<%=([\s\S]+?)%>/g,nh=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,oh=/^\w*$/,ah=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ts=/[\\^$.*+?()[\]{}|]/g,hh=RegExp(ts.source),is=/^\s+/,lh=/\s/,ch=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,uh=/\{\n\/\* \[wrapped with (.+)\] \*/,fh=/,? & /,dh=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,_h=/[()=,{}\[\]\/\s]/,vh=/\\(\\)?/g,ph=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,mn=/\w*$/,gh=/^[-+]0x[0-9a-f]+$/i,mh=/^0b[01]+$/i,Sh=/^\[object .+?Constructor\]$/,Ch=/^0o[0-7]+$/i,wh=/^(?:0|[1-9]\d*)$/,bh=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,hr=/($^)/,yh=/['\n\r\u2028\u2029\\]/g,lr="\\ud800-\\udfff",Eh="\\u0300-\\u036f",xh="\\ufe20-\\ufe2f",Lh="\\u20d0-\\u20ff",Sn=Eh+xh+Lh,Cn="\\u2700-\\u27bf",wn="a-z\\xdf-\\xf6\\xf8-\\xff",Rh="\\xac\\xb1\\xd7\\xf7",Dh="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",kh="\\u2000-\\u206f",Ah=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",bn="A-Z\\xc0-\\xd6\\xd8-\\xde",yn="\\ufe0e\\ufe0f",En=Rh+Dh+kh+Ah,rs="['â]",Bh="["+lr+"]",xn="["+En+"]",cr="["+Sn+"]",Ln="\\d+",Th="["+Cn+"]",Rn="["+wn+"]",Dn="[^"+lr+En+Ln+Cn+wn+bn+"]",ss="\\ud83c[\\udffb-\\udfff]",Mh="(?:"+cr+"|"+ss+")",kn="[^"+lr+"]",ns="(?:\\ud83c[\\udde6-\\uddff]){2}",os="[\\ud800-\\udbff][\\udc00-\\udfff]",xi="["+bn+"]",An="\\u200d",Bn="(?:"+Rn+"|"+Dn+")",Oh="(?:"+xi+"|"+Dn+")",Tn="(?:"+rs+"(?:d|ll|m|re|s|t|ve))?",Mn="(?:"+rs+"(?:D|LL|M|RE|S|T|VE))?",On=Mh+"?",In="["+yn+"]?",Ih="(?:"+An+"(?:"+[kn,ns,os].join("|")+")"+In+On+")*",Ph="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Hh="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Pn=In+On+Ih,Fh="(?:"+[Th,ns,os].join("|")+")"+Pn,Wh="(?:"+[kn+cr+"?",cr,ns,os,Bh].join("|")+")",Uh=RegExp(rs,"g"),Nh=RegExp(cr,"g"),as=RegExp(ss+"(?="+ss+")|"+Wh+Pn,"g"),$h=RegExp([xi+"?"+Rn+"+"+Tn+"(?="+[xn,xi,"$"].join("|")+")",Oh+"+"+Mn+"(?="+[xn,xi+Bn,"$"].join("|")+")",xi+"?"+Bn+"+"+Tn,xi+"+"+Mn,Hh,Ph,Ln,Fh].join("|"),"g"),zh=RegExp("["+An+lr+Sn+yn+"]"),Kh=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,qh=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Vh=-1,We={};We[zt]=We[rt]=We[It]=We[Ie]=We[Gt]=We[Ui]=We[Ni]=We[$i]=We[zi]=!0,We[le]=We[fe]=We[Ke]=We[R]=We[et]=We[J]=We[ne]=We[ie]=We[Le]=We[Me]=We[ue]=We[Ot]=We[it]=We[xt]=We[he]=!1;var Fe={};Fe[le]=Fe[fe]=Fe[Ke]=Fe[et]=Fe[R]=Fe[J]=Fe[zt]=Fe[rt]=Fe[It]=Fe[Ie]=Fe[Gt]=Fe[Le]=Fe[Me]=Fe[ue]=Fe[Ot]=Fe[it]=Fe[xt]=Fe[q]=Fe[Ui]=Fe[Ni]=Fe[$i]=Fe[zi]=!0,Fe[ne]=Fe[ie]=Fe[he]=!1;var Gh={Ã:"A",Ã:"A",Ã:"A",Ã:"A",Ã:"A",Ã:"A",Ã :"a",Ã¡:"a",Ã¢:"a",Ã£:"a",Ã¤:"a",Ã¥:"a",Ã:"C",Ã§:"c",Ã:"D",Ã°:"d",Ã:"E",Ã:"E",Ã:"E",Ã:"E",Ã¨:"e",Ã©:"e",Ãª:"e",Ã«:"e",Ã:"I",Ã:"I",Ã:"I",Ã:"I",Ã¬:"i",Ã­:"i",Ã®:"i",Ã¯:"i",Ã:"N",Ã±:"n",Ã:"O",Ã:"O",Ã:"O",Ã:"O",Ã:"O",Ã:"O",Ã²:"o",Ã³:"o",Ã´:"o",Ãµ:"o",Ã¶:"o",Ã¸:"o",Ã:"U",Ã:"U",Ã:"U",Ã:"U",Ã¹:"u",Ãº:"u",Ã»:"u",Ã¼:"u",Ã:"Y",Ã½:"y",Ã¿:"y",Ã:"Ae",Ã¦:"ae",Ã:"Th",Ã¾:"th",Ã:"ss",Ä:"A",Ä:"A",Ä:"A",Ä:"a",Ä:"a",Ä:"a",Ä:"C",Ä:"C",Ä:"C",Ä:"C",Ä:"c",Ä:"c",Ä:"c",Ä:"c",Ä:"D",Ä:"D",Ä:"d",Ä:"d",Ä:"E",Ä:"E",Ä:"E",Ä:"E",Ä:"E",Ä:"e",Ä:"e",Ä:"e",Ä:"e",Ä:"e",Ä:"G",Ä:"G",Ä :"G",Ä¢:"G",Ä:"g",Ä:"g",Ä¡:"g",Ä£:"g",Ä¤:"H",Ä¦:"H",Ä¥:"h",Ä§:"h",Ä¨:"I",Äª:"I",Ä¬:"I",Ä®:"I",Ä°:"I",Ä©:"i",Ä«:"i",Ä­:"i",Ä¯:"i",Ä±:"i",Ä´:"J",Äµ:"j",Ä¶:"K",Ä·:"k",Ä¸:"k",Ä¹:"L",Ä»:"L",Ä½:"L",Ä¿:"L",Å:"L",Äº:"l",Ä¼:"l",Ä¾:"l",Å:"l",Å:"l",Å:"N",Å:"N",Å:"N",Å:"N",Å:"n",Å:"n",Å:"n",Å:"n",Å:"O",Å:"O",Å:"O",Å:"o",Å:"o",Å:"o",Å:"R",Å:"R",Å:"R",Å:"r",Å:"r",Å:"r",Å:"S",Å:"S",Å:"S",Å :"S",Å:"s",Å:"s",Å:"s",Å¡:"s",Å¢:"T",Å¤:"T",Å¦:"T",Å£:"t",Å¥:"t",Å§:"t",Å¨:"U",Åª:"U",Å¬:"U",Å®:"U",Å°:"U",Å²:"U",Å©:"u",Å«:"u",Å­:"u",Å¯:"u",Å±:"u",Å³:"u",Å´:"W",Åµ:"w",Å¶:"Y",Å·:"y",Å¸:"Y",Å¹:"Z",Å»:"Z",Å½:"Z",Åº:"z",Å¼:"z",Å¾:"z",Ä²:"IJ",Ä³:"ij",Å:"Oe",Å:"oe",Å:"'n",Å¿:"s"},jh={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Xh={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Jh={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Yh=parseFloat,Zh=parseInt,Hn=typeof or=="object"&&or&&or.Object===Object&&or,Qh=typeof self=="object"&&self&&self.Object===Object&&self,st=Hn||Qh||Function("return this")(),hs=Et&&!Et.nodeType&&Et,vi=hs&&!0&&Nt&&!Nt.nodeType&&Nt,Fn=vi&&vi.exports===hs,ls=Fn&&Hn.process,Lt=function(){try{var F=vi&&vi.require&&vi.require("util").types;return F||ls&&ls.binding&&ls.binding("util")}catch{}}(),Wn=Lt&&Lt.isArrayBuffer,Un=Lt&&Lt.isDate,Nn=Lt&&Lt.isMap,$n=Lt&&Lt.isRegExp,zn=Lt&&Lt.isSet,Kn=Lt&&Lt.isTypedArray;function gt(F,K,$){switch($.length){case 0:return F.call(K);case 1:return F.call(K,$[0]);case 2:return F.call(K,$[0],$[1]);case 3:return F.call(K,$[0],$[1],$[2])}return F.apply(K,$)}function el(F,K,$,ae){for(var Se=-1,Te=F==null?0:F.length;++Se<Te;){var Ze=F[Se];K(ae,Ze,$(Ze),F)}return ae}function Rt(F,K){for(var $=-1,ae=F==null?0:F.length;++$<ae&&K(F[$],$,F)!==!1;);return F}function tl(F,K){for(var $=F==null?0:F.length;$--&&K(F[$],$,F)!==!1;);return F}function qn(F,K){for(var $=-1,ae=F==null?0:F.length;++$<ae;)if(!K(F[$],$,F))return!1;return!0}function ni(F,K){for(var $=-1,ae=F==null?0:F.length,Se=0,Te=[];++$<ae;){var Ze=F[$];K(Ze,$,F)&&(Te[Se++]=Ze)}return Te}function ur(F,K){var $=F==null?0:F.length;return!!$&&Li(F,K,0)>-1}function cs(F,K,$){for(var ae=-1,Se=F==null?0:F.length;++ae<Se;)if($(K,F[ae]))return!0;return!1}function Ue(F,K){for(var $=-1,ae=F==null?0:F.length,Se=Array(ae);++$<ae;)Se[$]=K(F[$],$,F);return Se}function oi(F,K){for(var $=-1,ae=K.length,Se=F.length;++$<ae;)F[Se+$]=K[$];return F}function us(F,K,$,ae){var Se=-1,Te=F==null?0:F.length;for(ae&&Te&&($=F[++Se]);++Se<Te;)$=K($,F[Se],Se,F);return $}function il(F,K,$,ae){var Se=F==null?0:F.length;for(ae&&Se&&($=F[--Se]);Se--;)$=K($,F[Se],Se,F);return $}function fs(F,K){for(var $=-1,ae=F==null?0:F.length;++$<ae;)if(K(F[$],$,F))return!0;return!1}var rl=ds("length");function sl(F){return F.split("")}function nl(F){return F.match(dh)||[]}function Vn(F,K,$){var ae;return $(F,function(Se,Te,Ze){if(K(Se,Te,Ze))return ae=Te,!1}),ae}function fr(F,K,$,ae){for(var Se=F.length,Te=$+(ae?1:-1);ae?Te--:++Te<Se;)if(K(F[Te],Te,F))return Te;return-1}function Li(F,K,$){return K===K?gl(F,K,$):fr(F,Gn,$)}function ol(F,K,$,ae){for(var Se=$-1,Te=F.length;++Se<Te;)if(ae(F[Se],K))return Se;return-1}function Gn(F){return F!==F}function jn(F,K){var $=F==null?0:F.length;return $?vs(F,K)/$:A}function ds(F){return function(K){return K==null?k:K[F]}}function _s(F){return function(K){return F==null?k:F[K]}}function Xn(F,K,$,ae,Se){return Se(F,function(Te,Ze,He){$=ae?(ae=!1,Te):K($,Te,Ze,He)}),$}function al(F,K){var $=F.length;for(F.sort(K);$--;)F[$]=F[$].value;return F}function vs(F,K){for(var $,ae=-1,Se=F.length;++ae<Se;){var Te=K(F[ae]);Te!==k&&($=$===k?Te:$+Te)}return $}function ps(F,K){for(var $=-1,ae=Array(F);++$<F;)ae[$]=K($);return ae}function hl(F,K){return Ue(K,function($){return[$,F[$]]})}function Jn(F){return F&&F.slice(0,eo(F)+1).replace(is,"")}function mt(F){return function(K){return F(K)}}function gs(F,K){return Ue(K,function($){return F[$]})}function qi(F,K){return F.has(K)}function Yn(F,K){for(var $=-1,ae=F.length;++$<ae&&Li(K,F[$],0)>-1;);return $}function Zn(F,K){for(var $=F.length;$--&&Li(K,F[$],0)>-1;);return $}function ll(F,K){for(var $=F.length,ae=0;$--;)F[$]===K&&++ae;return ae}var cl=_s(Gh),ul=_s(jh);function fl(F){return"\\"+Jh[F]}function dl(F,K){return F==null?k:F[K]}function Ri(F){return zh.test(F)}function _l(F){return Kh.test(F)}function vl(F){for(var K,$=[];!(K=F.next()).done;)$.push(K.value);return $}function ms(F){var K=-1,$=Array(F.size);return F.forEach(function(ae,Se){$[++K]=[Se,ae]}),$}function Qn(F,K){return function($){return F(K($))}}function ai(F,K){for(var $=-1,ae=F.length,Se=0,Te=[];++$<ae;){var Ze=F[$];(Ze===K||Ze===p)&&(F[$]=p,Te[Se++]=$)}return Te}function dr(F){var K=-1,$=Array(F.size);return F.forEach(function(ae){$[++K]=ae}),$}function pl(F){var K=-1,$=Array(F.size);return F.forEach(function(ae){$[++K]=[ae,ae]}),$}function gl(F,K,$){for(var ae=$-1,Se=F.length;++ae<Se;)if(F[ae]===K)return ae;return-1}function ml(F,K,$){for(var ae=$+1;ae--;)if(F[ae]===K)return ae;return ae}function Di(F){return Ri(F)?Cl(F):rl(F)}function Pt(F){return Ri(F)?wl(F):sl(F)}function eo(F){for(var K=F.length;K--&&lh.test(F.charAt(K)););return K}var Sl=_s(Xh);function Cl(F){for(var K=as.lastIndex=0;as.test(F);)++K;return K}function wl(F){return F.match(as)||[]}function bl(F){return F.match($h)||[]}var yl=function F(K){K=K==null?st:ki.defaults(st.Object(),K,ki.pick(st,qh));var $=K.Array,ae=K.Date,Se=K.Error,Te=K.Function,Ze=K.Math,He=K.Object,Ss=K.RegExp,El=K.String,Dt=K.TypeError,_r=$.prototype,xl=Te.prototype,Ai=He.prototype,vr=K["__core-js_shared__"],pr=xl.toString,Pe=Ai.hasOwnProperty,Ll=0,to=function(){var e=/[^.]+$/.exec(vr&&vr.keys&&vr.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),gr=Ai.toString,Rl=pr.call(He),Dl=st._,kl=Ss("^"+pr.call(Pe).replace(ts,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),mr=Fn?K.Buffer:k,hi=K.Symbol,Sr=K.Uint8Array,io=mr?mr.allocUnsafe:k,Cr=Qn(He.getPrototypeOf,He),ro=He.create,so=Ai.propertyIsEnumerable,wr=_r.splice,no=hi?hi.isConcatSpreadable:k,Vi=hi?hi.iterator:k,pi=hi?hi.toStringTag:k,br=function(){try{var e=wi(He,"defineProperty");return e({},"",{}),e}catch{}}(),Al=K.clearTimeout!==st.clearTimeout&&K.clearTimeout,Bl=ae&&ae.now!==st.Date.now&&ae.now,Tl=K.setTimeout!==st.setTimeout&&K.setTimeout,yr=Ze.ceil,Er=Ze.floor,Cs=He.getOwnPropertySymbols,Ml=mr?mr.isBuffer:k,oo=K.isFinite,Ol=_r.join,Il=Qn(He.keys,He),Qe=Ze.max,at=Ze.min,Pl=ae.now,Hl=K.parseInt,ao=Ze.random,Fl=_r.reverse,ws=wi(K,"DataView"),Gi=wi(K,"Map"),bs=wi(K,"Promise"),Bi=wi(K,"Set"),ji=wi(K,"WeakMap"),Xi=wi(He,"create"),xr=ji&&new ji,Ti={},Wl=bi(ws),Ul=bi(Gi),Nl=bi(bs),$l=bi(Bi),zl=bi(ji),Lr=hi?hi.prototype:k,Ji=Lr?Lr.valueOf:k,ho=Lr?Lr.toString:k;function x(e){if(qe(e)&&!Ce(e)&&!(e instanceof De)){if(e instanceof kt)return e;if(Pe.call(e,"__wrapped__"))return ca(e)}return new kt(e)}var Mi=function(){function e(){}return function(t){if(!$e(t))return{};if(ro)return ro(t);e.prototype=t;var i=new e;return e.prototype=k,i}}();function Rr(){}function kt(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=k}x.templateSettings={escape:rh,evaluate:sh,interpolate:gn,variable:"",imports:{_:x}},x.prototype=Rr.prototype,x.prototype.constructor=x,kt.prototype=Mi(Rr.prototype),kt.prototype.constructor=kt;function De(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=M,this.__views__=[]}function Kl(){var e=new De(this.__wrapped__);return e.__actions__=dt(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=dt(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=dt(this.__views__),e}function ql(){if(this.__filtered__){var e=new De(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Vl(){var e=this.__wrapped__.value(),t=this.__dir__,i=Ce(e),h=t<0,w=i?e.length:0,L=su(0,w,this.__views__),B=L.start,I=L.end,W=I-B,V=h?I:B-1,G=this.__iteratees__,Y=G.length,oe=0,ce=at(W,this.__takeCount__);if(!i||!h&&w==W&&ce==W)return Mo(e,this.__actions__);var ve=[];e:for(;W--&&oe<ce;){V+=t;for(var be=-1,pe=e[V];++be<Y;){var Re=G[be],Ae=Re.iteratee,wt=Re.type,ft=Ae(pe);if(wt==X)pe=ft;else if(!ft){if(wt==N)continue e;break e}}ve[oe++]=pe}return ve}De.prototype=Mi(Rr.prototype),De.prototype.constructor=De;function gi(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var h=e[t];this.set(h[0],h[1])}}function Gl(){this.__data__=Xi?Xi(null):{},this.size=0}function jl(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function Xl(e){var t=this.__data__;if(Xi){var i=t[e];return i===u?k:i}return Pe.call(t,e)?t[e]:k}function Jl(e){var t=this.__data__;return Xi?t[e]!==k:Pe.call(t,e)}function Yl(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=Xi&&t===k?u:t,this}gi.prototype.clear=Gl,gi.prototype.delete=jl,gi.prototype.get=Xl,gi.prototype.has=Jl,gi.prototype.set=Yl;function jt(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var h=e[t];this.set(h[0],h[1])}}function Zl(){this.__data__=[],this.size=0}function Ql(e){var t=this.__data__,i=Dr(t,e);if(i<0)return!1;var h=t.length-1;return i==h?t.pop():wr.call(t,i,1),--this.size,!0}function ec(e){var t=this.__data__,i=Dr(t,e);return i<0?k:t[i][1]}function tc(e){return Dr(this.__data__,e)>-1}function ic(e,t){var i=this.__data__,h=Dr(i,e);return h<0?(++this.size,i.push([e,t])):i[h][1]=t,this}jt.prototype.clear=Zl,jt.prototype.delete=Ql,jt.prototype.get=ec,jt.prototype.has=tc,jt.prototype.set=ic;function Xt(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var h=e[t];this.set(h[0],h[1])}}function rc(){this.size=0,this.__data__={hash:new gi,map:new(Gi||jt),string:new gi}}function sc(e){var t=Ur(this,e).delete(e);return this.size-=t?1:0,t}function nc(e){return Ur(this,e).get(e)}function oc(e){return Ur(this,e).has(e)}function ac(e,t){var i=Ur(this,e),h=i.size;return i.set(e,t),this.size+=i.size==h?0:1,this}Xt.prototype.clear=rc,Xt.prototype.delete=sc,Xt.prototype.get=nc,Xt.prototype.has=oc,Xt.prototype.set=ac;function mi(e){var t=-1,i=e==null?0:e.length;for(this.__data__=new Xt;++t<i;)this.add(e[t])}function hc(e){return this.__data__.set(e,u),this}function lc(e){return this.__data__.has(e)}mi.prototype.add=mi.prototype.push=hc,mi.prototype.has=lc;function Ht(e){var t=this.__data__=new jt(e);this.size=t.size}function cc(){this.__data__=new jt,this.size=0}function uc(e){var t=this.__data__,i=t.delete(e);return this.size=t.size,i}function fc(e){return this.__data__.get(e)}function dc(e){return this.__data__.has(e)}function _c(e,t){var i=this.__data__;if(i instanceof jt){var h=i.__data__;if(!Gi||h.length<ye-1)return h.push([e,t]),this.size=++i.size,this;i=this.__data__=new Xt(h)}return i.set(e,t),this.size=i.size,this}Ht.prototype.clear=cc,Ht.prototype.delete=uc,Ht.prototype.get=fc,Ht.prototype.has=dc,Ht.prototype.set=_c;function lo(e,t){var i=Ce(e),h=!i&&yi(e),w=!i&&!h&&di(e),L=!i&&!h&&!w&&Hi(e),B=i||h||w||L,I=B?ps(e.length,El):[],W=I.length;for(var V in e)(t||Pe.call(e,V))&&!(B&&(V=="length"||w&&(V=="offset"||V=="parent")||L&&(V=="buffer"||V=="byteLength"||V=="byteOffset")||Qt(V,W)))&&I.push(V);return I}function co(e){var t=e.length;return t?e[Ms(0,t-1)]:k}function vc(e,t){return Nr(dt(e),Si(t,0,e.length))}function pc(e){return Nr(dt(e))}function ys(e,t,i){(i!==k&&!Ft(e[t],i)||i===k&&!(t in e))&&Jt(e,t,i)}function Yi(e,t,i){var h=e[t];(!(Pe.call(e,t)&&Ft(h,i))||i===k&&!(t in e))&&Jt(e,t,i)}function Dr(e,t){for(var i=e.length;i--;)if(Ft(e[i][0],t))return i;return-1}function gc(e,t,i,h){return li(e,function(w,L,B){t(h,w,i(w),B)}),h}function uo(e,t){return e&&qt(t,tt(t),e)}function mc(e,t){return e&&qt(t,vt(t),e)}function Jt(e,t,i){t=="__proto__"&&br?br(e,t,{configurable:!0,enumerable:!0,value:i,writable:!0}):e[t]=i}function Es(e,t){for(var i=-1,h=t.length,w=$(h),L=e==null;++i<h;)w[i]=L?k:nn(e,t[i]);return w}function Si(e,t,i){return e===e&&(i!==k&&(e=e<=i?e:i),t!==k&&(e=e>=t?e:t)),e}function At(e,t,i,h,w,L){var B,I=t&l,W=t&v,V=t&m;if(i&&(B=w?i(e,h,w,L):i(e)),B!==k)return B;if(!$e(e))return e;var G=Ce(e);if(G){if(B=ou(e),!I)return dt(e,B)}else{var Y=ht(e),oe=Y==ie||Y==Ee;if(di(e))return Po(e,I);if(Y==ue||Y==le||oe&&!w){if(B=W||oe?{}:ta(e),!I)return W?Xc(e,mc(B,e)):jc(e,uo(B,e))}else{if(!Fe[Y])return w?e:{};B=au(e,Y,I)}}L||(L=new Ht);var ce=L.get(e);if(ce)return ce;L.set(e,B),Aa(e)?e.forEach(function(pe){B.add(At(pe,t,i,pe,e,L))}):Da(e)&&e.forEach(function(pe,Re){B.set(Re,At(pe,t,i,Re,e,L))});var ve=V?W?Ks:zs:W?vt:tt,be=G?k:ve(e);return Rt(be||e,function(pe,Re){be&&(Re=pe,pe=e[Re]),Yi(B,Re,At(pe,t,i,Re,e,L))}),B}function Sc(e){var t=tt(e);return function(i){return fo(i,e,t)}}function fo(e,t,i){var h=i.length;if(e==null)return!h;for(e=He(e);h--;){var w=i[h],L=t[w],B=e[w];if(B===k&&!(w in e)||!L(B))return!1}return!0}function _o(e,t,i){if(typeof e!="function")throw new Dt(j);return sr(function(){e.apply(k,i)},t)}function Zi(e,t,i,h){var w=-1,L=ur,B=!0,I=e.length,W=[],V=t.length;if(!I)return W;i&&(t=Ue(t,mt(i))),h?(L=cs,B=!1):t.length>=ye&&(L=qi,B=!1,t=new mi(t));e:for(;++w<I;){var G=e[w],Y=i==null?G:i(G);if(G=h||G!==0?G:0,B&&Y===Y){for(var oe=V;oe--;)if(t[oe]===Y)continue e;W.push(G)}else L(t,Y,h)||W.push(G)}return W}var li=No(Kt),vo=No(Ls,!0);function Cc(e,t){var i=!0;return li(e,function(h,w,L){return i=!!t(h,w,L),i}),i}function kr(e,t,i){for(var h=-1,w=e.length;++h<w;){var L=e[h],B=t(L);if(B!=null&&(I===k?B===B&&!Ct(B):i(B,I)))var I=B,W=L}return W}function wc(e,t,i,h){var w=e.length;for(i=we(i),i<0&&(i=-i>w?0:w+i),h=h===k||h>w?w:we(h),h<0&&(h+=w),h=i>h?0:Ta(h);i<h;)e[i++]=t;return e}function po(e,t){var i=[];return li(e,function(h,w,L){t(h,w,L)&&i.push(h)}),i}function nt(e,t,i,h,w){var L=-1,B=e.length;for(i||(i=lu),w||(w=[]);++L<B;){var I=e[L];t>0&&i(I)?t>1?nt(I,t-1,i,h,w):oi(w,I):h||(w[w.length]=I)}return w}var xs=$o(),go=$o(!0);function Kt(e,t){return e&&xs(e,t,tt)}function Ls(e,t){return e&&go(e,t,tt)}function Ar(e,t){return ni(t,function(i){return ei(e[i])})}function Ci(e,t){t=ui(t,e);for(var i=0,h=t.length;e!=null&&i<h;)e=e[Vt(t[i++])];return i&&i==h?e:k}function mo(e,t,i){var h=t(e);return Ce(e)?h:oi(h,i(e))}function ct(e){return e==null?e===k?te:Je:pi&&pi in He(e)?ru(e):pu(e)}function Rs(e,t){return e>t}function bc(e,t){return e!=null&&Pe.call(e,t)}function yc(e,t){return e!=null&&t in He(e)}function Ec(e,t,i){return e>=at(t,i)&&e<Qe(t,i)}function Ds(e,t,i){for(var h=i?cs:ur,w=e[0].length,L=e.length,B=L,I=$(L),W=1/0,V=[];B--;){var G=e[B];B&&t&&(G=Ue(G,mt(t))),W=at(G.length,W),I[B]=!i&&(t||w>=120&&G.length>=120)?new mi(B&&G):k}G=e[0];var Y=-1,oe=I[0];e:for(;++Y<w&&V.length<W;){var ce=G[Y],ve=t?t(ce):ce;if(ce=i||ce!==0?ce:0,!(oe?qi(oe,ve):h(V,ve,i))){for(B=L;--B;){var be=I[B];if(!(be?qi(be,ve):h(e[B],ve,i)))continue e}oe&&oe.push(ve),V.push(ce)}}return V}function xc(e,t,i,h){return Kt(e,function(w,L,B){t(h,i(w),L,B)}),h}function Qi(e,t,i){t=ui(t,e),e=na(e,t);var h=e==null?e:e[Vt(Tt(t))];return h==null?k:gt(h,e,i)}function So(e){return qe(e)&&ct(e)==le}function Lc(e){return qe(e)&&ct(e)==Ke}function Rc(e){return qe(e)&&ct(e)==J}function er(e,t,i,h,w){return e===t?!0:e==null||t==null||!qe(e)&&!qe(t)?e!==e&&t!==t:Dc(e,t,i,h,er,w)}function Dc(e,t,i,h,w,L){var B=Ce(e),I=Ce(t),W=B?fe:ht(e),V=I?fe:ht(t);W=W==le?ue:W,V=V==le?ue:V;var G=W==ue,Y=V==ue,oe=W==V;if(oe&&di(e)){if(!di(t))return!1;B=!0,G=!1}if(oe&&!G)return L||(L=new Ht),B||Hi(e)?Zo(e,t,i,h,w,L):tu(e,t,W,i,h,w,L);if(!(i&b)){var ce=G&&Pe.call(e,"__wrapped__"),ve=Y&&Pe.call(t,"__wrapped__");if(ce||ve){var be=ce?e.value():e,pe=ve?t.value():t;return L||(L=new Ht),w(be,pe,i,h,L)}}return oe?(L||(L=new Ht),iu(e,t,i,h,w,L)):!1}function kc(e){return qe(e)&&ht(e)==Le}function ks(e,t,i,h){var w=i.length,L=w,B=!h;if(e==null)return!L;for(e=He(e);w--;){var I=i[w];if(B&&I[2]?I[1]!==e[I[0]]:!(I[0]in e))return!1}for(;++w<L;){I=i[w];var W=I[0],V=e[W],G=I[1];if(B&&I[2]){if(V===k&&!(W in e))return!1}else{var Y=new Ht;if(h)var oe=h(V,G,W,e,t,Y);if(!(oe===k?er(G,V,b|d,h,Y):oe))return!1}}return!0}function Co(e){if(!$e(e)||uu(e))return!1;var t=ei(e)?kl:Sh;return t.test(bi(e))}function Ac(e){return qe(e)&&ct(e)==Ot}function Bc(e){return qe(e)&&ht(e)==it}function Tc(e){return qe(e)&&Gr(e.length)&&!!We[ct(e)]}function wo(e){return typeof e=="function"?e:e==null?pt:typeof e=="object"?Ce(e)?Eo(e[0],e[1]):yo(e):za(e)}function As(e){if(!rr(e))return Il(e);var t=[];for(var i in He(e))Pe.call(e,i)&&i!="constructor"&&t.push(i);return t}function Mc(e){if(!$e(e))return vu(e);var t=rr(e),i=[];for(var h in e)h=="constructor"&&(t||!Pe.call(e,h))||i.push(h);return i}function Bs(e,t){return e<t}function bo(e,t){var i=-1,h=_t(e)?$(e.length):[];return li(e,function(w,L,B){h[++i]=t(w,L,B)}),h}function yo(e){var t=Vs(e);return t.length==1&&t[0][2]?ra(t[0][0],t[0][1]):function(i){return i===e||ks(i,e,t)}}function Eo(e,t){return js(e)&&ia(t)?ra(Vt(e),t):function(i){var h=nn(i,e);return h===k&&h===t?on(i,e):er(t,h,b|d)}}function Br(e,t,i,h,w){e!==t&&xs(t,function(L,B){if(w||(w=new Ht),$e(L))Oc(e,t,B,i,Br,h,w);else{var I=h?h(Js(e,B),L,B+"",e,t,w):k;I===k&&(I=L),ys(e,B,I)}},vt)}function Oc(e,t,i,h,w,L,B){var I=Js(e,i),W=Js(t,i),V=B.get(W);if(V){ys(e,i,V);return}var G=L?L(I,W,i+"",e,t,B):k,Y=G===k;if(Y){var oe=Ce(W),ce=!oe&&di(W),ve=!oe&&!ce&&Hi(W);G=W,oe||ce||ve?Ce(I)?G=I:Ve(I)?G=dt(I):ce?(Y=!1,G=Po(W,!0)):ve?(Y=!1,G=Ho(W,!0)):G=[]:nr(W)||yi(W)?(G=I,yi(I)?G=Ma(I):(!$e(I)||ei(I))&&(G=ta(W))):Y=!1}Y&&(B.set(W,G),w(G,W,h,L,B),B.delete(W)),ys(e,i,G)}function xo(e,t){var i=e.length;if(i)return t+=t<0?i:0,Qt(t,i)?e[t]:k}function Lo(e,t,i){t.length?t=Ue(t,function(L){return Ce(L)?function(B){return Ci(B,L.length===1?L[0]:L)}:L}):t=[pt];var h=-1;t=Ue(t,mt(_e()));var w=bo(e,function(L,B,I){var W=Ue(t,function(V){return V(L)});return{criteria:W,index:++h,value:L}});return al(w,function(L,B){return Gc(L,B,i)})}function Ic(e,t){return Ro(e,t,function(i,h){return on(e,h)})}function Ro(e,t,i){for(var h=-1,w=t.length,L={};++h<w;){var B=t[h],I=Ci(e,B);i(I,B)&&tr(L,ui(B,e),I)}return L}function Pc(e){return function(t){return Ci(t,e)}}function Ts(e,t,i,h){var w=h?ol:Li,L=-1,B=t.length,I=e;for(e===t&&(t=dt(t)),i&&(I=Ue(e,mt(i)));++L<B;)for(var W=0,V=t[L],G=i?i(V):V;(W=w(I,G,W,h))>-1;)I!==e&&wr.call(I,W,1),wr.call(e,W,1);return e}function Do(e,t){for(var i=e?t.length:0,h=i-1;i--;){var w=t[i];if(i==h||w!==L){var L=w;Qt(w)?wr.call(e,w,1):Ps(e,w)}}return e}function Ms(e,t){return e+Er(ao()*(t-e+1))}function Hc(e,t,i,h){for(var w=-1,L=Qe(yr((t-e)/(i||1)),0),B=$(L);L--;)B[h?L:++w]=e,e+=i;return B}function Os(e,t){var i="";if(!e||t<1||t>ee)return i;do t%2&&(i+=e),t=Er(t/2),t&&(e+=e);while(t);return i}function xe(e,t){return Ys(sa(e,t,pt),e+"")}function Fc(e){return co(Fi(e))}function Wc(e,t){var i=Fi(e);return Nr(i,Si(t,0,i.length))}function tr(e,t,i,h){if(!$e(e))return e;t=ui(t,e);for(var w=-1,L=t.length,B=L-1,I=e;I!=null&&++w<L;){var W=Vt(t[w]),V=i;if(W==="__proto__"||W==="constructor"||W==="prototype")return e;if(w!=B){var G=I[W];V=h?h(G,W,I):k,V===k&&(V=$e(G)?G:Qt(t[w+1])?[]:{})}Yi(I,W,V),I=I[W]}return e}var ko=xr?function(e,t){return xr.set(e,t),e}:pt,Uc=br?function(e,t){return br(e,"toString",{configurable:!0,enumerable:!1,value:hn(t),writable:!0})}:pt;function Nc(e){return Nr(Fi(e))}function Bt(e,t,i){var h=-1,w=e.length;t<0&&(t=-t>w?0:w+t),i=i>w?w:i,i<0&&(i+=w),w=t>i?0:i-t>>>0,t>>>=0;for(var L=$(w);++h<w;)L[h]=e[h+t];return L}function $c(e,t){var i;return li(e,function(h,w,L){return i=t(h,w,L),!i}),!!i}function Tr(e,t,i){var h=0,w=e==null?h:e.length;if(typeof t=="number"&&t===t&&w<=Q){for(;h<w;){var L=h+w>>>1,B=e[L];B!==null&&!Ct(B)&&(i?B<=t:B<t)?h=L+1:w=L}return w}return Is(e,t,pt,i)}function Is(e,t,i,h){var w=0,L=e==null?0:e.length;if(L===0)return 0;t=i(t);for(var B=t!==t,I=t===null,W=Ct(t),V=t===k;w<L;){var G=Er((w+L)/2),Y=i(e[G]),oe=Y!==k,ce=Y===null,ve=Y===Y,be=Ct(Y);if(B)var pe=h||ve;else V?pe=ve&&(h||oe):I?pe=ve&&oe&&(h||!ce):W?pe=ve&&oe&&!ce&&(h||!be):ce||be?pe=!1:pe=h?Y<=t:Y<t;pe?w=G+1:L=G}return at(L,H)}function Ao(e,t){for(var i=-1,h=e.length,w=0,L=[];++i<h;){var B=e[i],I=t?t(B):B;if(!i||!Ft(I,W)){var W=I;L[w++]=B===0?0:B}}return L}function Bo(e){return typeof e=="number"?e:Ct(e)?A:+e}function St(e){if(typeof e=="string")return e;if(Ce(e))return Ue(e,St)+"";if(Ct(e))return ho?ho.call(e):"";var t=e+"";return t=="0"&&1/e==-se?"-0":t}function ci(e,t,i){var h=-1,w=ur,L=e.length,B=!0,I=[],W=I;if(i)B=!1,w=cs;else if(L>=ye){var V=t?null:Qc(e);if(V)return dr(V);B=!1,w=qi,W=new mi}else W=t?[]:I;e:for(;++h<L;){var G=e[h],Y=t?t(G):G;if(G=i||G!==0?G:0,B&&Y===Y){for(var oe=W.length;oe--;)if(W[oe]===Y)continue e;t&&W.push(Y),I.push(G)}else w(W,Y,i)||(W!==I&&W.push(Y),I.push(G))}return I}function Ps(e,t){return t=ui(t,e),e=na(e,t),e==null||delete e[Vt(Tt(t))]}function To(e,t,i,h){return tr(e,t,i(Ci(e,t)),h)}function Mr(e,t,i,h){for(var w=e.length,L=h?w:-1;(h?L--:++L<w)&&t(e[L],L,e););return i?Bt(e,h?0:L,h?L+1:w):Bt(e,h?L+1:0,h?w:L)}function Mo(e,t){var i=e;return i instanceof De&&(i=i.value()),us(t,function(h,w){return w.func.apply(w.thisArg,oi([h],w.args))},i)}function Hs(e,t,i){var h=e.length;if(h<2)return h?ci(e[0]):[];for(var w=-1,L=$(h);++w<h;)for(var B=e[w],I=-1;++I<h;)I!=w&&(L[w]=Zi(L[w]||B,e[I],t,i));return ci(nt(L,1),t,i)}function Oo(e,t,i){for(var h=-1,w=e.length,L=t.length,B={};++h<w;){var I=h<L?t[h]:k;i(B,e[h],I)}return B}function Fs(e){return Ve(e)?e:[]}function Ws(e){return typeof e=="function"?e:pt}function ui(e,t){return Ce(e)?e:js(e,t)?[e]:la(Oe(e))}var zc=xe;function fi(e,t,i){var h=e.length;return i=i===k?h:i,!t&&i>=h?e:Bt(e,t,i)}var Io=Al||function(e){return st.clearTimeout(e)};function Po(e,t){if(t)return e.slice();var i=e.length,h=io?io(i):new e.constructor(i);return e.copy(h),h}function Us(e){var t=new e.constructor(e.byteLength);return new Sr(t).set(new Sr(e)),t}function Kc(e,t){var i=t?Us(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.byteLength)}function qc(e){var t=new e.constructor(e.source,mn.exec(e));return t.lastIndex=e.lastIndex,t}function Vc(e){return Ji?He(Ji.call(e)):{}}function Ho(e,t){var i=t?Us(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.length)}function Fo(e,t){if(e!==t){var i=e!==k,h=e===null,w=e===e,L=Ct(e),B=t!==k,I=t===null,W=t===t,V=Ct(t);if(!I&&!V&&!L&&e>t||L&&B&&W&&!I&&!V||h&&B&&W||!i&&W||!w)return 1;if(!h&&!L&&!V&&e<t||V&&i&&w&&!h&&!L||I&&i&&w||!B&&w||!W)return-1}return 0}function Gc(e,t,i){for(var h=-1,w=e.criteria,L=t.criteria,B=w.length,I=i.length;++h<B;){var W=Fo(w[h],L[h]);if(W){if(h>=I)return W;var V=i[h];return W*(V=="desc"?-1:1)}}return e.index-t.index}function Wo(e,t,i,h){for(var w=-1,L=e.length,B=i.length,I=-1,W=t.length,V=Qe(L-B,0),G=$(W+V),Y=!h;++I<W;)G[I]=t[I];for(;++w<B;)(Y||w<L)&&(G[i[w]]=e[w]);for(;V--;)G[I++]=e[w++];return G}function Uo(e,t,i,h){for(var w=-1,L=e.length,B=-1,I=i.length,W=-1,V=t.length,G=Qe(L-I,0),Y=$(G+V),oe=!h;++w<G;)Y[w]=e[w];for(var ce=w;++W<V;)Y[ce+W]=t[W];for(;++B<I;)(oe||w<L)&&(Y[ce+i[B]]=e[w++]);return Y}function dt(e,t){var i=-1,h=e.length;for(t||(t=$(h));++i<h;)t[i]=e[i];return t}function qt(e,t,i,h){var w=!i;i||(i={});for(var L=-1,B=t.length;++L<B;){var I=t[L],W=h?h(i[I],e[I],I,i,e):k;W===k&&(W=e[I]),w?Jt(i,I,W):Yi(i,I,W)}return i}function jc(e,t){return qt(e,Gs(e),t)}function Xc(e,t){return qt(e,Qo(e),t)}function Or(e,t){return function(i,h){var w=Ce(i)?el:gc,L=t?t():{};return w(i,e,_e(h,2),L)}}function Oi(e){return xe(function(t,i){var h=-1,w=i.length,L=w>1?i[w-1]:k,B=w>2?i[2]:k;for(L=e.length>3&&typeof L=="function"?(w--,L):k,B&&ut(i[0],i[1],B)&&(L=w<3?k:L,w=1),t=He(t);++h<w;){var I=i[h];I&&e(t,I,h,L)}return t})}function No(e,t){return function(i,h){if(i==null)return i;if(!_t(i))return e(i,h);for(var w=i.length,L=t?w:-1,B=He(i);(t?L--:++L<w)&&h(B[L],L,B)!==!1;);return i}}function $o(e){return function(t,i,h){for(var w=-1,L=He(t),B=h(t),I=B.length;I--;){var W=B[e?I:++w];if(i(L[W],W,L)===!1)break}return t}}function Jc(e,t,i){var h=t&s,w=ir(e);function L(){var B=this&&this!==st&&this instanceof L?w:e;return B.apply(h?i:this,arguments)}return L}function zo(e){return function(t){t=Oe(t);var i=Ri(t)?Pt(t):k,h=i?i[0]:t.charAt(0),w=i?fi(i,1).join(""):t.slice(1);return h[e]()+w}}function Ii(e){return function(t){return us(Na(Ua(t).replace(Uh,"")),e,"")}}function ir(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var i=Mi(e.prototype),h=e.apply(i,t);return $e(h)?h:i}}function Yc(e,t,i){var h=ir(e);function w(){for(var L=arguments.length,B=$(L),I=L,W=Pi(w);I--;)B[I]=arguments[I];var V=L<3&&B[0]!==W&&B[L-1]!==W?[]:ai(B,W);if(L-=V.length,L<i)return jo(e,t,Ir,w.placeholder,k,B,V,k,k,i-L);var G=this&&this!==st&&this instanceof w?h:e;return gt(G,this,B)}return w}function Ko(e){return function(t,i,h){var w=He(t);if(!_t(t)){var L=_e(i,3);t=tt(t),i=function(I){return L(w[I],I,w)}}var B=e(t,i,h);return B>-1?w[L?t[B]:B]:k}}function qo(e){return Zt(function(t){var i=t.length,h=i,w=kt.prototype.thru;for(e&&t.reverse();h--;){var L=t[h];if(typeof L!="function")throw new Dt(j);if(w&&!B&&Wr(L)=="wrapper")var B=new kt([],!0)}for(h=B?h:i;++h<i;){L=t[h];var I=Wr(L),W=I=="wrapper"?qs(L):k;W&&Xs(W[0])&&W[1]==(C|n|g|f)&&!W[4].length&&W[9]==1?B=B[Wr(W[0])].apply(B,W[3]):B=L.length==1&&Xs(L)?B[I]():B.thru(L)}return function(){var V=arguments,G=V[0];if(B&&V.length==1&&Ce(G))return B.plant(G).value();for(var Y=0,oe=i?t[Y].apply(this,V):G;++Y<i;)oe=t[Y].call(this,oe);return oe}})}function Ir(e,t,i,h,w,L,B,I,W,V){var G=t&C,Y=t&s,oe=t&o,ce=t&(n|c),ve=t&y,be=oe?k:ir(e);function pe(){for(var Re=arguments.length,Ae=$(Re),wt=Re;wt--;)Ae[wt]=arguments[wt];if(ce)var ft=Pi(pe),bt=ll(Ae,ft);if(h&&(Ae=Wo(Ae,h,w,ce)),L&&(Ae=Uo(Ae,L,B,ce)),Re-=bt,ce&&Re<V){var Ge=ai(Ae,ft);return jo(e,t,Ir,pe.placeholder,i,Ae,Ge,I,W,V-Re)}var Wt=Y?i:this,ii=oe?Wt[e]:e;return Re=Ae.length,I?Ae=gu(Ae,I):ve&&Re>1&&Ae.reverse(),G&&W<Re&&(Ae.length=W),this&&this!==st&&this instanceof pe&&(ii=be||ir(ii)),ii.apply(Wt,Ae)}return pe}function Vo(e,t){return function(i,h){return xc(i,e,t(h),{})}}function Pr(e,t){return function(i,h){var w;if(i===k&&h===k)return t;if(i!==k&&(w=i),h!==k){if(w===k)return h;typeof i=="string"||typeof h=="string"?(i=St(i),h=St(h)):(i=Bo(i),h=Bo(h)),w=e(i,h)}return w}}function Ns(e){return Zt(function(t){return t=Ue(t,mt(_e())),xe(function(i){var h=this;return e(t,function(w){return gt(w,h,i)})})})}function Hr(e,t){t=t===k?" ":St(t);var i=t.length;if(i<2)return i?Os(t,e):t;var h=Os(t,yr(e/Di(t)));return Ri(t)?fi(Pt(h),0,e).join(""):h.slice(0,e)}function Zc(e,t,i,h){var w=t&s,L=ir(e);function B(){for(var I=-1,W=arguments.length,V=-1,G=h.length,Y=$(G+W),oe=this&&this!==st&&this instanceof B?L:e;++V<G;)Y[V]=h[V];for(;W--;)Y[V++]=arguments[++I];return gt(oe,w?i:this,Y)}return B}function Go(e){return function(t,i,h){return h&&typeof h!="number"&&ut(t,i,h)&&(i=h=k),t=ti(t),i===k?(i=t,t=0):i=ti(i),h=h===k?t<i?1:-1:ti(h),Hc(t,i,h,e)}}function Fr(e){return function(t,i){return typeof t=="string"&&typeof i=="string"||(t=Mt(t),i=Mt(i)),e(t,i)}}function jo(e,t,i,h,w,L,B,I,W,V){var G=t&n,Y=G?B:k,oe=G?k:B,ce=G?L:k,ve=G?k:L;t|=G?g:S,t&=~(G?S:g),t&r||(t&=~(s|o));var be=[e,t,w,ce,Y,ve,oe,I,W,V],pe=i.apply(k,be);return Xs(e)&&oa(pe,be),pe.placeholder=h,aa(pe,e,t)}function $s(e){var t=Ze[e];return function(i,h){if(i=Mt(i),h=h==null?0:at(we(h),292),h&&oo(i)){var w=(Oe(i)+"e").split("e"),L=t(w[0]+"e"+(+w[1]+h));return w=(Oe(L)+"e").split("e"),+(w[0]+"e"+(+w[1]-h))}return t(i)}}var Qc=Bi&&1/dr(new Bi([,-0]))[1]==se?function(e){return new Bi(e)}:un;function Xo(e){return function(t){var i=ht(t);return i==Le?ms(t):i==it?pl(t):hl(t,e(t))}}function Yt(e,t,i,h,w,L,B,I){var W=t&o;if(!W&&typeof e!="function")throw new Dt(j);var V=h?h.length:0;if(V||(t&=~(g|S),h=w=k),B=B===k?B:Qe(we(B),0),I=I===k?I:we(I),V-=w?w.length:0,t&S){var G=h,Y=w;h=w=k}var oe=W?k:qs(e),ce=[e,t,i,h,w,G,Y,L,B,I];if(oe&&_u(ce,oe),e=ce[0],t=ce[1],i=ce[2],h=ce[3],w=ce[4],I=ce[9]=ce[9]===k?W?0:e.length:Qe(ce[9]-V,0),!I&&t&(n|c)&&(t&=~(n|c)),!t||t==s)var ve=Jc(e,t,i);else t==n||t==c?ve=Yc(e,t,I):(t==g||t==(s|g))&&!w.length?ve=Zc(e,t,i,h):ve=Ir.apply(k,ce);var be=oe?ko:oa;return aa(be(ve,ce),e,t)}function Jo(e,t,i,h){return e===k||Ft(e,Ai[i])&&!Pe.call(h,i)?t:e}function Yo(e,t,i,h,w,L){return $e(e)&&$e(t)&&(L.set(t,e),Br(e,t,k,Yo,L),L.delete(t)),e}function eu(e){return nr(e)?k:e}function Zo(e,t,i,h,w,L){var B=i&b,I=e.length,W=t.length;if(I!=W&&!(B&&W>I))return!1;var V=L.get(e),G=L.get(t);if(V&&G)return V==t&&G==e;var Y=-1,oe=!0,ce=i&d?new mi:k;for(L.set(e,t),L.set(t,e);++Y<I;){var ve=e[Y],be=t[Y];if(h)var pe=B?h(be,ve,Y,t,e,L):h(ve,be,Y,e,t,L);if(pe!==k){if(pe)continue;oe=!1;break}if(ce){if(!fs(t,function(Re,Ae){if(!qi(ce,Ae)&&(ve===Re||w(ve,Re,i,h,L)))return ce.push(Ae)})){oe=!1;break}}else if(!(ve===be||w(ve,be,i,h,L))){oe=!1;break}}return L.delete(e),L.delete(t),oe}function tu(e,t,i,h,w,L,B){switch(i){case et:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Ke:return!(e.byteLength!=t.byteLength||!L(new Sr(e),new Sr(t)));case R:case J:case Me:return Ft(+e,+t);case ne:return e.name==t.name&&e.message==t.message;case Ot:case xt:return e==t+"";case Le:var I=ms;case it:var W=h&b;if(I||(I=dr),e.size!=t.size&&!W)return!1;var V=B.get(e);if(V)return V==t;h|=d,B.set(e,t);var G=Zo(I(e),I(t),h,w,L,B);return B.delete(e),G;case q:if(Ji)return Ji.call(e)==Ji.call(t)}return!1}function iu(e,t,i,h,w,L){var B=i&b,I=zs(e),W=I.length,V=zs(t),G=V.length;if(W!=G&&!B)return!1;for(var Y=W;Y--;){var oe=I[Y];if(!(B?oe in t:Pe.call(t,oe)))return!1}var ce=L.get(e),ve=L.get(t);if(ce&&ve)return ce==t&&ve==e;var be=!0;L.set(e,t),L.set(t,e);for(var pe=B;++Y<W;){oe=I[Y];var Re=e[oe],Ae=t[oe];if(h)var wt=B?h(Ae,Re,oe,t,e,L):h(Re,Ae,oe,e,t,L);if(!(wt===k?Re===Ae||w(Re,Ae,i,h,L):wt)){be=!1;break}pe||(pe=oe=="constructor")}if(be&&!pe){var ft=e.constructor,bt=t.constructor;ft!=bt&&"constructor"in e&&"constructor"in t&&!(typeof ft=="function"&&ft instanceof ft&&typeof bt=="function"&&bt instanceof bt)&&(be=!1)}return L.delete(e),L.delete(t),be}function Zt(e){return Ys(sa(e,k,da),e+"")}function zs(e){return mo(e,tt,Gs)}function Ks(e){return mo(e,vt,Qo)}var qs=xr?function(e){return xr.get(e)}:un;function Wr(e){for(var t=e.name+"",i=Ti[t],h=Pe.call(Ti,t)?i.length:0;h--;){var w=i[h],L=w.func;if(L==null||L==e)return w.name}return t}function Pi(e){var t=Pe.call(x,"placeholder")?x:e;return t.placeholder}function _e(){var e=x.iteratee||ln;return e=e===ln?wo:e,arguments.length?e(arguments[0],arguments[1]):e}function Ur(e,t){var i=e.__data__;return cu(t)?i[typeof t=="string"?"string":"hash"]:i.map}function Vs(e){for(var t=tt(e),i=t.length;i--;){var h=t[i],w=e[h];t[i]=[h,w,ia(w)]}return t}function wi(e,t){var i=dl(e,t);return Co(i)?i:k}function ru(e){var t=Pe.call(e,pi),i=e[pi];try{e[pi]=k;var h=!0}catch{}var w=gr.call(e);return h&&(t?e[pi]=i:delete e[pi]),w}var Gs=Cs?function(e){return e==null?[]:(e=He(e),ni(Cs(e),function(t){return so.call(e,t)}))}:fn,Qo=Cs?function(e){for(var t=[];e;)oi(t,Gs(e)),e=Cr(e);return t}:fn,ht=ct;(ws&&ht(new ws(new ArrayBuffer(1)))!=et||Gi&&ht(new Gi)!=Le||bs&&ht(bs.resolve())!=$t||Bi&&ht(new Bi)!=it||ji&&ht(new ji)!=he)&&(ht=function(e){var t=ct(e),i=t==ue?e.constructor:k,h=i?bi(i):"";if(h)switch(h){case Wl:return et;case Ul:return Le;case Nl:return $t;case $l:return it;case zl:return he}return t});function su(e,t,i){for(var h=-1,w=i.length;++h<w;){var L=i[h],B=L.size;switch(L.type){case"drop":e+=B;break;case"dropRight":t-=B;break;case"take":t=at(t,e+B);break;case"takeRight":e=Qe(e,t-B);break}}return{start:e,end:t}}function nu(e){var t=e.match(uh);return t?t[1].split(fh):[]}function ea(e,t,i){t=ui(t,e);for(var h=-1,w=t.length,L=!1;++h<w;){var B=Vt(t[h]);if(!(L=e!=null&&i(e,B)))break;e=e[B]}return L||++h!=w?L:(w=e==null?0:e.length,!!w&&Gr(w)&&Qt(B,w)&&(Ce(e)||yi(e)))}function ou(e){var t=e.length,i=new e.constructor(t);return t&&typeof e[0]=="string"&&Pe.call(e,"index")&&(i.index=e.index,i.input=e.input),i}function ta(e){return typeof e.constructor=="function"&&!rr(e)?Mi(Cr(e)):{}}function au(e,t,i){var h=e.constructor;switch(t){case Ke:return Us(e);case R:case J:return new h(+e);case et:return Kc(e,i);case zt:case rt:case It:case Ie:case Gt:case Ui:case Ni:case $i:case zi:return Ho(e,i);case Le:return new h;case Me:case xt:return new h(e);case Ot:return qc(e);case it:return new h;case q:return Vc(e)}}function hu(e,t){var i=t.length;if(!i)return e;var h=i-1;return t[h]=(i>1?"& ":"")+t[h],t=t.join(i>2?", ":" "),e.replace(ch,`{
/* [wrapped with `+t+`] */
`)}function lu(e){return Ce(e)||yi(e)||!!(no&&e&&e[no])}function Qt(e,t){var i=typeof e;return t=t??ee,!!t&&(i=="number"||i!="symbol"&&wh.test(e))&&e>-1&&e%1==0&&e<t}function ut(e,t,i){if(!$e(i))return!1;var h=typeof t;return(h=="number"?_t(i)&&Qt(t,i.length):h=="string"&&t in i)?Ft(i[t],e):!1}function js(e,t){if(Ce(e))return!1;var i=typeof e;return i=="number"||i=="symbol"||i=="boolean"||e==null||Ct(e)?!0:oh.test(e)||!nh.test(e)||t!=null&&e in He(t)}function cu(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function Xs(e){var t=Wr(e),i=x[t];if(typeof i!="function"||!(t in De.prototype))return!1;if(e===i)return!0;var h=qs(i);return!!h&&e===h[0]}function uu(e){return!!to&&to in e}var fu=vr?ei:dn;function rr(e){var t=e&&e.constructor,i=typeof t=="function"&&t.prototype||Ai;return e===i}function ia(e){return e===e&&!$e(e)}function ra(e,t){return function(i){return i==null?!1:i[e]===t&&(t!==k||e in He(i))}}function du(e){var t=qr(e,function(h){return i.size===_&&i.clear(),h}),i=t.cache;return t}function _u(e,t){var i=e[1],h=t[1],w=i|h,L=w<(s|o|C),B=h==C&&i==n||h==C&&i==f&&e[7].length<=t[8]||h==(C|f)&&t[7].length<=t[8]&&i==n;if(!(L||B))return e;h&s&&(e[2]=t[2],w|=i&s?0:r);var I=t[3];if(I){var W=e[3];e[3]=W?Wo(W,I,t[4]):I,e[4]=W?ai(e[3],p):t[4]}return I=t[5],I&&(W=e[5],e[5]=W?Uo(W,I,t[6]):I,e[6]=W?ai(e[5],p):t[6]),I=t[7],I&&(e[7]=I),h&C&&(e[8]=e[8]==null?t[8]:at(e[8],t[8])),e[9]==null&&(e[9]=t[9]),e[0]=t[0],e[1]=w,e}function vu(e){var t=[];if(e!=null)for(var i in He(e))t.push(i);return t}function pu(e){return gr.call(e)}function sa(e,t,i){return t=Qe(t===k?e.length-1:t,0),function(){for(var h=arguments,w=-1,L=Qe(h.length-t,0),B=$(L);++w<L;)B[w]=h[t+w];w=-1;for(var I=$(t+1);++w<t;)I[w]=h[w];return I[t]=i(B),gt(e,this,I)}}function na(e,t){return t.length<2?e:Ci(e,Bt(t,0,-1))}function gu(e,t){for(var i=e.length,h=at(t.length,i),w=dt(e);h--;){var L=t[h];e[h]=Qt(L,i)?w[L]:k}return e}function Js(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var oa=ha(ko),sr=Tl||function(e,t){return st.setTimeout(e,t)},Ys=ha(Uc);function aa(e,t,i){var h=t+"";return Ys(e,hu(h,mu(nu(h),i)))}function ha(e){var t=0,i=0;return function(){var h=Pl(),w=D-(h-i);if(i=h,w>0){if(++t>=P)return arguments[0]}else t=0;return e.apply(k,arguments)}}function Nr(e,t){var i=-1,h=e.length,w=h-1;for(t=t===k?h:t;++i<t;){var L=Ms(i,w),B=e[L];e[L]=e[i],e[i]=B}return e.length=t,e}var la=du(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(ah,function(i,h,w,L){t.push(w?L.replace(vh,"$1"):h||i)}),t});function Vt(e){if(typeof e=="string"||Ct(e))return e;var t=e+"";return t=="0"&&1/e==-se?"-0":t}function bi(e){if(e!=null){try{return pr.call(e)}catch{}try{return e+""}catch{}}return""}function mu(e,t){return Rt(re,function(i){var h="_."+i[0];t&i[1]&&!ur(e,h)&&e.push(h)}),e.sort()}function ca(e){if(e instanceof De)return e.clone();var t=new kt(e.__wrapped__,e.__chain__);return t.__actions__=dt(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}function Su(e,t,i){(i?ut(e,t,i):t===k)?t=1:t=Qe(we(t),0);var h=e==null?0:e.length;if(!h||t<1)return[];for(var w=0,L=0,B=$(yr(h/t));w<h;)B[L++]=Bt(e,w,w+=t);return B}function Cu(e){for(var t=-1,i=e==null?0:e.length,h=0,w=[];++t<i;){var L=e[t];L&&(w[h++]=L)}return w}function wu(){var e=arguments.length;if(!e)return[];for(var t=$(e-1),i=arguments[0],h=e;h--;)t[h-1]=arguments[h];return oi(Ce(i)?dt(i):[i],nt(t,1))}var bu=xe(function(e,t){return Ve(e)?Zi(e,nt(t,1,Ve,!0)):[]}),yu=xe(function(e,t){var i=Tt(t);return Ve(i)&&(i=k),Ve(e)?Zi(e,nt(t,1,Ve,!0),_e(i,2)):[]}),Eu=xe(function(e,t){var i=Tt(t);return Ve(i)&&(i=k),Ve(e)?Zi(e,nt(t,1,Ve,!0),k,i):[]});function xu(e,t,i){var h=e==null?0:e.length;return h?(t=i||t===k?1:we(t),Bt(e,t<0?0:t,h)):[]}function Lu(e,t,i){var h=e==null?0:e.length;return h?(t=i||t===k?1:we(t),t=h-t,Bt(e,0,t<0?0:t)):[]}function Ru(e,t){return e&&e.length?Mr(e,_e(t,3),!0,!0):[]}function Du(e,t){return e&&e.length?Mr(e,_e(t,3),!0):[]}function ku(e,t,i,h){var w=e==null?0:e.length;return w?(i&&typeof i!="number"&&ut(e,t,i)&&(i=0,h=w),wc(e,t,i,h)):[]}function ua(e,t,i){var h=e==null?0:e.length;if(!h)return-1;var w=i==null?0:we(i);return w<0&&(w=Qe(h+w,0)),fr(e,_e(t,3),w)}function fa(e,t,i){var h=e==null?0:e.length;if(!h)return-1;var w=h-1;return i!==k&&(w=we(i),w=i<0?Qe(h+w,0):at(w,h-1)),fr(e,_e(t,3),w,!0)}function da(e){var t=e==null?0:e.length;return t?nt(e,1):[]}function Au(e){var t=e==null?0:e.length;return t?nt(e,se):[]}function Bu(e,t){var i=e==null?0:e.length;return i?(t=t===k?1:we(t),nt(e,t)):[]}function Tu(e){for(var t=-1,i=e==null?0:e.length,h={};++t<i;){var w=e[t];h[w[0]]=w[1]}return h}function _a(e){return e&&e.length?e[0]:k}function Mu(e,t,i){var h=e==null?0:e.length;if(!h)return-1;var w=i==null?0:we(i);return w<0&&(w=Qe(h+w,0)),Li(e,t,w)}function Ou(e){var t=e==null?0:e.length;return t?Bt(e,0,-1):[]}var Iu=xe(function(e){var t=Ue(e,Fs);return t.length&&t[0]===e[0]?Ds(t):[]}),Pu=xe(function(e){var t=Tt(e),i=Ue(e,Fs);return t===Tt(i)?t=k:i.pop(),i.length&&i[0]===e[0]?Ds(i,_e(t,2)):[]}),Hu=xe(function(e){var t=Tt(e),i=Ue(e,Fs);return t=typeof t=="function"?t:k,t&&i.pop(),i.length&&i[0]===e[0]?Ds(i,k,t):[]});function Fu(e,t){return e==null?"":Ol.call(e,t)}function Tt(e){var t=e==null?0:e.length;return t?e[t-1]:k}function Wu(e,t,i){var h=e==null?0:e.length;if(!h)return-1;var w=h;return i!==k&&(w=we(i),w=w<0?Qe(h+w,0):at(w,h-1)),t===t?ml(e,t,w):fr(e,Gn,w,!0)}function Uu(e,t){return e&&e.length?xo(e,we(t)):k}var Nu=xe(va);function va(e,t){return e&&e.length&&t&&t.length?Ts(e,t):e}function $u(e,t,i){return e&&e.length&&t&&t.length?Ts(e,t,_e(i,2)):e}function zu(e,t,i){return e&&e.length&&t&&t.length?Ts(e,t,k,i):e}var Ku=Zt(function(e,t){var i=e==null?0:e.length,h=Es(e,t);return Do(e,Ue(t,function(w){return Qt(w,i)?+w:w}).sort(Fo)),h});function qu(e,t){var i=[];if(!(e&&e.length))return i;var h=-1,w=[],L=e.length;for(t=_e(t,3);++h<L;){var B=e[h];t(B,h,e)&&(i.push(B),w.push(h))}return Do(e,w),i}function Zs(e){return e==null?e:Fl.call(e)}function Vu(e,t,i){var h=e==null?0:e.length;return h?(i&&typeof i!="number"&&ut(e,t,i)?(t=0,i=h):(t=t==null?0:we(t),i=i===k?h:we(i)),Bt(e,t,i)):[]}function Gu(e,t){return Tr(e,t)}function ju(e,t,i){return Is(e,t,_e(i,2))}function Xu(e,t){var i=e==null?0:e.length;if(i){var h=Tr(e,t);if(h<i&&Ft(e[h],t))return h}return-1}function Ju(e,t){return Tr(e,t,!0)}function Yu(e,t,i){return Is(e,t,_e(i,2),!0)}function Zu(e,t){var i=e==null?0:e.length;if(i){var h=Tr(e,t,!0)-1;if(Ft(e[h],t))return h}return-1}function Qu(e){return e&&e.length?Ao(e):[]}function ef(e,t){return e&&e.length?Ao(e,_e(t,2)):[]}function tf(e){var t=e==null?0:e.length;return t?Bt(e,1,t):[]}function rf(e,t,i){return e&&e.length?(t=i||t===k?1:we(t),Bt(e,0,t<0?0:t)):[]}function sf(e,t,i){var h=e==null?0:e.length;return h?(t=i||t===k?1:we(t),t=h-t,Bt(e,t<0?0:t,h)):[]}function nf(e,t){return e&&e.length?Mr(e,_e(t,3),!1,!0):[]}function of(e,t){return e&&e.length?Mr(e,_e(t,3)):[]}var af=xe(function(e){return ci(nt(e,1,Ve,!0))}),hf=xe(function(e){var t=Tt(e);return Ve(t)&&(t=k),ci(nt(e,1,Ve,!0),_e(t,2))}),lf=xe(function(e){var t=Tt(e);return t=typeof t=="function"?t:k,ci(nt(e,1,Ve,!0),k,t)});function cf(e){return e&&e.length?ci(e):[]}function uf(e,t){return e&&e.length?ci(e,_e(t,2)):[]}function ff(e,t){return t=typeof t=="function"?t:k,e&&e.length?ci(e,k,t):[]}function Qs(e){if(!(e&&e.length))return[];var t=0;return e=ni(e,function(i){if(Ve(i))return t=Qe(i.length,t),!0}),ps(t,function(i){return Ue(e,ds(i))})}function pa(e,t){if(!(e&&e.length))return[];var i=Qs(e);return t==null?i:Ue(i,function(h){return gt(t,k,h)})}var df=xe(function(e,t){return Ve(e)?Zi(e,t):[]}),_f=xe(function(e){return Hs(ni(e,Ve))}),vf=xe(function(e){var t=Tt(e);return Ve(t)&&(t=k),Hs(ni(e,Ve),_e(t,2))}),pf=xe(function(e){var t=Tt(e);return t=typeof t=="function"?t:k,Hs(ni(e,Ve),k,t)}),gf=xe(Qs);function mf(e,t){return Oo(e||[],t||[],Yi)}function Sf(e,t){return Oo(e||[],t||[],tr)}var Cf=xe(function(e){var t=e.length,i=t>1?e[t-1]:k;return i=typeof i=="function"?(e.pop(),i):k,pa(e,i)});function ga(e){var t=x(e);return t.__chain__=!0,t}function wf(e,t){return t(e),e}function $r(e,t){return t(e)}var bf=Zt(function(e){var t=e.length,i=t?e[0]:0,h=this.__wrapped__,w=function(L){return Es(L,e)};return t>1||this.__actions__.length||!(h instanceof De)||!Qt(i)?this.thru(w):(h=h.slice(i,+i+(t?1:0)),h.__actions__.push({func:$r,args:[w],thisArg:k}),new kt(h,this.__chain__).thru(function(L){return t&&!L.length&&L.push(k),L}))});function yf(){return ga(this)}function Ef(){return new kt(this.value(),this.__chain__)}function xf(){this.__values__===k&&(this.__values__=Ba(this.value()));var e=this.__index__>=this.__values__.length,t=e?k:this.__values__[this.__index__++];return{done:e,value:t}}function Lf(){return this}function Rf(e){for(var t,i=this;i instanceof Rr;){var h=ca(i);h.__index__=0,h.__values__=k,t?w.__wrapped__=h:t=h;var w=h;i=i.__wrapped__}return w.__wrapped__=e,t}function Df(){var e=this.__wrapped__;if(e instanceof De){var t=e;return this.__actions__.length&&(t=new De(this)),t=t.reverse(),t.__actions__.push({func:$r,args:[Zs],thisArg:k}),new kt(t,this.__chain__)}return this.thru(Zs)}function kf(){return Mo(this.__wrapped__,this.__actions__)}var Af=Or(function(e,t,i){Pe.call(e,i)?++e[i]:Jt(e,i,1)});function Bf(e,t,i){var h=Ce(e)?qn:Cc;return i&&ut(e,t,i)&&(t=k),h(e,_e(t,3))}function Tf(e,t){var i=Ce(e)?ni:po;return i(e,_e(t,3))}var Mf=Ko(ua),Of=Ko(fa);function If(e,t){return nt(zr(e,t),1)}function Pf(e,t){return nt(zr(e,t),se)}function Hf(e,t,i){return i=i===k?1:we(i),nt(zr(e,t),i)}function ma(e,t){var i=Ce(e)?Rt:li;return i(e,_e(t,3))}function Sa(e,t){var i=Ce(e)?tl:vo;return i(e,_e(t,3))}var Ff=Or(function(e,t,i){Pe.call(e,i)?e[i].push(t):Jt(e,i,[t])});function Wf(e,t,i,h){e=_t(e)?e:Fi(e),i=i&&!h?we(i):0;var w=e.length;return i<0&&(i=Qe(w+i,0)),jr(e)?i<=w&&e.indexOf(t,i)>-1:!!w&&Li(e,t,i)>-1}var Uf=xe(function(e,t,i){var h=-1,w=typeof t=="function",L=_t(e)?$(e.length):[];return li(e,function(B){L[++h]=w?gt(t,B,i):Qi(B,t,i)}),L}),Nf=Or(function(e,t,i){Jt(e,i,t)});function zr(e,t){var i=Ce(e)?Ue:bo;return i(e,_e(t,3))}function $f(e,t,i,h){return e==null?[]:(Ce(t)||(t=t==null?[]:[t]),i=h?k:i,Ce(i)||(i=i==null?[]:[i]),Lo(e,t,i))}var zf=Or(function(e,t,i){e[i?0:1].push(t)},function(){return[[],[]]});function Kf(e,t,i){var h=Ce(e)?us:Xn,w=arguments.length<3;return h(e,_e(t,4),i,w,li)}function qf(e,t,i){var h=Ce(e)?il:Xn,w=arguments.length<3;return h(e,_e(t,4),i,w,vo)}function Vf(e,t){var i=Ce(e)?ni:po;return i(e,Vr(_e(t,3)))}function Gf(e){var t=Ce(e)?co:Fc;return t(e)}function jf(e,t,i){(i?ut(e,t,i):t===k)?t=1:t=we(t);var h=Ce(e)?vc:Wc;return h(e,t)}function Xf(e){var t=Ce(e)?pc:Nc;return t(e)}function Jf(e){if(e==null)return 0;if(_t(e))return jr(e)?Di(e):e.length;var t=ht(e);return t==Le||t==it?e.size:As(e).length}function Yf(e,t,i){var h=Ce(e)?fs:$c;return i&&ut(e,t,i)&&(t=k),h(e,_e(t,3))}var Zf=xe(function(e,t){if(e==null)return[];var i=t.length;return i>1&&ut(e,t[0],t[1])?t=[]:i>2&&ut(t[0],t[1],t[2])&&(t=[t[0]]),Lo(e,nt(t,1),[])}),Kr=Bl||function(){return st.Date.now()};function Qf(e,t){if(typeof t!="function")throw new Dt(j);return e=we(e),function(){if(--e<1)return t.apply(this,arguments)}}function Ca(e,t,i){return t=i?k:t,t=e&&t==null?e.length:t,Yt(e,C,k,k,k,k,t)}function wa(e,t){var i;if(typeof t!="function")throw new Dt(j);return e=we(e),function(){return--e>0&&(i=t.apply(this,arguments)),e<=1&&(t=k),i}}var en=xe(function(e,t,i){var h=s;if(i.length){var w=ai(i,Pi(en));h|=g}return Yt(e,h,t,i,w)}),ba=xe(function(e,t,i){var h=s|o;if(i.length){var w=ai(i,Pi(ba));h|=g}return Yt(t,h,e,i,w)});function ya(e,t,i){t=i?k:t;var h=Yt(e,n,k,k,k,k,k,t);return h.placeholder=ya.placeholder,h}function Ea(e,t,i){t=i?k:t;var h=Yt(e,c,k,k,k,k,k,t);return h.placeholder=Ea.placeholder,h}function xa(e,t,i){var h,w,L,B,I,W,V=0,G=!1,Y=!1,oe=!0;if(typeof e!="function")throw new Dt(j);t=Mt(t)||0,$e(i)&&(G=!!i.leading,Y="maxWait"in i,L=Y?Qe(Mt(i.maxWait)||0,t):L,oe="trailing"in i?!!i.trailing:oe);function ce(Ge){var Wt=h,ii=w;return h=w=k,V=Ge,B=e.apply(ii,Wt),B}function ve(Ge){return V=Ge,I=sr(Re,t),G?ce(Ge):B}function be(Ge){var Wt=Ge-W,ii=Ge-V,Ka=t-Wt;return Y?at(Ka,L-ii):Ka}function pe(Ge){var Wt=Ge-W,ii=Ge-V;return W===k||Wt>=t||Wt<0||Y&&ii>=L}function Re(){var Ge=Kr();if(pe(Ge))return Ae(Ge);I=sr(Re,be(Ge))}function Ae(Ge){return I=k,oe&&h?ce(Ge):(h=w=k,B)}function wt(){I!==k&&Io(I),V=0,h=W=w=I=k}function ft(){return I===k?B:Ae(Kr())}function bt(){var Ge=Kr(),Wt=pe(Ge);if(h=arguments,w=this,W=Ge,Wt){if(I===k)return ve(W);if(Y)return Io(I),I=sr(Re,t),ce(W)}return I===k&&(I=sr(Re,t)),B}return bt.cancel=wt,bt.flush=ft,bt}var ed=xe(function(e,t){return _o(e,1,t)}),td=xe(function(e,t,i){return _o(e,Mt(t)||0,i)});function id(e){return Yt(e,y)}function qr(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new Dt(j);var i=function(){var h=arguments,w=t?t.apply(this,h):h[0],L=i.cache;if(L.has(w))return L.get(w);var B=e.apply(this,h);return i.cache=L.set(w,B)||L,B};return i.cache=new(qr.Cache||Xt),i}qr.Cache=Xt;function Vr(e){if(typeof e!="function")throw new Dt(j);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function rd(e){return wa(2,e)}var sd=zc(function(e,t){t=t.length==1&&Ce(t[0])?Ue(t[0],mt(_e())):Ue(nt(t,1),mt(_e()));var i=t.length;return xe(function(h){for(var w=-1,L=at(h.length,i);++w<L;)h[w]=t[w].call(this,h[w]);return gt(e,this,h)})}),tn=xe(function(e,t){var i=ai(t,Pi(tn));return Yt(e,g,k,t,i)}),La=xe(function(e,t){var i=ai(t,Pi(La));return Yt(e,S,k,t,i)}),nd=Zt(function(e,t){return Yt(e,f,k,k,k,t)});function od(e,t){if(typeof e!="function")throw new Dt(j);return t=t===k?t:we(t),xe(e,t)}function ad(e,t){if(typeof e!="function")throw new Dt(j);return t=t==null?0:Qe(we(t),0),xe(function(i){var h=i[t],w=fi(i,0,t);return h&&oi(w,h),gt(e,this,w)})}function hd(e,t,i){var h=!0,w=!0;if(typeof e!="function")throw new Dt(j);return $e(i)&&(h="leading"in i?!!i.leading:h,w="trailing"in i?!!i.trailing:w),xa(e,t,{leading:h,maxWait:t,trailing:w})}function ld(e){return Ca(e,1)}function cd(e,t){return tn(Ws(t),e)}function ud(){if(!arguments.length)return[];var e=arguments[0];return Ce(e)?e:[e]}function fd(e){return At(e,m)}function dd(e,t){return t=typeof t=="function"?t:k,At(e,m,t)}function _d(e){return At(e,l|m)}function vd(e,t){return t=typeof t=="function"?t:k,At(e,l|m,t)}function pd(e,t){return t==null||fo(e,t,tt(t))}function Ft(e,t){return e===t||e!==e&&t!==t}var gd=Fr(Rs),md=Fr(function(e,t){return e>=t}),yi=So(function(){return arguments}())?So:function(e){return qe(e)&&Pe.call(e,"callee")&&!so.call(e,"callee")},Ce=$.isArray,Sd=Wn?mt(Wn):Lc;function _t(e){return e!=null&&Gr(e.length)&&!ei(e)}function Ve(e){return qe(e)&&_t(e)}function Cd(e){return e===!0||e===!1||qe(e)&&ct(e)==R}var di=Ml||dn,wd=Un?mt(Un):Rc;function bd(e){return qe(e)&&e.nodeType===1&&!nr(e)}function yd(e){if(e==null)return!0;if(_t(e)&&(Ce(e)||typeof e=="string"||typeof e.splice=="function"||di(e)||Hi(e)||yi(e)))return!e.length;var t=ht(e);if(t==Le||t==it)return!e.size;if(rr(e))return!As(e).length;for(var i in e)if(Pe.call(e,i))return!1;return!0}function Ed(e,t){return er(e,t)}function xd(e,t,i){i=typeof i=="function"?i:k;var h=i?i(e,t):k;return h===k?er(e,t,k,i):!!h}function rn(e){if(!qe(e))return!1;var t=ct(e);return t==ne||t==z||typeof e.message=="string"&&typeof e.name=="string"&&!nr(e)}function Ld(e){return typeof e=="number"&&oo(e)}function ei(e){if(!$e(e))return!1;var t=ct(e);return t==ie||t==Ee||t==U||t==_i}function Ra(e){return typeof e=="number"&&e==we(e)}function Gr(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=ee}function $e(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function qe(e){return e!=null&&typeof e=="object"}var Da=Nn?mt(Nn):kc;function Rd(e,t){return e===t||ks(e,t,Vs(t))}function Dd(e,t,i){return i=typeof i=="function"?i:k,ks(e,t,Vs(t),i)}function kd(e){return ka(e)&&e!=+e}function Ad(e){if(fu(e))throw new Se(ot);return Co(e)}function Bd(e){return e===null}function Td(e){return e==null}function ka(e){return typeof e=="number"||qe(e)&&ct(e)==Me}function nr(e){if(!qe(e)||ct(e)!=ue)return!1;var t=Cr(e);if(t===null)return!0;var i=Pe.call(t,"constructor")&&t.constructor;return typeof i=="function"&&i instanceof i&&pr.call(i)==Rl}var sn=$n?mt($n):Ac;function Md(e){return Ra(e)&&e>=-ee&&e<=ee}var Aa=zn?mt(zn):Bc;function jr(e){return typeof e=="string"||!Ce(e)&&qe(e)&&ct(e)==xt}function Ct(e){return typeof e=="symbol"||qe(e)&&ct(e)==q}var Hi=Kn?mt(Kn):Tc;function Od(e){return e===k}function Id(e){return qe(e)&&ht(e)==he}function Pd(e){return qe(e)&&ct(e)==ze}var Hd=Fr(Bs),Fd=Fr(function(e,t){return e<=t});function Ba(e){if(!e)return[];if(_t(e))return jr(e)?Pt(e):dt(e);if(Vi&&e[Vi])return vl(e[Vi]());var t=ht(e),i=t==Le?ms:t==it?dr:Fi;return i(e)}function ti(e){if(!e)return e===0?e:0;if(e=Mt(e),e===se||e===-se){var t=e<0?-1:1;return t*E}return e===e?e:0}function we(e){var t=ti(e),i=t%1;return t===t?i?t-i:t:0}function Ta(e){return e?Si(we(e),0,M):0}function Mt(e){if(typeof e=="number")return e;if(Ct(e))return A;if($e(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=$e(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Jn(e);var i=mh.test(e);return i||Ch.test(e)?Zh(e.slice(2),i?2:8):gh.test(e)?A:+e}function Ma(e){return qt(e,vt(e))}function Wd(e){return e?Si(we(e),-ee,ee):e===0?e:0}function Oe(e){return e==null?"":St(e)}var Ud=Oi(function(e,t){if(rr(t)||_t(t)){qt(t,tt(t),e);return}for(var i in t)Pe.call(t,i)&&Yi(e,i,t[i])}),Oa=Oi(function(e,t){qt(t,vt(t),e)}),Xr=Oi(function(e,t,i,h){qt(t,vt(t),e,h)}),Nd=Oi(function(e,t,i,h){qt(t,tt(t),e,h)}),$d=Zt(Es);function zd(e,t){var i=Mi(e);return t==null?i:uo(i,t)}var Kd=xe(function(e,t){e=He(e);var i=-1,h=t.length,w=h>2?t[2]:k;for(w&&ut(t[0],t[1],w)&&(h=1);++i<h;)for(var L=t[i],B=vt(L),I=-1,W=B.length;++I<W;){var V=B[I],G=e[V];(G===k||Ft(G,Ai[V])&&!Pe.call(e,V))&&(e[V]=L[V])}return e}),qd=xe(function(e){return e.push(k,Yo),gt(Ia,k,e)});function Vd(e,t){return Vn(e,_e(t,3),Kt)}function Gd(e,t){return Vn(e,_e(t,3),Ls)}function jd(e,t){return e==null?e:xs(e,_e(t,3),vt)}function Xd(e,t){return e==null?e:go(e,_e(t,3),vt)}function Jd(e,t){return e&&Kt(e,_e(t,3))}function Yd(e,t){return e&&Ls(e,_e(t,3))}function Zd(e){return e==null?[]:Ar(e,tt(e))}function Qd(e){return e==null?[]:Ar(e,vt(e))}function nn(e,t,i){var h=e==null?k:Ci(e,t);return h===k?i:h}function e_(e,t){return e!=null&&ea(e,t,bc)}function on(e,t){return e!=null&&ea(e,t,yc)}var t_=Vo(function(e,t,i){t!=null&&typeof t.toString!="function"&&(t=gr.call(t)),e[t]=i},hn(pt)),i_=Vo(function(e,t,i){t!=null&&typeof t.toString!="function"&&(t=gr.call(t)),Pe.call(e,t)?e[t].push(i):e[t]=[i]},_e),r_=xe(Qi);function tt(e){return _t(e)?lo(e):As(e)}function vt(e){return _t(e)?lo(e,!0):Mc(e)}function s_(e,t){var i={};return t=_e(t,3),Kt(e,function(h,w,L){Jt(i,t(h,w,L),h)}),i}function n_(e,t){var i={};return t=_e(t,3),Kt(e,function(h,w,L){Jt(i,w,t(h,w,L))}),i}var o_=Oi(function(e,t,i){Br(e,t,i)}),Ia=Oi(function(e,t,i,h){Br(e,t,i,h)}),a_=Zt(function(e,t){var i={};if(e==null)return i;var h=!1;t=Ue(t,function(L){return L=ui(L,e),h||(h=L.length>1),L}),qt(e,Ks(e),i),h&&(i=At(i,l|v|m,eu));for(var w=t.length;w--;)Ps(i,t[w]);return i});function h_(e,t){return Pa(e,Vr(_e(t)))}var l_=Zt(function(e,t){return e==null?{}:Ic(e,t)});function Pa(e,t){if(e==null)return{};var i=Ue(Ks(e),function(h){return[h]});return t=_e(t),Ro(e,i,function(h,w){return t(h,w[0])})}function c_(e,t,i){t=ui(t,e);var h=-1,w=t.length;for(w||(w=1,e=k);++h<w;){var L=e==null?k:e[Vt(t[h])];L===k&&(h=w,L=i),e=ei(L)?L.call(e):L}return e}function u_(e,t,i){return e==null?e:tr(e,t,i)}function f_(e,t,i,h){return h=typeof h=="function"?h:k,e==null?e:tr(e,t,i,h)}var Ha=Xo(tt),Fa=Xo(vt);function d_(e,t,i){var h=Ce(e),w=h||di(e)||Hi(e);if(t=_e(t,4),i==null){var L=e&&e.constructor;w?i=h?new L:[]:$e(e)?i=ei(L)?Mi(Cr(e)):{}:i={}}return(w?Rt:Kt)(e,function(B,I,W){return t(i,B,I,W)}),i}function __(e,t){return e==null?!0:Ps(e,t)}function v_(e,t,i){return e==null?e:To(e,t,Ws(i))}function p_(e,t,i,h){return h=typeof h=="function"?h:k,e==null?e:To(e,t,Ws(i),h)}function Fi(e){return e==null?[]:gs(e,tt(e))}function g_(e){return e==null?[]:gs(e,vt(e))}function m_(e,t,i){return i===k&&(i=t,t=k),i!==k&&(i=Mt(i),i=i===i?i:0),t!==k&&(t=Mt(t),t=t===t?t:0),Si(Mt(e),t,i)}function S_(e,t,i){return t=ti(t),i===k?(i=t,t=0):i=ti(i),e=Mt(e),Ec(e,t,i)}function C_(e,t,i){if(i&&typeof i!="boolean"&&ut(e,t,i)&&(t=i=k),i===k&&(typeof t=="boolean"?(i=t,t=k):typeof e=="boolean"&&(i=e,e=k)),e===k&&t===k?(e=0,t=1):(e=ti(e),t===k?(t=e,e=0):t=ti(t)),e>t){var h=e;e=t,t=h}if(i||e%1||t%1){var w=ao();return at(e+w*(t-e+Yh("1e-"+((w+"").length-1))),t)}return Ms(e,t)}var w_=Ii(function(e,t,i){return t=t.toLowerCase(),e+(i?Wa(t):t)});function Wa(e){return an(Oe(e).toLowerCase())}function Ua(e){return e=Oe(e),e&&e.replace(bh,cl).replace(Nh,"")}function b_(e,t,i){e=Oe(e),t=St(t);var h=e.length;i=i===k?h:Si(we(i),0,h);var w=i;return i-=t.length,i>=0&&e.slice(i,w)==t}function y_(e){return e=Oe(e),e&&es.test(e)?e.replace(Ye,ul):e}function E_(e){return e=Oe(e),e&&hh.test(e)?e.replace(ts,"\\$&"):e}var x_=Ii(function(e,t,i){return e+(i?"-":"")+t.toLowerCase()}),L_=Ii(function(e,t,i){return e+(i?" ":"")+t.toLowerCase()}),R_=zo("toLowerCase");function D_(e,t,i){e=Oe(e),t=we(t);var h=t?Di(e):0;if(!t||h>=t)return e;var w=(t-h)/2;return Hr(Er(w),i)+e+Hr(yr(w),i)}function k_(e,t,i){e=Oe(e),t=we(t);var h=t?Di(e):0;return t&&h<t?e+Hr(t-h,i):e}function A_(e,t,i){e=Oe(e),t=we(t);var h=t?Di(e):0;return t&&h<t?Hr(t-h,i)+e:e}function B_(e,t,i){return i||t==null?t=0:t&&(t=+t),Hl(Oe(e).replace(is,""),t||0)}function T_(e,t,i){return(i?ut(e,t,i):t===k)?t=1:t=we(t),Os(Oe(e),t)}function M_(){var e=arguments,t=Oe(e[0]);return e.length<3?t:t.replace(e[1],e[2])}var O_=Ii(function(e,t,i){return e+(i?"_":"")+t.toLowerCase()});function I_(e,t,i){return i&&typeof i!="number"&&ut(e,t,i)&&(t=i=k),i=i===k?M:i>>>0,i?(e=Oe(e),e&&(typeof t=="string"||t!=null&&!sn(t))&&(t=St(t),!t&&Ri(e))?fi(Pt(e),0,i):e.split(t,i)):[]}var P_=Ii(function(e,t,i){return e+(i?" ":"")+an(t)});function H_(e,t,i){return e=Oe(e),i=i==null?0:Si(we(i),0,e.length),t=St(t),e.slice(i,i+t.length)==t}function F_(e,t,i){var h=x.templateSettings;i&&ut(e,t,i)&&(t=k),e=Oe(e),t=Xr({},t,h,Jo);var w=Xr({},t.imports,h.imports,Jo),L=tt(w),B=gs(w,L),I,W,V=0,G=t.interpolate||hr,Y="__p += '",oe=Ss((t.escape||hr).source+"|"+G.source+"|"+(G===gn?ph:hr).source+"|"+(t.evaluate||hr).source+"|$","g"),ce="//# sourceURL="+(Pe.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Vh+"]")+`
`;e.replace(oe,function(pe,Re,Ae,wt,ft,bt){return Ae||(Ae=wt),Y+=e.slice(V,bt).replace(yh,fl),Re&&(I=!0,Y+=`' +
__e(`+Re+`) +
'`),ft&&(W=!0,Y+=`';
`+ft+`;
__p += '`),Ae&&(Y+=`' +
((__t = (`+Ae+`)) == null ? '' : __t) +
'`),V=bt+pe.length,pe}),Y+=`';
`;var ve=Pe.call(t,"variable")&&t.variable;if(!ve)Y=`with (obj) {
`+Y+`
}
`;else if(_h.test(ve))throw new Se(a);Y=(W?Y.replace(Yr,""):Y).replace(Zr,"$1").replace(de,"$1;"),Y="function("+(ve||"obj")+`) {
`+(ve?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(I?", __e = _.escape":"")+(W?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Y+`return __p
}`;var be=$a(function(){return Te(L,ce+"return "+Y).apply(k,B)});if(be.source=Y,rn(be))throw be;return be}function W_(e){return Oe(e).toLowerCase()}function U_(e){return Oe(e).toUpperCase()}function N_(e,t,i){if(e=Oe(e),e&&(i||t===k))return Jn(e);if(!e||!(t=St(t)))return e;var h=Pt(e),w=Pt(t),L=Yn(h,w),B=Zn(h,w)+1;return fi(h,L,B).join("")}function $_(e,t,i){if(e=Oe(e),e&&(i||t===k))return e.slice(0,eo(e)+1);if(!e||!(t=St(t)))return e;var h=Pt(e),w=Zn(h,Pt(t))+1;return fi(h,0,w).join("")}function z_(e,t,i){if(e=Oe(e),e&&(i||t===k))return e.replace(is,"");if(!e||!(t=St(t)))return e;var h=Pt(e),w=Yn(h,Pt(t));return fi(h,w).join("")}function K_(e,t){var i=T,h=O;if($e(t)){var w="separator"in t?t.separator:w;i="length"in t?we(t.length):i,h="omission"in t?St(t.omission):h}e=Oe(e);var L=e.length;if(Ri(e)){var B=Pt(e);L=B.length}if(i>=L)return e;var I=i-Di(h);if(I<1)return h;var W=B?fi(B,0,I).join(""):e.slice(0,I);if(w===k)return W+h;if(B&&(I+=W.length-I),sn(w)){if(e.slice(I).search(w)){var V,G=W;for(w.global||(w=Ss(w.source,Oe(mn.exec(w))+"g")),w.lastIndex=0;V=w.exec(G);)var Y=V.index;W=W.slice(0,Y===k?I:Y)}}else if(e.indexOf(St(w),I)!=I){var oe=W.lastIndexOf(w);oe>-1&&(W=W.slice(0,oe))}return W+h}function q_(e){return e=Oe(e),e&&Qr.test(e)?e.replace(Ki,Sl):e}var V_=Ii(function(e,t,i){return e+(i?" ":"")+t.toUpperCase()}),an=zo("toUpperCase");function Na(e,t,i){return e=Oe(e),t=i?k:t,t===k?_l(e)?bl(e):nl(e):e.match(t)||[]}var $a=xe(function(e,t){try{return gt(e,k,t)}catch(i){return rn(i)?i:new Se(i)}}),G_=Zt(function(e,t){return Rt(t,function(i){i=Vt(i),Jt(e,i,en(e[i],e))}),e});function j_(e){var t=e==null?0:e.length,i=_e();return e=t?Ue(e,function(h){if(typeof h[1]!="function")throw new Dt(j);return[i(h[0]),h[1]]}):[],xe(function(h){for(var w=-1;++w<t;){var L=e[w];if(gt(L[0],this,h))return gt(L[1],this,h)}})}function X_(e){return Sc(At(e,l))}function hn(e){return function(){return e}}function J_(e,t){return e==null||e!==e?t:e}var Y_=qo(),Z_=qo(!0);function pt(e){return e}function ln(e){return wo(typeof e=="function"?e:At(e,l))}function Q_(e){return yo(At(e,l))}function ev(e,t){return Eo(e,At(t,l))}var tv=xe(function(e,t){return function(i){return Qi(i,e,t)}}),iv=xe(function(e,t){return function(i){return Qi(e,i,t)}});function cn(e,t,i){var h=tt(t),w=Ar(t,h);i==null&&!($e(t)&&(w.length||!h.length))&&(i=t,t=e,e=this,w=Ar(t,tt(t)));var L=!($e(i)&&"chain"in i)||!!i.chain,B=ei(e);return Rt(w,function(I){var W=t[I];e[I]=W,B&&(e.prototype[I]=function(){var V=this.__chain__;if(L||V){var G=e(this.__wrapped__),Y=G.__actions__=dt(this.__actions__);return Y.push({func:W,args:arguments,thisArg:e}),G.__chain__=V,G}return W.apply(e,oi([this.value()],arguments))})}),e}function rv(){return st._===this&&(st._=Dl),this}function un(){}function sv(e){return e=we(e),xe(function(t){return xo(t,e)})}var nv=Ns(Ue),ov=Ns(qn),av=Ns(fs);function za(e){return js(e)?ds(Vt(e)):Pc(e)}function hv(e){return function(t){return e==null?k:Ci(e,t)}}var lv=Go(),cv=Go(!0);function fn(){return[]}function dn(){return!1}function uv(){return{}}function fv(){return""}function dv(){return!0}function _v(e,t){if(e=we(e),e<1||e>ee)return[];var i=M,h=at(e,M);t=_e(t),e-=M;for(var w=ps(h,t);++i<e;)t(i);return w}function vv(e){return Ce(e)?Ue(e,Vt):Ct(e)?[e]:dt(la(Oe(e)))}function pv(e){var t=++Ll;return Oe(e)+t}var gv=Pr(function(e,t){return e+t},0),mv=$s("ceil"),Sv=Pr(function(e,t){return e/t},1),Cv=$s("floor");function wv(e){return e&&e.length?kr(e,pt,Rs):k}function bv(e,t){return e&&e.length?kr(e,_e(t,2),Rs):k}function yv(e){return jn(e,pt)}function Ev(e,t){return jn(e,_e(t,2))}function xv(e){return e&&e.length?kr(e,pt,Bs):k}function Lv(e,t){return e&&e.length?kr(e,_e(t,2),Bs):k}var Rv=Pr(function(e,t){return e*t},1),Dv=$s("round"),kv=Pr(function(e,t){return e-t},0);function Av(e){return e&&e.length?vs(e,pt):0}function Bv(e,t){return e&&e.length?vs(e,_e(t,2)):0}return x.after=Qf,x.ary=Ca,x.assign=Ud,x.assignIn=Oa,x.assignInWith=Xr,x.assignWith=Nd,x.at=$d,x.before=wa,x.bind=en,x.bindAll=G_,x.bindKey=ba,x.castArray=ud,x.chain=ga,x.chunk=Su,x.compact=Cu,x.concat=wu,x.cond=j_,x.conforms=X_,x.constant=hn,x.countBy=Af,x.create=zd,x.curry=ya,x.curryRight=Ea,x.debounce=xa,x.defaults=Kd,x.defaultsDeep=qd,x.defer=ed,x.delay=td,x.difference=bu,x.differenceBy=yu,x.differenceWith=Eu,x.drop=xu,x.dropRight=Lu,x.dropRightWhile=Ru,x.dropWhile=Du,x.fill=ku,x.filter=Tf,x.flatMap=If,x.flatMapDeep=Pf,x.flatMapDepth=Hf,x.flatten=da,x.flattenDeep=Au,x.flattenDepth=Bu,x.flip=id,x.flow=Y_,x.flowRight=Z_,x.fromPairs=Tu,x.functions=Zd,x.functionsIn=Qd,x.groupBy=Ff,x.initial=Ou,x.intersection=Iu,x.intersectionBy=Pu,x.intersectionWith=Hu,x.invert=t_,x.invertBy=i_,x.invokeMap=Uf,x.iteratee=ln,x.keyBy=Nf,x.keys=tt,x.keysIn=vt,x.map=zr,x.mapKeys=s_,x.mapValues=n_,x.matches=Q_,x.matchesProperty=ev,x.memoize=qr,x.merge=o_,x.mergeWith=Ia,x.method=tv,x.methodOf=iv,x.mixin=cn,x.negate=Vr,x.nthArg=sv,x.omit=a_,x.omitBy=h_,x.once=rd,x.orderBy=$f,x.over=nv,x.overArgs=sd,x.overEvery=ov,x.overSome=av,x.partial=tn,x.partialRight=La,x.partition=zf,x.pick=l_,x.pickBy=Pa,x.property=za,x.propertyOf=hv,x.pull=Nu,x.pullAll=va,x.pullAllBy=$u,x.pullAllWith=zu,x.pullAt=Ku,x.range=lv,x.rangeRight=cv,x.rearg=nd,x.reject=Vf,x.remove=qu,x.rest=od,x.reverse=Zs,x.sampleSize=jf,x.set=u_,x.setWith=f_,x.shuffle=Xf,x.slice=Vu,x.sortBy=Zf,x.sortedUniq=Qu,x.sortedUniqBy=ef,x.split=I_,x.spread=ad,x.tail=tf,x.take=rf,x.takeRight=sf,x.takeRightWhile=nf,x.takeWhile=of,x.tap=wf,x.throttle=hd,x.thru=$r,x.toArray=Ba,x.toPairs=Ha,x.toPairsIn=Fa,x.toPath=vv,x.toPlainObject=Ma,x.transform=d_,x.unary=ld,x.union=af,x.unionBy=hf,x.unionWith=lf,x.uniq=cf,x.uniqBy=uf,x.uniqWith=ff,x.unset=__,x.unzip=Qs,x.unzipWith=pa,x.update=v_,x.updateWith=p_,x.values=Fi,x.valuesIn=g_,x.without=df,x.words=Na,x.wrap=cd,x.xor=_f,x.xorBy=vf,x.xorWith=pf,x.zip=gf,x.zipObject=mf,x.zipObjectDeep=Sf,x.zipWith=Cf,x.entries=Ha,x.entriesIn=Fa,x.extend=Oa,x.extendWith=Xr,cn(x,x),x.add=gv,x.attempt=$a,x.camelCase=w_,x.capitalize=Wa,x.ceil=mv,x.clamp=m_,x.clone=fd,x.cloneDeep=_d,x.cloneDeepWith=vd,x.cloneWith=dd,x.conformsTo=pd,x.deburr=Ua,x.defaultTo=J_,x.divide=Sv,x.endsWith=b_,x.eq=Ft,x.escape=y_,x.escapeRegExp=E_,x.every=Bf,x.find=Mf,x.findIndex=ua,x.findKey=Vd,x.findLast=Of,x.findLastIndex=fa,x.findLastKey=Gd,x.floor=Cv,x.forEach=ma,x.forEachRight=Sa,x.forIn=jd,x.forInRight=Xd,x.forOwn=Jd,x.forOwnRight=Yd,x.get=nn,x.gt=gd,x.gte=md,x.has=e_,x.hasIn=on,x.head=_a,x.identity=pt,x.includes=Wf,x.indexOf=Mu,x.inRange=S_,x.invoke=r_,x.isArguments=yi,x.isArray=Ce,x.isArrayBuffer=Sd,x.isArrayLike=_t,x.isArrayLikeObject=Ve,x.isBoolean=Cd,x.isBuffer=di,x.isDate=wd,x.isElement=bd,x.isEmpty=yd,x.isEqual=Ed,x.isEqualWith=xd,x.isError=rn,x.isFinite=Ld,x.isFunction=ei,x.isInteger=Ra,x.isLength=Gr,x.isMap=Da,x.isMatch=Rd,x.isMatchWith=Dd,x.isNaN=kd,x.isNative=Ad,x.isNil=Td,x.isNull=Bd,x.isNumber=ka,x.isObject=$e,x.isObjectLike=qe,x.isPlainObject=nr,x.isRegExp=sn,x.isSafeInteger=Md,x.isSet=Aa,x.isString=jr,x.isSymbol=Ct,x.isTypedArray=Hi,x.isUndefined=Od,x.isWeakMap=Id,x.isWeakSet=Pd,x.join=Fu,x.kebabCase=x_,x.last=Tt,x.lastIndexOf=Wu,x.lowerCase=L_,x.lowerFirst=R_,x.lt=Hd,x.lte=Fd,x.max=wv,x.maxBy=bv,x.mean=yv,x.meanBy=Ev,x.min=xv,x.minBy=Lv,x.stubArray=fn,x.stubFalse=dn,x.stubObject=uv,x.stubString=fv,x.stubTrue=dv,x.multiply=Rv,x.nth=Uu,x.noConflict=rv,x.noop=un,x.now=Kr,x.pad=D_,x.padEnd=k_,x.padStart=A_,x.parseInt=B_,x.random=C_,x.reduce=Kf,x.reduceRight=qf,x.repeat=T_,x.replace=M_,x.result=c_,x.round=Dv,x.runInContext=F,x.sample=Gf,x.size=Jf,x.snakeCase=O_,x.some=Yf,x.sortedIndex=Gu,x.sortedIndexBy=ju,x.sortedIndexOf=Xu,x.sortedLastIndex=Ju,x.sortedLastIndexBy=Yu,x.sortedLastIndexOf=Zu,x.startCase=P_,x.startsWith=H_,x.subtract=kv,x.sum=Av,x.sumBy=Bv,x.template=F_,x.times=_v,x.toFinite=ti,x.toInteger=we,x.toLength=Ta,x.toLower=W_,x.toNumber=Mt,x.toSafeInteger=Wd,x.toString=Oe,x.toUpper=U_,x.trim=N_,x.trimEnd=$_,x.trimStart=z_,x.truncate=K_,x.unescape=q_,x.uniqueId=pv,x.upperCase=V_,x.upperFirst=an,x.each=ma,x.eachRight=Sa,x.first=_a,cn(x,function(){var e={};return Kt(x,function(t,i){Pe.call(x.prototype,i)||(e[i]=t)}),e}(),{chain:!1}),x.VERSION=Ne,Rt(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){x[e].placeholder=x}),Rt(["drop","take"],function(e,t){De.prototype[e]=function(i){i=i===k?1:Qe(we(i),0);var h=this.__filtered__&&!t?new De(this):this.clone();return h.__filtered__?h.__takeCount__=at(i,h.__takeCount__):h.__views__.push({size:at(i,M),type:e+(h.__dir__<0?"Right":"")}),h},De.prototype[e+"Right"]=function(i){return this.reverse()[e](i).reverse()}}),Rt(["filter","map","takeWhile"],function(e,t){var i=t+1,h=i==N||i==Z;De.prototype[e]=function(w){var L=this.clone();return L.__iteratees__.push({iteratee:_e(w,3),type:i}),L.__filtered__=L.__filtered__||h,L}}),Rt(["head","last"],function(e,t){var i="take"+(t?"Right":"");De.prototype[e]=function(){return this[i](1).value()[0]}}),Rt(["initial","tail"],function(e,t){var i="drop"+(t?"":"Right");De.prototype[e]=function(){return this.__filtered__?new De(this):this[i](1)}}),De.prototype.compact=function(){return this.filter(pt)},De.prototype.find=function(e){return this.filter(e).head()},De.prototype.findLast=function(e){return this.reverse().find(e)},De.prototype.invokeMap=xe(function(e,t){return typeof e=="function"?new De(this):this.map(function(i){return Qi(i,e,t)})}),De.prototype.reject=function(e){return this.filter(Vr(_e(e)))},De.prototype.slice=function(e,t){e=we(e);var i=this;return i.__filtered__&&(e>0||t<0)?new De(i):(e<0?i=i.takeRight(-e):e&&(i=i.drop(e)),t!==k&&(t=we(t),i=t<0?i.dropRight(-t):i.take(t-e)),i)},De.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},De.prototype.toArray=function(){return this.take(M)},Kt(De.prototype,function(e,t){var i=/^(?:filter|find|map|reject)|While$/.test(t),h=/^(?:head|last)$/.test(t),w=x[h?"take"+(t=="last"?"Right":""):t],L=h||/^find/.test(t);w&&(x.prototype[t]=function(){var B=this.__wrapped__,I=h?[1]:arguments,W=B instanceof De,V=I[0],G=W||Ce(B),Y=function(Re){var Ae=w.apply(x,oi([Re],I));return h&&oe?Ae[0]:Ae};G&&i&&typeof V=="function"&&V.length!=1&&(W=G=!1);var oe=this.__chain__,ce=!!this.__actions__.length,ve=L&&!oe,be=W&&!ce;if(!L&&G){B=be?B:new De(this);var pe=e.apply(B,I);return pe.__actions__.push({func:$r,args:[Y],thisArg:k}),new kt(pe,oe)}return ve&&be?e.apply(this,I):(pe=this.thru(Y),ve?h?pe.value()[0]:pe.value():pe)})}),Rt(["pop","push","shift","sort","splice","unshift"],function(e){var t=_r[e],i=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",h=/^(?:pop|shift)$/.test(e);x.prototype[e]=function(){var w=arguments;if(h&&!this.__chain__){var L=this.value();return t.apply(Ce(L)?L:[],w)}return this[i](function(B){return t.apply(Ce(B)?B:[],w)})}}),Kt(De.prototype,function(e,t){var i=x[t];if(i){var h=i.name+"";Pe.call(Ti,h)||(Ti[h]=[]),Ti[h].push({name:t,func:i})}}),Ti[Ir(k,o).name]=[{name:"wrapper",func:k}],De.prototype.clone=Kl,De.prototype.reverse=ql,De.prototype.value=Vl,x.prototype.at=bf,x.prototype.chain=yf,x.prototype.commit=Ef,x.prototype.next=xf,x.prototype.plant=Rf,x.prototype.reverse=Df,x.prototype.toJSON=x.prototype.valueOf=x.prototype.value=kf,x.prototype.first=x.prototype.head,Vi&&(x.prototype[Vi]=Lf),x},ki=yl();vi?((vi.exports=ki)._=ki,hs._=ki):st._=ki}).call(or)})(Jr,Jr.exports);var op=Jr.exports;const ap={class:"setting-bar"},hp=Ya({__name:"terminal",props:["dirPath"],setup(Nt){const Et=Nt,k=ke(!1),Ne=ke(!1),ye=zv(),ot=Tv(),j=ke(ot.username),a=ke(Et.dirPath),u=ke(),_=ke(),p=ke(new sp.Terminal({fontSize:14,fontFamily:"Monaco, Menlo, Consolas, 'Courier New', monospace",theme:{background:"#181d28"},cursorBlink:!0,cursorStyle:"underline",convertEol:!0})),l=new np.FitAddon,v=ke(30);ke(14);let m=ke(new rp("/micro/webui/term"));const b=C=>{p.value&&p.value.resize(p.value.cols,C)},d=C=>{if(!C){console.error("éè¦ä¼ å¥ä¸ä¸ªåç´ ");return}document.fullscreenElement?document.exitFullscreen&&document.exitFullscreen():C.requestFullscreen?C.requestFullscreen().catch(f=>{console.error("å¨å±è¯·æ±å¤±è´¥:",f)}):console.error("å½åæµè§å¨ä¸æ¯æå¨å±API"),o()},s=()=>{let C="";p.value.onData(f=>{if(f.endsWith(`
`)||f.endsWith("\r")||f.endsWith("\r")){const y=C.replace("\r","").replace(`
`,"");if(y)try{Ne.value==!1?m.value.sendWs(JSON.stringify({type:"exec",params:{cmd:y,path:null}})):m.value.sendWs(JSON.stringify({type:"ssh",params:{cmd:y,path:null}}))}catch(T){T&&p.value.write(JSON.stringify(T))}C="",p.value.write(f),p.value.write(`
`),Ne.value==!1&&p.value.write(`\x1B[36;1m ${j.value} <\x1B[36m${a.value}>\x1B[36;1m ~\x1B[0m $ `)}else f==="\b"||f===""?(C=C.slice(0,-1),p.value.write("\b \b")):(C+=f,p.value.write(f))})},o=()=>{l.fit()},r=op.debounce(()=>o(),500),n=()=>{window.addEventListener("resize",r)},c=()=>{window.removeEventListener("resize",r)},g=async()=>{await m.value.openWs("",()=>{m.value.sendWs(JSON.stringify({type:"exec",params:{cmd:"cd",path:Et.dirPath}}))})},S=async()=>{try{await ye.connectSSH(),m.value.closeWs(),Ne.value=!0,await m.value.openWs("",()=>{m.value.sendWs(JSON.stringify({type:"ssh",params:{}}))}),k.value=!1}catch{}};return Mv(()=>m.value.msgQueue,C=>{var y,T;const f=C[C.length-1];if(f.type=="ssh"?Ne.value=!0:Ne.value=!1,f.action=="meta"){f.type=="ssh"&&(Ne.value=!0,p.value.write(`

`));return}p.value.write(f.params),(y=f.params)!=null&&y.includes("logout")&&(Ne.value=!1,m.value.sendWs(JSON.stringify({type:"ssh",params:{cmd:"logout",path:null}}))),(T=f.params)!=null&&T.startsWith("UpdateCwd:")&&(a.value=f.params.replace("UpdateCwd:",""),p.value.write(`
`),p.value.write(`\x1B[36;1m ${j.value} <\x1B[36m${a.value}>\x1B[36;1m ~\x1B[0m $ `))},{deep:!0}),Za(()=>{p.value.open(_.value),p.value.write(`\x1B[36;1m Systerm ~\x1B[0m $ æ¬¢è¿ä½¿ç¨å°å¾®ç»ç«¯!\r
`),p.value.write(`\x1B[36;1m Systerm ~\x1B[0m $ é»è®¤ä½¿ç¨execæ§è¡å½ä»¤ï¼å¦è¿æ¥è¿ç¨æå¡å¨ï¼è¯·ç¹å»sshæé®ä½¿ç¨sshè¿æ¥!\r
`),p.value.write(`\x1B[36;1m Systerm ~\x1B[0m $ æ³¨æï¼sshä¼è¯ä¸­ä½¿ç¨å¿«æ·é®æ¶ï¼éè¦åè½¦ï¼ï¼ä¾å¦ï¼\r
`),p.value.write(`\x1B[36;1m Systerm ~\x1B[0m $ sshä¼è¯ä¸­ä½¿ç¨ãctrl + c + Enterãç»æ­¢åºç¨ç¨åºè¿è¡ï¼\r
`),p.value.write(`\x1B[36;1m Systerm ~\x1B[0m $ sshä¼è¯ä¸­ä½¿ç¨ãctrl + ad + Enterãéåºsshè¿æ¥ï¼\r
`),p.value.write(`\x1B[36;1m Systerm ~\x1B[0m $ cd ${Et.dirPath}`),g(),p.value.loadAddon(l),o(),n(),s()}),Ov(()=>{m.value.closeWs(),c()}),(C,f)=>{const y=je("el-button"),T=je("el-slider"),O=je("el-form-item"),P=je("el-form"),D=je("el-popover"),N=je("el-input"),X=je("el-dialog");return Xe(),Ut("div",{class:"bg-main",ref_key:"termboxRef",ref:u},[lt("div",ap,[ge(y,{size:"small",style:{"margin-left":"auto"},onClick:f[0]||(f[0]=Z=>(Be(ye).fillSSHInfo(),k.value=!0))},{default:me(()=>[yt("SSH")]),_:1}),ge(D,{placement:"bottom",title:"ç»ç«¯è®¾ç½®",width:300,trigger:"hover"},{reference:me(()=>[ge(y,{icon:"Setting",circle:"",size:"small"})]),default:me(()=>[ge(P,null,{default:me(()=>[ge(O,{label:"é«åº¦(è¡)"},{default:me(()=>[ge(T,{modelValue:v.value,"onUpdate:modelValue":f[1]||(f[1]=Z=>v.value=Z),size:"large",min:20,max:100,onInput:b},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),ge(y,{size:"small",icon:"FullScreen",circle:"",style:{margin:"0 5px"},onClick:f[2]||(f[2]=Z=>d(u.value))})]),lt("div",{ref_key:"terminal",ref:_,id:"terminal"},null,512),ge(X,{modelValue:k.value,"onUpdate:modelValue":f[7]||(f[7]=Z=>k.value=Z),title:"sshè¿æ¥è®¾ç½®"},{footer:me(()=>[ge(y,{type:"primary",size:"default",onClick:S},{default:me(()=>[yt(" è¿æ¥ ")]),_:1})]),default:me(()=>[ge(P,null,{default:me(()=>[ge(O,{label:"ä¸»æº"},{default:me(()=>[ge(N,{"prefix-icon":Be(qa),modelValue:Be(ye).sshInfo.host,"onUpdate:modelValue":f[3]||(f[3]=Z=>Be(ye).sshInfo.host=Z),"input-style":{width:"100%"}},null,8,["prefix-icon","modelValue"])]),_:1}),ge(O,{label:"è´¦æ·"},{default:me(()=>[ge(N,{"prefix-icon":Be(qa),modelValue:Be(ye).sshInfo.username,"onUpdate:modelValue":f[4]||(f[4]=Z=>Be(ye).sshInfo.username=Z),"input-style":{width:"100%"}},null,8,["prefix-icon","modelValue"])]),_:1}),ge(O,{label:"å¯ç "},{default:me(()=>[ge(N,{"prefix-icon":Be(Va),"show-password":"",type:"password",modelValue:Be(ye).sshInfo.password,"onUpdate:modelValue":f[5]||(f[5]=Z=>Be(ye).sshInfo.password=Z),style:{width:"100%"}},null,8,["prefix-icon","modelValue"])]),_:1}),ge(O,{label:"ç«¯å£"},{default:me(()=>[ge(N,{"prefix-icon":Be(Va),modelValue:Be(ye).sshInfo.port,"onUpdate:modelValue":f[6]||(f[6]=Z=>Be(ye).sshInfo.port=Z),style:{width:"100%"}},null,8,["prefix-icon","modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],512)}}});const lp=Qa(hp,[["__scopeId","data-v-ba98b782"]]),cp={class:"search_bar"},up={style:{width:"100%","margin-right":"10px"}},fp={class:"search_file"},dp={class:"handle_tabbar",style:{"margin-top":"10px"}},_p=["onContextmenu"],vp=["onClick"],pp=["onContextmenu"],gp={key:0},mp=["onClick"],Sp=["onContextmenu"],Cp={key:0,class:"file_upload_box"},wp={key:1},bp={key:2,style:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"}},yp=["src"],Ep={key:3,style:{width:"100","max-height":"100%"}},xp=["src"],Lp=["src"],Rp=Ya({__name:"index",setup(Nt){const Et=ke(window.innerHeight-210);window.onresize=()=>{Et.value=window.innerHeight-210};const k=ke(!1),Ne=ke(""),ye=ke(""),ot=ke(""),j=ke(""),a=ke(!1),u=ke(!1),_=ke(""),p=ke(),l=ke(),v=ke();let m=Ga({path:""}),b=Ga({name:"",mtime:"",type:"",size:"",path:"",isBlur:!1,isRightClicked:!1}),d=ke([{name:"å é¤"},{name:"ä¸ä¼ "},{name:"ç§»å¨"},{name:"ä¸è½½"},{name:"å¤å¶"},{name:"å½å"}]),s=ke("0"),o=ke([]),r=ke(!1),n=ke("name"),c=ke(!1),g=ke(""),S=ke(""),C=ke(0),f=ke([]),y=ke({}),T=ke(""),O=ke(""),P=ke([]);const D=async(q="0")=>{k.value=!0;let te=await Kv(q);te.code==200&&(o.value=te.data.children,s.value=te.data.path,k.value=!1)},N=async q=>{let te=await qv(q.path,q.type);te.code==200&&(q.size=te.data)},X=Iv(()=>{let q=[];if(n.value=="name"){let te=[],he=[];o.value.forEach(ze=>{ze.type=="file"?he.push(ze):te.push(ze)}),q=[...te,...he]}else n.value=="time"?q=o.value.slice().sort((te,he)=>{const ze=new Date(te.mtime).getTime(),Ke=new Date(he.mtime).getTime();return ze-Ke}):q=o.value;return c.value?q.reverse():q}),Z=q=>{q=="name"?n.value=="name"?c.value=!c.value:(n.value="name",c.value=!1):q=="time"&&(n.value=="time"?c.value=!c.value:(n.value="time",c.value=!1))},se=()=>{let q=s.value.lastIndexOf("/");q==-1&&(q=s.value.lastIndexOf("\\")),s.value=s.value.slice(0,q),D(s.value)},ee=()=>{D(s.value)},E=async()=>{let q=await Vv(s.value,g.value);g.value="",q.code==200&&(o.value=q.data)},A=q=>{const te=q.lastIndexOf(".");return te===-1?"js":q.substring(te+1)},M=async q=>{if(q.type=="file"){if(Object.assign(b,q),/\.(png|jpg|jpeg|gif|bmp|tiff|webp|svg)$/.test(q.name)){let he=await pn(q.path);ye.value=URL.createObjectURL(he),_.value="viewImage",u.value=!0;return}if(/\.(mp3|wav|aac|m4a|ogg|flac|wma|ape|alac|amr|awb|aiff|caf|mka|opus|ra|rm|spx|tta|voc|wavpack|xm|mod|s3m|it|xmf|mid|midi|kar|rmi)$/.test(q.name)){let he=await pn(q.path);ot.value=URL.createObjectURL(he),_.value="viewAudio",u.value=!0;return}if(/\.(mp4|avi|mov|wmv|mpeg|flv|mkv|vob|3gp|webm|m4v)$/.test(q.name)){let he=await pn(q.path);j.value=URL.createObjectURL(he),_.value="viewVideo",u.value=!0;return}let te=await Gv(q.path);te.code==200&&(C.value=1,S.value=te.data,Ne.value=A(q.name));return}D(q.path)},H=async q=>{(await Ja(b.path,q.toString())).code==200&&(Ei.success("ä¿å­æåï¼"),C.value=0,S.value="")},Q=q=>{q=="æä»¶"?o.value.unshift({name:"",mtime:"",type:"file",size:"",path:s.value,isBlur:!0}):q=="ç®å½"&&o.value.unshift({name:"",mtime:"",type:"directory",size:"",path:s.value,isBlur:!0});let te=o.value.find(he=>he.isBlur==!0);Xa(()=>{y.value[te.name.replace(/\./g,"")+te.type].focus()})},re=(q,te)=>{const he=new Set;for(let ze=0;ze<q.length;ze++){const Ke=q[ze][te];if(he.has(Ke))return!0;he.add(Ke)}return!1},le=async(q,te="blur",he="create")=>{if(q.isBlur=!1,q.name||(q.name="æ°å»ºæ é¢"),re(o.value,"name")){Ei.error("è¯¥æ é¢å·²å­å¨ï¼ï¼"),D(s.value);return}let Ke;q.handlerMode=="å½å"&&(he="rename"),he=="create"?q.type=="file"?Ke=await Ja(s.value+"/"+q.name,""):Ke=await jv(s.value+"/"+q.name):he=="rename"&&(Ke=await Xv(s.value+"/"+T.value,s.value+"/"+q.name),q.handlerMode==""),Ke.code==200&&D(s.value)},fe=async q=>{let te;q.type=="file"?te=await ep(q.path):te=await tp(q.path),te.code==200&&(console.log(te),D(s.value))},U=async q=>{f.value.push(q)},R=async()=>{for(let q=0;q<f.value.length;q++){let te=f.value[q],he;te.handlerMode=="ç§»å¨"?he=await Jv(te.path,s.value+"/"+te.name):te.handlerMode=="å¤å¶"?te.type=="file"?he=await Yv(te.path,s.value+"/"+te.name):he=await Zv(te.path,s.value+"/"+te.name):Ei.error("è¯·éæ©å³ä¾§æä½"),he.code==200&&Ei.success("ç²è´´æåï¼")}f.value=[],D(s.value)},J=q=>{T.value=q.name,q.isBlur=!0,Xa(()=>{y.value[q.name.replace(/\./g,"")+q.type].focus()})},z=q=>{for(let te=0;te<o.value.length;te++)o.value[te].isRightClicked=!1;q.isRightClicked=!0},ne=()=>{for(let q=0;q<o.value.length;q++)o.value[q].isRightClicked=!1},ie=()=>{m.path=s.value,_.value="upload",u.value=!0},Ee=()=>{C.value=2},Le=(q,te)=>{switch(q.isRightClicked=!1,te.name){case"å é¤":fe(q);break;case"ç§»å¨":q.handlerMode="ç§»å¨",U(q);break;case"å¤å¶":q.handlerMode="å¤å¶",U(q);break;case"å½å":q.handlerMode="å½å",J(q);break;case"ä¸ä¼ ":q.handlerMode="ä¸ä¼ ",ie();break;case"ä¸è½½":q.handlerMode="ä¸è½½",Ot(q);break;default:Ei.error("å³é®ç¸å³æä½åºéäº")}},Me=q=>{f.value.some(he=>!!he.handlerMode)||(f.value=JSON.parse(JSON.stringify(q)))},Je=q=>{for(let te=0;te<f.value.length;te++)f.value[te].handlerMode=q},ue=q=>{O.value=q.url,u.value=!0},$t=q=>{console.log(q),D(s.value)},_i=()=>{p.value.submit(),u.value=!1},Ot=async q=>{if(console.log(q),q.type=="file"){let te=await Qv(q.path);Ei.success("å¼å§ä¸è½½...");const he=document.createElement("a");he.href=URL.createObjectURL(te),he.download=q.name,document.body.appendChild(he),he.click(),document.body.removeChild(he)}else Ei.warning("è¯·ä¸è½½æä»¶æåç¼©å")},it=()=>{a.value=!1},xt=q=>{};return Za(()=>{D("0")}),Pv(()=>{window.onresize=null}),(q,te)=>{const he=je("el-button"),ze=je("el-input"),Ke=je("el-popover"),et=je("el-option"),zt=je("el-select"),rt=je("el-table-column"),It=je("el-popconfirm"),Ie=je("el-table"),Gt=je("el-card"),Ui=je("Back"),Ni=je("el-icon"),$i=je("el-upload"),zi=je("el-image"),Yr=je("el-dialog"),Zr=Hv("loading");return Xe(),Ut("div",null,[_n(ge(Gt,{class:"box-card",ref:"cardRef"},{default:me(()=>[lt("div",cp,[lt("div",up,[ge(ze,{modelValue:Be(s),"onUpdate:modelValue":te[0]||(te[0]=de=>Wi(s)?s.value=de:s=de),style:{"max-width":"600px",width:"100%","min-width":"200px"},class:"input-with-select"},{prepend:me(()=>[ge(he,{icon:"Back",onClick:se})]),append:me(()=>[ge(he,{icon:"DArrowRight",onClick:ee})]),_:1},8,["modelValue"])]),lt("div",fp,[ge(Ke,{placement:"bottom",title:"æç´¢",width:300,trigger:"hover"},{reference:me(()=>[ge(he,{icon:"Search",circle:""})]),default:me(()=>[ge(ze,{modelValue:Be(g),"onUpdate:modelValue":te[1]||(te[1]=de=>Wi(g)?g.value=de:g=de),placeholder:"è¾å¥æç´¢æä»¶æç®å½"},{append:me(()=>[ge(he,{icon:"Search",onClick:E})]),_:1},8,["modelValue"])]),_:1})])]),lt("div",dp,[ge(he,{size:"small",style:{"margin-right":"5px"},icon:Be(r)?"ArrowLeftBold":"ArrowRightBold",onClick:te[2]||(te[2]=de=>Wi(r)?r.value=!Be(r):r=!Be(r))},null,8,["icon"]),ge(zt,{size:"small",placeholder:"æ°å»º",style:{width:"60px"},onChange:Q},{default:me(()=>[ge(et,{label:"ç®å½",value:"ç®å½"}),ge(et,{label:"æä»¶",value:"æä»¶"})]),_:1}),Be(f).length>0&&Be(f).every(de=>de.handlerMode)?(Xe(),ri(he,{key:0,type:"primary",onClick:te[3]||(te[3]=de=>R()),size:"small",style:{"margin-left":"5px"}},{default:me(()=>[yt(" ç²è´´ ")]),_:1})):si("",!0),Be(f).length>0?(Xe(),ri(he,{key:1,disabled:Be(f).every(de=>de.handlerMode=="å¤å¶"),type:"primary",onClick:te[4]||(te[4]=de=>Je("å¤å¶")),size:"small",style:{"margin-left":"5px"}},{default:me(()=>[yt(" å¤å¶ ")]),_:1},8,["disabled"])):si("",!0),Be(f).length>0?(Xe(),ri(he,{key:2,disabled:Be(f).every(de=>de.handlerMode=="ç§»å¨"),type:"primary",onClick:te[5]||(te[5]=de=>Je("ç§»å¨")),size:"small",style:{"margin-left":"5px"}},{default:me(()=>[yt(" ç§»å¨ ")]),_:1},8,["disabled"])):si("",!0),ge(he,{onClick:ie,size:"small",style:{"margin-left":"5px"}},{default:me(()=>[yt(" ä¸ä¼  ")]),_:1}),ge(he,{onClick:Ee,size:"small",style:{"margin-left":"5px"}},{default:me(()=>[yt(" ç»ç«¯ ")]),_:1})]),_n((Xe(),ri(Ie,{style:{margin:"10px 0"},data:X.value,"max-height":Et.value,onSelectionChange:Me,onClick:ne},{default:me(()=>[Be(r)?(Xe(),ri(rt,{key:0,type:"selection",align:"center"})):si("",!0),ge(rt,{label:"æä»¶åç§°"},{header:me(()=>[lt("div",{class:"title-active",onClick:te[6]||(te[6]=de=>Z("name"))}," æä»¶åç§° ")]),default:me(({row:de,$index:Ki})=>[ge(Ke,{placement:"bottom",title:de.type=="file"?"æä»¶æä½":"æä»¶å¤¹æä½",width:150,trigger:"contextmenu",visible:de.isRightClicked},{reference:me(()=>[lt("div",{onContextmenu:vn(Ye=>z(de),["prevent"])},[lt("i",{class:Fv(`iconfont icon-file 
                                            icon-${de.type=="file"?de.name.split(".").at(-1):"yellowFolder"}
                                        `),style:{"font-size":"20px"}},null,2),yt(" Â  "),de.isBlur?(Xe(),ri(ze,{key:1,ref:Ye=>{Be(y)[de.name.replace(/\./g,"")+de.type]=Ye},onBlur:Ye=>le(de,"blur"),onKeyup:Wv(Ye=>le(de,"enter"),["enter"]),modelValue:de.name,"onUpdate:modelValue":Ye=>de.name=Ye},null,8,["onBlur","onKeyup","modelValue","onUpdate:modelValue"])):(Xe(),Ut("a",{key:0,onClick:Ye=>M(de)},ar(de.name),9,vp))],40,_p)]),default:me(()=>[(Xe(!0),Ut(Uv,null,Nv(Be(d),(Ye,Qr)=>(Xe(),Ut("span",{class:"pop_menu",key:Qr},[Ye.name=="å é¤"?(Xe(),ri(It,{key:0,title:`æ¨å³å°å é¤è·¯å¾ã${de.path}ã,æ¯å¦ç»§ç»­ï¼`,onConfirm:es=>Le(de,Ye)},{reference:me(()=>[ge(he,null,{default:me(()=>[yt(ar(Ye.name),1)]),_:2},1024)]),_:2},1032,["title","onConfirm"])):(Xe(),ri(he,{key:1,onClick:es=>Le(de,Ye)},{default:me(()=>[yt(ar(Ye.name),1)]),_:2},1032,["onClick"]))]))),128))]),_:2},1032,["title","visible"])]),_:1}),ge(rt,{label:"å¤§å°",width:"80px"},{default:me(({row:de,$index:Ki})=>[lt("div",{onContextmenu:vn(Ye=>z(de),["prevent"]),style:{"font-size":"12px"}},[de.size?(Xe(),Ut("span",gp,ar(de.size),1)):(Xe(),Ut("a",{key:1,onClick:Ye=>N(de)},"è®¡ç®",8,mp))],40,pp)]),_:1}),ge(rt,{label:"ä¿®æ¹æ¶é´"},{header:me(()=>[lt("div",{class:"title-active",onClick:te[7]||(te[7]=de=>Z("time"))}," ä¿®æ¹æ¶é´ ")]),default:me(({row:de,$index:Ki})=>[lt("div",{onContextmenu:vn(Ye=>z(de),["prevent"]),style:{"font-size":"12px"}},ar(de.mtime.replace(/T/," ").replace(/\.\d{3}Z/,"")),41,Sp)]),_:1})]),_:1},8,["data","max-height"])),[[Zr,k.value]])]),_:1},512),[[ja,Be(C)==0]]),_n(ge(Gt,null,{default:me(()=>[ge(he,{style:{"margin-bottom":"5px"},onClick:te[8]||(te[8]=de=>Wi(C)?C.value=0:C=0)},{default:me(()=>[yt(" è¿å ")]),_:1}),ge(ip,{code:Be(S),ext:Ne.value,onGetCode:H},null,8,["code","ext"])]),_:1},512),[[ja,Be(C)==1]]),Be(C)==2?(Xe(),ri(Gt,{key:0},{default:me(()=>[ge(he,{style:{"margin-bottom":"5px"},onClick:te[9]||(te[9]=de=>Wi(C)?C.value=0:C=0)},{default:me(()=>[ge(Ni,null,{default:me(()=>[ge(Ui)]),_:1})]),_:1}),ge(lp,{dirPath:Be(s)},null,8,["dirPath"])]),_:1})):si("",!0),ge(Yr,{modelValue:u.value,"onUpdate:modelValue":te[11]||(te[11]=de=>u.value=de),title:Be(b).name},$v({default:me(()=>[_.value=="upload"?(Xe(),Ut("div",Cp,[ge($i,{class:"file_uploader",action:"/api/fs/upload",multiple:"",ref_key:"uploadRef",ref:p,"file-list":Be(P),"onUpdate:fileList":te[10]||(te[10]=de=>Wi(P)?P.value=de:P=de),data:Be(m),"show-file-list":!0,"on-preview":ue,"on-success":$t,"before-upload":xt,"auto-upload":!1},{trigger:me(()=>[ge(he,{type:"primary"},{default:me(()=>[yt("éæ©æä»¶")]),_:1})]),_:1},8,["file-list","data"])])):si("",!0),_.value=="viewImage"?(Xe(),Ut("div",wp,[ge(zi,{src:ye.value,lazy:""},null,8,["src"])])):si("",!0),_.value=="viewAudio"?(Xe(),Ut("div",bp,[lt("audio",{ref_key:"audioElement",ref:l,controls:"",src:ot.value,style:{width:"100%"},onEnded:it},null,40,yp)])):si("",!0),_.value=="viewVideo"?(Xe(),Ut("div",Ep,[lt("video",{controls:"",ref_key:"videoElement",ref:v,style:{width:"100%",height:"100%","object-fit":"cover"}},[lt("source",{src:j.value,type:"video/mp4"},null,8,xp),lt("source",{src:j.value,type:"video/ogg"},null,8,Lp)],512)])):si("",!0)]),_:2},[_.value=="upload"?{name:"footer",fn:me(()=>[ge(he,{type:"primary",size:"default",onClick:_i},{default:me(()=>[yt(" ç¡®è®¤æäº¤ ")]),_:1})]),key:"0"}:void 0]),1032,["modelValue","title"])])}}});const Mp=Qa(Rp,[["__scopeId","data-v-8ea81e22"]]);export{Mp as default};
