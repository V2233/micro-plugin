import{_ as S}from"./index.vue_vue_type_script_setup_true_lang-71d9073e.js";import{ac as y,a as G,k as r,A as I,r as d,o as T,c as j,i as t,w as o,y as V,e as _,t as H,F as J,ah as m,_ as L}from"./index-ea578c44.js";const O=s=>y.get("/database/redis/allkeys"+(s?`?sep=${s}`:"")),Q=s=>y.get("/database/redis/getkey?key="+s),W=s=>y.post("/database/redis/setkey",s),X=s=>y.delete("/database/redis/delkey?key="+s),Y=s=>y.delete("/database/redis/delkeys?key="+s),Z={style:{display:"flex",width:"100%"}},ee={class:"custom-tree-node"},ae={style:{"margin-left":"auto","font-size":"12px",color:"blue"}},te=["onClick"],le=["onClick"],se=G({__name:"index",setup(s){const p=r(!1),c=r(""),u=r(),g=r([]),h=r(":"),k=r(""),v=r(),D={children:"children",label:"name"},f=async()=>{let a=await O(h.value);a.code==200&&(g.value=a.data)},$=async a=>{let e=await Q(a);e.code==200&&(k.value=e.data)},C=async(a,e,n=!0)=>{let i=await W({key:a,value:e});i.code==200?(k.value=i.data,n==!0&&v.value&&v.value.close(),m.success("保存成功！"),f()):m.error("保存失败！")},E=async()=>{var e,n;if(console.log(u.value.data),c.value==""){m.error("键名不为空！");return}if((n=(e=u.value)==null?void 0:e.data)==null?void 0:n.children.some(i=>i.name==c.value)){m.error("该键名已存在！");return}await C(`${u.value.data.path}${u.value.data.path==""?"":":"}${c.value}`,"",!1),p.value=!1,c.value="",f()},B=()=>{u.value={data:{name:"",path:"",children:g.value}},p.value=!0},F=async(a,e=!1)=>{(e?await Y(a):await X(a)).code==200&&(m.success("删除成功！"),f())},P=async a=>{var e;((e=a.children)==null?void 0:e.length)==0&&(await $(a.path),v.value.open({content:k.value,confirm:n=>{C(a.path,n)}}))};return I(()=>{f()}),(a,e)=>{const n=d("el-divider"),i=d("el-input"),b=d("el-button"),R=d("el-form-item"),w=d("el-form"),U=d("el-tree"),A=d("el-card"),M=d("el-dialog");return T(),j(J,null,[t(A,null,{default:o(()=>[t(n,null,{default:o(()=>[V(" Redis ")]),_:1}),t(w,null,{default:o(()=>[t(R,{label:"分隔符"},{default:o(()=>[_("div",Z,[t(i,{modelValue:h.value,"onUpdate:modelValue":e[0]||(e[0]=l=>h.value=l),size:"small",style:{width:"30px","margin-right":"5px"}},null,8,["modelValue"]),t(b,{icon:"Refresh",size:"small",onClick:f}),t(b,{size:"small",onClick:B,style:{"margin-left":"auto"}},{default:o(()=>[V("添加")]),_:1})])]),_:1})]),_:1}),t(U,{data:g.value,props:D,onNodeClick:P},{default:o(({node:l,data:oe})=>[_("span",ee,[_("span",null,H(l.label),1),_("span",ae,[_("a",{onClick:x=>(p.value=!0,u.value=l,x.stopPropagation())},"添加",8,te),_("a",{style:{"margin-left":"8px"},onClick:x=>{var K,q,N,z;return F(((K=l.data)==null?void 0:K.children.length)>0?((q=l.data)==null?void 0:q.path)+"*":(N=l.data)==null?void 0:N.path,((z=l.data)==null?void 0:z.children.length)>0),x.stopPropagation()}},"删除",8,le)])])]),_:1},8,["data"])]),_:1}),t(S,{ref_key:"CodeDialogRef",ref:v},null,512),t(M,{modelValue:p.value,"onUpdate:modelValue":e[2]||(e[2]=l=>p.value=l),title:"添加键"},{footer:o(()=>[t(b,{type:"primary",size:"default",onClick:E},{default:o(()=>[V(" 确认添加 ")]),_:1})]),default:o(()=>[t(w,null,{default:o(()=>[t(R,{label:"输入键名"},{default:o(()=>[t(i,{modelValue:c.value,"onUpdate:modelValue":e[1]||(e[1]=l=>c.value=l),"input-style":{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}});const ie=L(se,[["__scopeId","data-v-b2c5d2c1"]]);export{ie as default};
